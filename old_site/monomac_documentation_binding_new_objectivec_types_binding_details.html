---
layout: obsolete
title: "MonoMac/Documentation/Binding New Objective-C Types/Binding Details"
permalink: /old_site/MonoMac/Documentation/Binding_New_Objective-C_Types/Binding_Details/
redirect_from:
  - /MonoMac/Documentation/Binding_New_Objective-C_Types/Binding_Details/
---

<h1>MonoMac/Documentation/Binding New Objective-C Types/Binding Details</h1>

<h1> <span class="mw-headline" id="Binding_Details">Binding Details</span></h1>
<p>These are the details of how the binding takes place.
</p><p>It is possible to use the <a href="http://docs.go-mono.com/MonoMac.Foundation.RegisterAttribute" class="external text" rel="nofollow">[Register</a>] attribute, <a href="http://docs.go-mono.com/MonoMac.Foundation.ExportAttribute" class="external text" rel="nofollow">[Export</a>] attribute, and <a href="/index.php?title=MonoMac/Documentation/Objective-C_Selectors&amp;action=edit&amp;redlink=1" class="new" title="MonoMac/Documentation/Objective-C Selectors (page does not exist)">manual Objective-C selector invocation</a> together to manually bind new (previously unbound) Objective-C types.
</p><p>First, find a type that you wish to bind.  For discussion purposes (and simplicity), we'll bind the <a href="http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSEnumerator_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40003654" class="external text" rel="nofollow">NSEnumerator</a> type (which has already been bound in <a href="http://docs.go-mono.com/MonoMac.Foundation.NSEnumerator" class="external text" rel="nofollow">MonoMac.Foundation.NSEnumerator</a>; the implementation below is just for example purposes).
</p><p>Second, we need to create the C# type.  We'll likely want to place this into a namespace; since Objective-C doesn't support namespaces, we'll need to use the [Register] attribute to change the type name that MonoTouch will register with the Objective-C runtime.  The C# type must also inherit from <a href="http://docs.go-mono.com/MonoMac.Foundation.NSObject" class="external text" rel="nofollow">MonoMac.Foundation.NSObject</a>:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">namespace</span> MonoMac<span style="color: #008000;">.</span><span style="color: #0000FF;">Example</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Binding</span> <span style="color: #008000;">&#123;</span>
    <span style="color: #008000;">&#91;</span>Register<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;NSEnumerator&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
    <span style="color: #6666cc; font-weight: bold;">class</span> NSEnumerator <span style="color: #008000;">:</span> NSObject
    <span style="color: #008000;">&#123;</span>
        <span style="color: #008080; font-style: italic;">// see steps 3-5</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Third, review the Objective-C documentation and create <a href="http://docs.go-mono.com/MonoMac.ObjCRuntime.Selector" class="external text" rel="nofollow">MonoMac.ObjCRuntime.Selector</a> instances for each selector you wish to use.  Place these within the class body:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">static</span> Selector selInit       <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Selector<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;init&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">static</span> Selector selAllObjects <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Selector<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;allObjects&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">static</span> Selector selNextObject <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Selector<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;nextObject&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>Fourth, your type will need to provide constructors.  You <i>must</i> chain your constructor invocation to the base class constructor.  The [Export] attributes permit Objective-C code to call the constructors with the specified selector name:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008000;">&#91;</span>Export<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;init&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> NSEnumerator<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">:</span> <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">&#40;</span>NSObjectFlag<span style="color: #008000;">.</span><span style="color: #0000FF;">Empty</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Handle <span style="color: #008000;">=</span> Messaging<span style="color: #008000;">.</span><span style="color: #0000FF;">IntPtr_objc_msgSend</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span>, selInit<span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #008080; font-style: italic;">// This constructor must be present so that MonoTouch </span>
<span style="color: #008080; font-style: italic;">// can create instances of your type from Objective-C code.</span>
<span style="color: #0600FF; font-weight: bold;">public</span> NSEnumerator<span style="color: #008000;">&#40;</span>IntPtr handle<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">:</span> <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">&#40;</span>handle<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Fifth, provide methods for each of the Selectors declared in Step 3.  These will use objc_msgSend() to invoke the selector on the native object.  Note the use of <a href="http://docs.go-mono.com/MonoMac.ObjCRuntime.Runtime.GetNSObject%20(System.IntPtr)" class="external text" rel="nofollow">Runtime.GetNSObject()</a> to convert an IntPtr into an appropriately typed NSObject (sub-)type.  If you want the method to be callable from Objective-C code, the member <i>must</i> be <b>virtual</b>.
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #008000;">&#91;</span>Export<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;nextObject&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">virtual</span> NSObject NextObject<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> Runtime<span style="color: #008000;">.</span><span style="color: #0000FF;">GetNSObject</span><span style="color: #008000;">&#40;</span>
        Messaging<span style="color: #008000;">.</span><span style="color: #0000FF;">IntPtr_objc_msgSend</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span>, selNextObject<span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #008080; font-style: italic;">// Note that for properties, [Export] goes on the get/set method:</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">virtual</span> NSArray AllObjects <span style="color: #008000;">&#123;</span>
    <span style="color: #008000;">&#91;</span>Export<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;allObjects&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
    <span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span>NSArray<span style="color: #008000;">&#41;</span> Runtime<span style="color: #008000;">.</span><span style="color: #0000FF;">GetNSObject</span><span style="color: #008000;">&#40;</span>
            Messaging<span style="color: #008000;">.</span><span style="color: #0000FF;">IntPtr_objc_msgSend</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span>, selAllObjects<span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Putting it all together:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">MonoTouch.Foundation</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">MonoTouch.ObjCRuntime</span><span style="color: #008000;">;</span>
&#160;
<span style="color: #0600FF; font-weight: bold;">namespace</span> MonoTouch<span style="color: #008000;">.</span><span style="color: #0000FF;">Example</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Binding</span> <span style="color: #008000;">&#123;</span>
    <span style="color: #008000;">&#91;</span>Register<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;NSEnumerator&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
    <span style="color: #6666cc; font-weight: bold;">class</span> NSEnumerator <span style="color: #008000;">:</span> NSObject
    <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">static</span> Selector selInit       <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Selector<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;init&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #0600FF; font-weight: bold;">static</span> Selector selAllObjects <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Selector<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;allObjects&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #0600FF; font-weight: bold;">static</span> Selector selNextObject <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Selector<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;nextObject&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        <span style="color: #008000;">&#91;</span>Export<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;init&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
        <span style="color: #0600FF; font-weight: bold;">public</span> NSEnumerator<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
            <span style="color: #008000;">:</span> <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">&#40;</span>NSObjectFlag<span style="color: #008000;">.</span><span style="color: #0000FF;">Empty</span><span style="color: #008000;">&#41;</span>
        <span style="color: #008000;">&#123;</span>
            Handle <span style="color: #008000;">=</span> Messaging<span style="color: #008000;">.</span><span style="color: #0000FF;">IntPtr_objc_msgSend</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span>,
                selInit<span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #008000;">&#125;</span>
&#160;
        <span style="color: #0600FF; font-weight: bold;">public</span> NSEnumerator<span style="color: #008000;">&#40;</span>IntPtr handle<span style="color: #008000;">&#41;</span>
            <span style="color: #008000;">:</span> <span style="color: #0600FF; font-weight: bold;">base</span><span style="color: #008000;">&#40;</span>handle<span style="color: #008000;">&#41;</span>
        <span style="color: #008000;">&#123;</span>
        <span style="color: #008000;">&#125;</span>
&#160;
        <span style="color: #008000;">&#91;</span>Export<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;nextObject&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
        <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">virtual</span> NSObject NextObject<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
        <span style="color: #008000;">&#123;</span>
            <span style="color: #0600FF; font-weight: bold;">return</span> Runtime<span style="color: #008000;">.</span><span style="color: #0000FF;">GetNSObject</span><span style="color: #008000;">&#40;</span>
                Messaging<span style="color: #008000;">.</span><span style="color: #0000FF;">IntPtr_objc_msgSend</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span>,
                    selNextObject<span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #008000;">&#125;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// Note that for properties, [Export] goes on the get/set method:</span>
        <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">virtual</span> NSArray AllObjects <span style="color: #008000;">&#123;</span>
            <span style="color: #008000;">&#91;</span>Export<span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;allObjects&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
            <span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
                <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span>NSArray<span style="color: #008000;">&#41;</span> Runtime<span style="color: #008000;">.</span><span style="color: #0000FF;">GetNSObject</span><span style="color: #008000;">&#40;</span>
                    Messaging<span style="color: #008000;">.</span><span style="color: #0000FF;">IntPtr_objc_msgSend</span><span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span>,
                        selAllObjects<span style="color: #008000;">.</span><span style="color: #0000FF;">Handle</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
            <span style="color: #008000;">&#125;</span>
        <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>

