---
layout: obsolete
title: "Accessibility: Moonlight Bridge Functional Specification"
permalink: /old_site/Accessibility:_Moonlight_Bridge_Functional_Specification/
redirect_from:
  - /Accessibility:_Moonlight_Bridge_Functional_Specification/
---

<h1>Accessibility: Moonlight Bridge Functional Specification</h1>

<p>Unlike the approach that was taken for the System.Windows.Forms ATK Bridge (where controls mapped by hand from UIAutomation to ATK), the Moonlight Bridge uses an automatic system for generating ATK adapters.  The system relies on a set of base Pattern Implementors which map one or many UIAutomation Control Patterns to one or many ATK interfaces, assembling them into a complete Adapter for use by ATK.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Mapping_between_Controls_and_UIAutomation_Patterns"><span class="tocnumber">1</span> <span class="toctext">Mapping between Controls and UIAutomation Patterns</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Mapping_Control_Types_to_ATK_Roles"><span class="tocnumber">2</span> <span class="toctext">Mapping Control Types to ATK Roles</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Mapping_UIAutomation_Control_Patterns_to_ATK_interfaces"><span class="tocnumber">3</span> <span class="toctext">Mapping UIAutomation Control Patterns to ATK interfaces</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Generic_Adapter"><span class="tocnumber">3.1</span> <span class="toctext">Generic Adapter</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Properties"><span class="tocnumber">3.1.1</span> <span class="toctext">Properties</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Methods_to_expect_GTK.2FGAIL_like_behavior"><span class="tocnumber">3.1.2</span> <span class="toctext">Methods to expect GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#States"><span class="tocnumber">3.1.3</span> <span class="toctext">States</span></a>
<ul>
<li class="toclevel-4 tocsection-8"><a href="#Default_states"><span class="tocnumber">3.1.3.1</span> <span class="toctext">Default states</span></a></li>
<li class="toclevel-4 tocsection-9"><a href="#Pattern-specific_States"><span class="tocnumber">3.1.3.2</span> <span class="toctext">Pattern-specific States</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-10"><a href="#Relations"><span class="tocnumber">3.1.4</span> <span class="toctext">Relations</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Events"><span class="tocnumber">3.1.5</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#ExpandCollapse.2FInvoke.2FToggle_Pattern_Implementor"><span class="tocnumber">3.2</span> <span class="toctext">ExpandCollapse/Invoke/Toggle Pattern Implementor</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Methods_to_expect_GTK.2FGAIL_like_behavior_2"><span class="tocnumber">3.2.1</span> <span class="toctext">Methods to expect GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Methods_that_cannot_be_implemented"><span class="tocnumber">3.2.2</span> <span class="toctext">Methods that cannot be implemented</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Events_2"><span class="tocnumber">3.2.3</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="#Grid.2FTable_Pattern_Implementor"><span class="tocnumber">3.3</span> <span class="toctext">Grid/Table Pattern Implementor</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Methods_to_expect_GTK.2FGAIL_like_behavior_3"><span class="tocnumber">3.3.1</span> <span class="toctext">Methods to expect GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Methods_to_expect_similar_GTK.2FGAIL_like_behavior"><span class="tocnumber">3.3.2</span> <span class="toctext">Methods to expect similar GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Methods_that_cannot_be_implemented_2"><span class="tocnumber">3.3.3</span> <span class="toctext">Methods that cannot be implemented</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Events_3"><span class="tocnumber">3.3.4</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="#RangeValue_Pattern_Implementor"><span class="tocnumber">3.4</span> <span class="toctext">RangeValue Pattern Implementor</span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="#Methods_to_expect_GTK.2FGAIL_like_behavior_4"><span class="tocnumber">3.4.1</span> <span class="toctext">Methods to expect GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#Methods_that_cannot_be_implemented_3"><span class="tocnumber">3.4.2</span> <span class="toctext">Methods that cannot be implemented</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Events_4"><span class="tocnumber">3.4.3</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#Selection_Pattern_Implementor"><span class="tocnumber">3.5</span> <span class="toctext">Selection Pattern Implementor</span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#Methods_to_expect_GTK.2FGAIL_like_behavior_5"><span class="tocnumber">3.5.1</span> <span class="toctext">Methods to expect GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Methods_that_cannot_be_implemented_4"><span class="tocnumber">3.5.2</span> <span class="toctext">Methods that cannot be implemented</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Events_5"><span class="tocnumber">3.5.3</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#SelectionItem_Pattern_Implementor"><span class="tocnumber">3.6</span> <span class="toctext">SelectionItem Pattern Implementor</span></a>
<ul>
<li class="toclevel-3 tocsection-30"><a href="#Events_6"><span class="tocnumber">3.6.1</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31"><a href="#Value_Pattern_Implementor"><span class="tocnumber">3.7</span> <span class="toctext">Value Pattern Implementor</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Methods_to_expect_GTK.2FGAIL_like_behavior_6"><span class="tocnumber">3.7.1</span> <span class="toctext">Methods to expect GTK/GAIL like behavior</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#Methods_that_cannot_be_implemented_5"><span class="tocnumber">3.7.2</span> <span class="toctext">Methods that cannot be implemented</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="#Events_7"><span class="tocnumber">3.7.3</span> <span class="toctext">Events</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-35"><a href="#Exceptions"><span class="tocnumber">3.8</span> <span class="toctext">Exceptions</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Mapping_between_Controls_and_UIAutomation_Patterns"> Mapping between Controls and UIAutomation Patterns </span></h1>
<p>To understand how a control should look in ATK, you must first understand two things: what is the control's UIAutomation Control Type, and what patterns does it implement.  The table below shows both for all the Silverlight 2 controls.
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:663px;"><a href="{{site.baseurl}}/images/old_site/d/d2/Control-to-pattern.png" class="image"><img alt="" src="{{site.baseurl}}/images/old_site/d/d2/Control-to-pattern.png" width="661" height="847" class="thumbimage" /></a>  <div class="thumbcaption">Silverlight 2 Control to UIAutomation Control Pattern mapping; for the original OpenOffice Calc document, see <a href="http://www.mono-a11y.org/documentation/control-to-pattern.ods" class="external autonumber" rel="nofollow">[1]</a>.</div></div></div>
<h1> <span class="mw-headline" id="Mapping_Control_Types_to_ATK_Roles"> Mapping Control Types to ATK Roles </span></h1>
<p>Once you know the UIAutomation Control Type, map it to the appropriate ATK Role using the table below.
</p>
<table class="wikitable" style="border-spacing: 5px; width: 25em;">

<tr style="border-bottom: 1px solid #000000;">
<th> ControlType </th>
<th> ATK Role
</th></tr>
<tr>
<td> Button </td>
<td> PushButton
</td></tr>
<tr>
<td> Calendar </td>
<td> Calendar
</td></tr>
<tr>
<td> CheckBox </td>
<td> CheckBox
</td></tr>
<tr>
<td> ComboBox </td>
<td> ComboBox
</td></tr>
<tr>
<td> Edit </td>
<td> Text
</td></tr>
<tr>
<td> Hyperlink </td>
<td> Label
</td></tr>
<tr>
<td> Image </td>
<td> Image
</td></tr>
<tr>
<td> ListItem </td>
<td> ListItem
</td></tr>
<tr>
<td> List </td>
<td> List
</td></tr>
<tr>
<td> Menu </td>
<td> Menu
</td></tr>
<tr>
<td> MenuBar </td>
<td> MenuBar
</td></tr>
<tr>
<td> MenuItem </td>
<td> MenuItem
</td></tr>
<tr>
<td> ProgressBar </td>
<td> ProgressBar
</td></tr>
<tr>
<td> RadioButton </td>
<td> RadioButton
</td></tr>
<tr>
<td> ScrollBar </td>
<td> ScrollBar
</td></tr>
<tr>
<td> Slider </td>
<td> Slider
</td></tr>
<tr>
<td> Spinner </td>
<td> SpinButton
</td></tr>
<tr>
<td> StatusBar </td>
<td> Statusbar
</td></tr>
<tr>
<td> Tab </td>
<td> PageTabList
</td></tr>
<tr>
<td> TabItem </td>
<td> PageTab
</td></tr>
<tr>
<td> Text </td>
<td> Label
</td></tr>
<tr>
<td> ToolBar </td>
<td> ToolBar
</td></tr>
<tr>
<td> ToolTip </td>
<td> ToolTip
</td></tr>
<tr>
<td> Tree </td>
<td> Table
</td></tr>
<tr>
<td> TableItem </td>
<td> TableCell
</td></tr>
<tr>
<td> Custom </td>
<td> Unknown
</td></tr>
<tr>
<td> Group </td>
<td> LayeredPane
</td></tr>
<tr>
<td> Thumb </td>
<td> PushButton
</td></tr>
<tr>
<td> DataGrid </td>
<td> Table
</td></tr>
<tr>
<td> DataItem </td>
<td> TableCell
</td></tr>
<tr>
<td> Document </td>
<td> Panel
</td></tr>
<tr>
<td> SplitButton </td>
<td> PushButton
</td></tr>
<tr>
<td> Window </td>
<td> Filler
</td></tr>
<tr>
<td> Pane </td>
<td> Panel
</td></tr>
<tr>
<td> Header </td>
<td> TableRowHeader
</td></tr>
<tr>
<td> HeaderItem </td>
<td> TableCell
</td></tr>
<tr>
<td> Table </td>
<td> Table
</td></tr>
<tr>
<td> TitleBar </td>
<td> MenuBar
</td></tr>
<tr>
<td> Separator </td>
<td> Separator
</td></tr>
</table>
<h1> <span class="mw-headline" id="Mapping_UIAutomation_Control_Patterns_to_ATK_interfaces"> Mapping UIAutomation Control Patterns to ATK interfaces </span></h1>
<p>Then, map the UIA Control Patterns to a Pattern Implementor to understand the behavior of a given control.
</p>
<h2> <span class="mw-headline" id="Generic_Adapter"> Generic Adapter </span></h2>
<p>All adapters inherit from the base Adapter class which provides an implementation of the Atk.Component interface.  In particular, the following members are expected to be implemented:
</p>
<h3> <span class="mw-headline" id="Properties"> Properties </span></h3>
<ul><li> description (Description): Should return AutomationElementIdentifiers.HelpText.
</li></ul>
<ul><li> getAlpha (Alpha): Always returns 1.  (This could be implemented, but I don't think any current ATs will announce it)
</li><li> getLayer (Layer): Always returns Atk.Layer.Widget
</li><li> getMDIZOrder (MdiZorder): Always returns 0 as Silverlight doesn't support MDI
</li></ul>
<h3> <span class="mw-headline" id="Methods_to_expect_GTK.2FGAIL_like_behavior"> Methods to expect GTK/GAIL like behavior </span></h3>
<ul><li> contains (Contains)
</li><li> getExtents (GetExtents)
</li><li> getPosition (GetPosition)
</li><li> getSize (GetSize)
</li><li> grabFocus (GrabFocus)
</li><li> refAccessibleAtPoint (RefAccessibleAtPoint)
</li><li> setExtents (SetExtents) - Only if control provides TransformPattern, <tt>CanMove = true</tt> and <tt>CanResize = true</tt>
</li><li> setPosition (SetPosition) - Only if control provides TransformPattern and <tt>CanMove = true</tt>
</li><li> setSize (SetSize) - Only if control provides TransformPattern and <tt>CanResize = true</tt>
</li></ul>
<h3> <span class="mw-headline" id="States"> States </span></h3>
<h4> <span class="mw-headline" id="Default_states"> Default states </span></h4>
<ul><li> If the control is on screen:
<ul><li> Atk.StateType.Showing
</li><li> Atk.StateType.Visible
</li></ul>
</li><li> If the control is Enabled:
<ul><li> Atk.StateType.Sensitive
</li><li> Atk.StateType.Enabled
</li></ul>
</li><li> If the control is keyboard focusable:
<ul><li> Atk.StateType.Focusable
</li></ul>
</li><li> If the control has keyboard focus:
<ul><li> Atk.StateType.Focused
</li></ul>
</li><li> If the control is rendered horizontally:
<ul><li> Atk.StateType.Horizontal
</li></ul>
</li><li> If the control is rendered vertically:
<ul><li> Atk.StateType.Vertical
</li></ul>
</li></ul>
<h4> <span class="mw-headline" id="Pattern-specific_States"> Pattern-specific States </span></h4>
<ul><li> If the control supports SelectionItem:
<ul><li> Atk.StateType.Selectable
</li></ul>
</li><li> If the control supports SelectionItem and is selected:
<ul><li> Atk.StateType.Selected
</li></ul>
</li><li> If the control supports Toggle, and is toggled:
<ul><li> Atk.StateType.Checked
</li></ul>
</li><li> If the control supports Value and displays only one line
<ul><li> Atk.StateType.SingleLine
</li></ul>
</li><li> If the control supports Value and displays more than one line
<ul><li> Atk.StateType.MultiLine
</li></ul>
</li><li> If the control supports Value and is editable
<ul><li> Atk.StateType.Editable
</li></ul>
</li><li> If the control supports ExpandCollapse
<ul><li> Atk.StateType.Expandable
</li></ul>
</li><li> If the control supports ExpandCollapse and is expanded
<ul><li> Atk.StateType.Expanded
</li></ul>
</li><li> If the control supports Transform and <tt>CanResize = true</tt>
<ul><li> Atk.StateType.Resizable
</li></ul>
</li><li> If the control supports Invoke or Toggle, the following state will be raised when calling their main doAction:
<ul><li> Atk.StateType.Armed
</li></ul>
</li></ul>
<p>(TODO: determine if moon supports raising the state on click before <b>release</b> happens. If yes, Armed state will be lost when the user releases the button. If not, Armed state will be ON and immediately OFF when the action is triggered).
</p>
<h3> <span class="mw-headline" id="Relations"> Relations </span></h3>
<ul><li> Atk.RelationType.LabelledBy: Set if AutomationElementIdentifiers.LabeledBy is set.
</li><li> Atk.RelationType.NodeChildOf: Set for treenodes that are children of other higher-level treenodes (and for the highest-level treenodes pointing to the TreeTable parent).
</li><li> Atk.RelationType.MemberOf: Set for radiobuttons of the same group.
</li></ul>
<h3> <span class="mw-headline" id="Events"> Events </span></h3>
<ul><li> When control's accessible name changes:
<ul><li> <tt>object:accessible-name</tt>
</li></ul>
</li><li> When control's visibility changes:
<ul><li> <tt>object:state-changed:visible</tt>
</li></ul>
</li><li> When control's sensitivity changes:
<ul><li> <tt>object:state-changed:sensitive</tt>
</li></ul>
</li><li> When control receives focus:
<ul><li> <tt>object:state-changed:focused</tt>
</li><li> <tt>focus_event</tt>
</li></ul>
</li><li> When focus leaves control:
<ul><li> <tt>object:state-changed:focused</tt>
</li></ul>
</li><li> When control's bounds are changed:
<ul><li> <tt>bounds_changed</tt>
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="ExpandCollapse.2FInvoke.2FToggle_Pattern_Implementor"> ExpandCollapse/Invoke/Toggle Pattern Implementor </span></h2>
<ul><li> Implements: Atk.Action
</li><li> Description: Maps ExpandCollpasePattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.iexpandcollapseprovider_members.aspx" class="external autonumber" rel="nofollow">[2]</a>, InvokePattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.iinvokeprovider_members.aspx" class="external autonumber" rel="nofollow">[3]</a> and TogglePattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.itoggleprovider_members.aspx" class="external autonumber" rel="nofollow">[4]</a> to Atk.Action.
</li></ul>
<p>The Pattern Implementor maps the three patterns as the individual actions listed below:
</p>
<ul><li> ExpandCollapsePattern: "expand or collapse"
</li><li> Invoke: "click"
</li><li> Toggle: "click"
</li></ul>
<p>If both Invoke and Toggle patterns are implemented, the Toggle pattern's actions will take precedence.
</p>
<h3> <span class="mw-headline" id="Methods_to_expect_GTK.2FGAIL_like_behavior_2"> Methods to expect GTK/GAIL like behavior </span></h3>
<ul><li> nActions (NActions)
</li><li> doAction (DoAction)
</li><li> getDescription (GetDescription)
</li><li> getKeyBinding (GetKeybinding)
</li><li> getName (GetName)
</li><li> getLocalizedName (GetLocalizedName)
</li><li> setDescription (SetDescription)
</li></ul>
<h3> <span class="mw-headline" id="Methods_that_cannot_be_implemented"> Methods that cannot be implemented </span></h3>
<p>None
</p>
<h3> <span class="mw-headline" id="Events_2"> Events </span></h3>
<ul><li> When control is expanded or collapsed:
<ul><li> <tt>visible_data_changed</tt>
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="Grid.2FTable_Pattern_Implementor"> Grid/Table Pattern Implementor </span></h2>
<ul><li> Implements: Atk.Table
</li><li> Description: Maps Grid<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.igridprovider.aspx" class="external autonumber" rel="nofollow">[5]</a> and Table<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.itableprovider.aspx" class="external autonumber" rel="nofollow">[6]</a> to Atk.Table.
</li></ul>
<p>IGrid is a subset of ITable, so every ITable provider will implement IGrid (but not the other way around).
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Methods_to_expect_GTK.2FGAIL_like_behavior_3"> Methods to expect GTK/GAIL like behavior </span></h3>
<ul><li> refAt (RefAt)
</li><li> getColumnDescription (GetColumnDescription)
</li><li> addRowSelection (AddRowSelection)
</li><li> removeRowSelection (RemoveRowSelection)
</li><li> getRowDescription (GetRowDescription)
</li><li> getRowHeader (GetRowHeader)
</li><li> getIndexAt (GetIndexAt)
</li><li> getColumnAtIndex (GetColumnAtIndex)
</li><li> getRowAtIndex (GetRowAtIndex)
</li><li> getColumnExtentAt (GetColumnExtentAt)
</li><li> getRowExtentAt (GetRowExtentAt)
</li><li> getSelectedRows (GetSelectedRows)
</li><li> isRowSelected (IsRowSelected)
</li><li> isSelected (IsSelected)
</li><li> nColumns (NColumns)
</li><li> nRows (NRows)
</li></ul>
<h3> <span class="mw-headline" id="Methods_to_expect_similar_GTK.2FGAIL_like_behavior"> Methods to expect similar GTK/GAIL like behavior </span></h3>
<ul><li> caption (Caption)
</li><li> summary (Summary)
</li></ul>
<p>(Both will return the information that may be previously set.)
</p>
<h3> <span class="mw-headline" id="Methods_that_cannot_be_implemented_2"> Methods that cannot be implemented </span></h3>
<ul><li> setRowDescription (SetRowDescription)
</li><li> setRowHeader (SetRowHeader)
</li><li> setDescription (SetDescription)
</li><li> setColumnDescription (SetColumnDescription)
</li><li> setColumnHeader (SetColumnHeader)
</li><li> getSelectedColumns (GetSelectedColumns)
</li><li> isColumnSelected (IsColumnSelected)
</li><li> addColumnSelection (AddColumnSelection)
</li><li> removeColumnSelection (RemoveColumnSelection)
</li></ul>
<h3> <span class="mw-headline" id="Events_3"> Events </span></h3>
<ul><li> When rows are inserted:
<ul><li> <tt>row_inserted(row, n_inserted)</tt>
</li></ul>
</li><li> When rows are deleted:
<ul><li> <tt>row_deleted(row, n_children_deleted)</tt>
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="RangeValue_Pattern_Implementor"> RangeValue Pattern Implementor </span></h2>
<ul><li> Implements: Atk.Value
</li><li> Description: Maps RangeValuePattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.irangevalueprovider_members.aspx" class="external autonumber" rel="nofollow">[7]</a> to Atk.Value.  Should be able to map API roughly 1:1.
</li></ul>
<h3> <span class="mw-headline" id="Methods_to_expect_GTK.2FGAIL_like_behavior_4"> Methods to expect GTK/GAIL like behavior </span></h3>
<ul><li> minimumValue (GetMinimumValue)
</li><li> maximumValue (GetMaximumValue)
</li><li> minimumIncrement (GetMinimumIncrement)
</li><li> currentValue (GetCurrentValue)
</li><li> currentValue (SetCurrentValue)
</li></ul>
<h3> <span class="mw-headline" id="Methods_that_cannot_be_implemented_3"> Methods that cannot be implemented </span></h3>
<p>None
</p>
<h3> <span class="mw-headline" id="Events_4"> Events </span></h3>
<ul><li> When control's value changes:
<ul><li> <tt>object:accessible-value</tt>
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="Selection_Pattern_Implementor"> Selection Pattern Implementor </span></h2>
<ul><li> Implements: Atk.Selection
</li><li> Description: Maps SelectionPattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.iselectionprovider_members.aspx" class="external autonumber" rel="nofollow">[8]</a> and SelectionItemPattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.iselectionitemprovider_members.aspx" class="external autonumber" rel="nofollow">[9]</a> to Atk.Selection.  Unlike UIAutomation, selection in ATK is done in the parent container instead of the container's children.  This Pattern Implementor maps the various selection methods from the children to the parent.
</li></ul>
<h3> <span class="mw-headline" id="Methods_to_expect_GTK.2FGAIL_like_behavior_5"> Methods to expect GTK/GAIL like behavior </span></h3>
<ul><li> nSelectedChildren (SelectionCount)
</li><li> selectChild (AddSelection)
</li><li> clearSelection (ClearSelection)
</li><li> isChildSelected (IsChildSelected)
</li><li> getSelectedChild (RefSelection)
</li><li> deselectChild (RemoveSelection)
</li><li> selectAll (SelectAllSelection)
</li></ul>
<h3> <span class="mw-headline" id="Methods_that_cannot_be_implemented_4"> Methods that cannot be implemented </span></h3>
<p>None
</p>
<h3> <span class="mw-headline" id="Events_5"> Events </span></h3>
<ul><li> None
</li></ul>
<h2> <span class="mw-headline" id="SelectionItem_Pattern_Implementor"> SelectionItem Pattern Implementor </span></h2>
<h3> <span class="mw-headline" id="Events_6"> Events </span></h3>
<ul><li> When an object gains or loses selection:
<ul><li> <tt>object:state-changed:selected</tt>
</li><li> <tt>selection_changed</tt>
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="Value_Pattern_Implementor"> Value Pattern Implementor </span></h2>
<ul><li> Implements: Atk.Text
</li><li> Description: Maps ValuePattern<a href="http://msdn.microsoft.com/en-us/library/system.windows.automation.provider.ivalueprovider_members.aspx" class="external autonumber" rel="nofollow">[10]</a> to Atk.Text.  Can only retrieve and set the value of the control, but cannot control or retrieve things like selection, caret and text attributes.
</li></ul>
<h3> <span class="mw-headline" id="Methods_to_expect_GTK.2FGAIL_like_behavior_6"> Methods to expect GTK/GAIL like behavior </span></h3>
<ul><li> getCharacterAtOffset (GetCharacterAtOffset)
</li><li> getCharacterExtents (GetCharacterExtents)
</li><li> getRangeExtents (GetRangeExtents)
</li><li> getText (GetText)
</li><li> getTextAfterOffset (GetTextAfterOffset)
</li><li> getTextAtOffset (GetTextAtOffset)
</li><li> getTextBeforeOffset (GetTextBeforeOffset)
</li><li> characterCount (CharacterCount)
</li></ul>
<h3> <span class="mw-headline" id="Methods_that_cannot_be_implemented_5"> Methods that cannot be implemented </span></h3>
<ul><li> addSelection (AddSelection)
</li><li> getBoundedRanges (GetBoundedRanges)
</li><li> getOffsetAtPoint (GetOffsetAtPoint)
</li><li> getAttributeRun (GetRunAttributes)
</li><li> getDefaultAttributes (DefaultAttributes)
</li><li> getNSelections (GetNSelections)
</li><li> getAttributes (GetAttributes)
</li><li> removeSelection (RemoveSelection)
</li><li> getSelection (GetSelection)
</li><li> setSelection (SetSelection)
</li><li> setCaretOffset (SetCaretOffset)
</li><li> caretOffset (CaretOffset)
</li></ul>
<h3> <span class="mw-headline" id="Events_7"> Events </span></h3>
<ul><li> When the value changes:
<ul><li> <tt>visible_data_changed</tt>
</li></ul>
</li></ul>
<h2> <span class="mw-headline" id="Exceptions"> Exceptions </span></h2>
<ul><li> GridSplitter: Implements Transform pattern (which is usually accessed in ATK via SetPosition) but Orca (TODO: check this) expects Atk.Value to be implemented instead.  The feasibility of altering this in our design will have to be estimated by development.
</li><li> TODO: Possible exception for Tables and Table-like controls.
</li></ul>

