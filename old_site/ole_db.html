---
layout: obsolete
title: "OLE DB"
permalink: /old_site/OLE_DB/
redirect_from:
  - /OLE_DB/
---

<h1>OLE DB</h1>

<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Table of contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Info"><span class="tocnumber">1</span> <span class="toctext">Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Current_Status"><span class="tocnumber">2</span> <span class="toctext">Current Status</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Action_plan"><span class="tocnumber">3</span> <span class="toctext">Action plan</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Testing_OleDb_with_libgda.27s_PostgreSQL_provider"><span class="tocnumber">4</span> <span class="toctext">Testing OleDb with libgda's PostgreSQL provider</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Info"> Info </span></h2>
<ul><li> Provides a System.Data.OleDb like provider for Mono using <a href="http://www.gnome-db.org/" class="external text" rel="nofollow">GDA</a> as the data access layer.
</li></ul>
<ul><li> Exists in namespace System.Data.OleDb and assembly System.Data
</li></ul>
<ul><li> Created by Rodrigo Moya (the maintainer for GDA)
</li></ul>
<ul><li> LibGDA has providers for:
<ul><li> <a href="http://www.mysql.com/" class="external text" rel="nofollow">MySQL</a>
</li><li> <a href="http://www.postgresql.org/" class="external text" rel="nofollow">PostgreSQL</a>
</li><li> XML
</li><li> ODBC (via <a href="http://www.unixodbc.org/" class="external text" rel="nofollow">unixODBC</a>)
</li><li> <a href="http://www.oracle.com/" class="external text" rel="nofollow">Oracle</a>
</li><li> <a href="http://www.borland.com/products/downloads/download_interbase.html" class="external text" rel="nofollow">Interbase</a>
</li><li> <a href="http://www.sybase.com/downloads" class="external text" rel="nofollow">Sybase</a> and <a href="http://www.microsoft.com/sql/default.asp" class="external text" rel="nofollow">Microsoft SQL Server</a> via <a href="http://www.freetds.org/" class="external text" rel="nofollow">FreeTDS</a>
</li><li> <a href="http://www-3.ibm.com/software/data/db2/" class="external text" rel="nofollow">IBM DB2 Universal Database</a>
</li><li> <a href="http://www.hwaci.com/sw/sqlite/download.html" class="external text" rel="nofollow">SQL Lite</a>
</li><li> <a href="http://www.microsoft.com/office/access/default.asp" class="external text" rel="nofollow">MS Access</a> via <a href="http://mdbtools.sourceforge.net/" class="external text" rel="nofollow">MDB Tools</a>
</li></ul>
</li></ul>
<ul><li> Does not support trusted connections
</li></ul>
<ul><li> Bugs with Mono or the data provider should be reported in Mono's Bugzilla <a href="http://bugzilla.ximian.com/" class="external text" rel="nofollow">here</a>. If you do not have Bugzilla user account, it is free and easy to create one <a href="http://bugzilla.ximian.com/createaccount.cgi" class="external text" rel="nofollow">here</a>.
</li></ul>
<h2> <span class="mw-headline" id="Current_Status"> Current Status </span></h2>
<ul><li> Not actively maintained.  Please use another managed provider, System.Data.Odbc, or GDA# instead.
</li></ul>
<ul><li> The OleDb provider is working with libgda. The C-Sharp bindings to libgda currently work - meaning they can compile, run, and you can connect to a PostgreSQL database via libgda via the C-Sharp bindings to libgda.
</li></ul>
<ul><li> Basic functionality (execution of commands, data retrieval, transactions, etc) are now working.
</li></ul>
<ul><li> An inital implementation of GetSchemaTable() for the OleDbDataReader has been checked into cvs. GetSchemaTable() isn't correct for OleDb, but the foundation is there.
</li></ul>
<h2> <span class="mw-headline" id="Action_plan"> Action plan </span></h2>
<ul><li> Does not work on Widnows because libgda does not work on Windows.  Some people have tried it, but I could not verify this myself.
</li></ul>
<ul><li> Only works on Linux with GNOME 2.x
</li></ul>
<ul><li> Need to make the OleDb provider compatible with the OleDb provider in Microsoft .NET
</li></ul>
<h2> <span class="mw-headline" id="Testing_OleDb_with_libgda.27s_PostgreSQL_provider"> Testing OleDb with libgda's PostgreSQL provider </span></h2>
<p><b>Prerequisites</b> 
</p>
<ul><li> Requires a working mono and mcs
</li></ul>
<ul><li> Requires Linux because the OleDb provider uses libgda and libgda only works on Linux.
</li></ul>
<p><b>Connection String Format</b> 
</p>
<ul><li> Connection String format: 
</li></ul>
<pre>&quot;Provider=providerName;...&quot;</pre> providerName is the name of the Provider you use, such as, PostgreSQL, MySQL, etc. The elipsis ... means that the connection parameters are dependent upon the provider being used and are passed to libgda for connecting. Such paramters, can be: Database, User ID, Password, Server, etc...
<ul><li> See the test TestOleDb.cs found at mcs/class/System.Data/System.Data.OleDb
</li></ul>
<b>C# Example</b> <pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.OleDb</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
		<span style="color: #008080; font-style: italic;">// there is a libgda PostgreSQL provider</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Provider=PostgreSQL;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Addr=127.0.0.1;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Database=test;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=postgres;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=fun2db&quot;</span><span style="color: #008000;">;</span>
       IDbConnection dbcon<span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> OleDbConnection<span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       IDbCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008080; font-style: italic;">// requires a table to be created named employee</span>
       <span style="color: #008080; font-style: italic;">// with columns firstname and lastname</span>
       <span style="color: #008080; font-style: italic;">// such as,</span>
       <span style="color: #008080; font-style: italic;">//        CREATE TABLE employee (</span>
       <span style="color: #008080; font-style: italic;">//           firstname varchar(32),</span>
       <span style="color: #008080; font-style: italic;">//           lastname varchar(32));</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span>
            <span style="color: #666666;">&quot;SELECT firstname, lastname &quot;</span> <span style="color: #008000;">+</span>
            <span style="color: #666666;">&quot;FROM employee&quot;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       IDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
            <span style="color: #6666cc; font-weight: bold;">string</span> FirstName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;firstname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
            <span style="color: #6666cc; font-weight: bold;">string</span> LastName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;lastname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
            Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Name: &quot;</span> <span style="color: #008000;">+</span>
                 FirstName <span style="color: #008000;">+</span> <span style="color: #666666;">&quot; &quot;</span> <span style="color: #008000;">+</span> LastName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
       <span style="color: #008080; font-style: italic;">// clean up</span>
       reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<ul><li> Building C# Example: 
</li><li> Save the example to a file, such as, TestExample.cs
</li></ul>
<ul><li> Build:
</li></ul>
<pre>
mcs TestExample.cs -r:System.Data.dll
</pre>
<ul><li> Running the Example:
</li></ul>
<pre>
 mono TestExample.exe </pre>

