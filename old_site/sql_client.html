---
layout: obsolete
title: "SQL Client"
permalink: /old_site/SQL_Client/
redirect_from:
  - /SQL_Client/
---

<h1>SQL Client</h1>

<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Table of contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#MS_SQL_Client"><span class="tocnumber">1</span> <span class="toctext">MS SQL Client</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Info"><span class="tocnumber">1.1</span> <span class="toctext">Info</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Current_Status"><span class="tocnumber">1.2</span> <span class="toctext">Current Status</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Action_Plan"><span class="tocnumber">1.3</span> <span class="toctext">Action Plan</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Testing"><span class="tocnumber">1.4</span> <span class="toctext">Testing</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="MS_SQL_Client"> MS SQL Client </span></h1>
<ul><li> Info
</li><li> Current Status
</li><li> Action Plan
</li><li> Testing
</li></ul>
<h2> <span class="mw-headline" id="Info"> Info </span></h2>
<ul><li> ADO.NET Provider for Microsoft SQL Server 7/2000 databases
</li><li> Exists in namespace System.Data.SqlClient and assembly System.Data
</li><li> Created by Tim Coleman
</li><li> Used the <a href="http://www.freetds.org/" class="external text" rel="nofollow">FreeTDS</a> and <a href="http://jtds.sourceforge.net/" class="external text" rel="nofollow">jTDS</a> projects as resources.
</li><li> Implemented in 100% C#
</li><li> Is similar to the Mono.Data.TdsClient and Mono.Data.SybaseClient providers.
</li><li> Requires the assembly Mono.Data.Tds.dll which implements the TDS protocol in 100% C#.
</li><li> Uses TDS Protocol Version 7.0
</li><li> Bugs with Mono or the data provider should be reported in Mono's Bugzilla <a href="http://bugzilla.ximian.com/" class="external text" rel="nofollow">here</a>. If you do not have Bugzilla user account, it is free and easy to create one <a href="http://bugzilla.ximian.com/createaccount.cgi" class="external text" rel="nofollow">here</a>.
</li></ul>
<h2> <span class="mw-headline" id="Current_Status"> Current Status </span></h2>
<ul><li> Connect to Microsoft SQL Server 7/2000 databases via SQL Server authentication and NT Authentication.
</li><li> Connection pooling works.
</li><li> Stored Procedures work.
</li><li> Parameters work.
</li><li> Prepare works.
</li><li> SQL commands can be executed via ExecuteNonQuery() of a SqlCommand.
</li><li> SQL aggregates can be executed and a single row and single column result can be retrieved via ExecuteScalar() of a SqlCommand
</li><li> SQL queries can be executed via ExecuteReader() and results can be retrieved via SqlDataReader.
</li><li> a DataTable with schema info about a result can be gotten via GetSchemaTable() in a SqlDataReader
</li><li> XML can be read via ExecuteXmlReader in a SqlCommand.
</li><li> Data can be filled in a DataTable in a DataSet via a SqlDataAdapter
</li><li> Works in the SQL# command-line and Gtk# GUI version
</li></ul>
<h2> <span class="mw-headline" id="Action_Plan"> Action Plan </span></h2>
<ul><li> Needs more testing and fixing bugs
</li><li> Start work on TDS Protocol Version 8.0 support
</li><li> Add support for the .NET Framework 2.0 (Whidbey)
</li><li> Add support for Microsoft SQL Server 2005 (Yukon) support
</li></ul>
<h2> <span class="mw-headline" id="Testing"> Testing </span></h2>
<p><b>Prerequisites</b>
</p>
<ul><li> Have a working mono and mcs installed
</li><li> Have access to a Microsoft SQL Server database or either download it:
</li><li> <a href="http://www.microsoft.com/sql/default.asp" class="external text" rel="nofollow">Microsoft SQL Server</a>
</li><li> <b>IMPORTANT:</b> If using Microsoft SQL Server 2000, make sure you are using at least Service Pack 3 for Microsoft SQL Server 2000. If using MSDE 2000, make sure you have the special Service Pack 3 for MSDE 2000. You can get it from <a href="http://www.microsoft.com/sql/downloads/2000/sp3.asp" class="external text" rel="nofollow">here</a>
</li></ul>
<ul><li> For those that only have MSDE installed. You can change the authentication mode from Windows Only Authentication to SQL Server and Windows Authentications (also knows as Mixed-mode authentication) via the <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;Q322336&amp;sd=tech#4" class="external text" rel="nofollow">registry</a>. It is the LoginMode you need to change. By default, MSDE is installed with Windows Only Authentication. If you want SqlClient to work with MSDE via SQL Server authentication, you will need to change the setting. Otherwise, you wil have to use NT Authentication.&lt;/a&gt;
</li></ul>
<ul><li> If using MSDE, you might need to create a new user with password. Give this user access to various databases in this MSDE instance. Also, for each database, give this new user at least SELECT access to the various tables you want to retrieve data from.
</li></ul>
<ul><li> If you have Enterprise Manager, you can easily change the authentication mode for both MSDE and Microsoft SQL Server. To change the authentication mode in Enterprise Mananger, select the instance, right-click on it, and select properites. The SQL Server properties dialog for that instance will pop up. Choose the Security tab. Change the Authentication from Windows Only to SQL Server and Windows. If the instance of your database does not show up in Enterprise Manager, Register first by selecting the Action menu and choosing New SQL Server Registration.
</li></ul>
<ul><li> Located at mcs/class/System.Data/Test is a test for System.Data.SqlClient named SqlTest.cs and you could use this as a basis for your test.
</li></ul>
<ul><li> If you want to use Integrated Security (aka NT Authentication aka Trusted Connection aka Domain Login), you will need to specify the Domain User ID and Password. This is because Mono is not integrated with Windows nor SQL Server.
</li></ul>
<p><b>Connection string format</b>
</p>
<ul><li> Has a connection string format for SQL Server Authentication:
</li></ul>
<pre>
	Server=hostname;
	Database=databaseName;
	User ID=sqlServerUserid;
	Password=sqlServerPassword
</pre>
<ul><li> Has a connection string format for NT Authentication:
</li></ul>
<pre>
	Server=hostname;
	Database=databaseName;
	User ID=windowsDomain\windowsUserid;
	Password=windowsPassword;
	Integrated Security=SSPI
</pre>
<ul><li> The Server part can be used three ways:
</li></ul>
<pre>
	Server Definition	Example
	-----------------------------------------------
	hostname		Server=MYHOST
	hostname,port		Server=MYHOST,1433
	hostname\instance	Server=MYHOST\NETSDK
</pre>
<p><b>C# Examples</b>
</p>
<ul><li> C# Example using SQL Server Authentication:
</li></ul>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.SqlClient</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
<span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
			<span style="color: #666666;">&quot;Server=MyServer;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;Database=pubs;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;User ID=MySqlServerUserId;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;Password=MySqlServerPassword;&quot;</span><span style="color: #008000;">;</span>
		IDbConnection dbcon<span style="color: #008000;">;</span>
		dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlConnection<span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		IDbCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span>
			<span style="color: #666666;">&quot;SELECT fname, lname &quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;FROM employee&quot;</span><span style="color: #008000;">;</span>
		dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
		IDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #6666cc; font-weight: bold;">string</span> FirstName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;fname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
			<span style="color: #6666cc; font-weight: bold;">string</span> LastName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;lname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Name: &quot;</span> <span style="color: #008000;">+</span>
				FirstName <span style="color: #008000;">+</span> <span style="color: #666666;">&quot; &quot;</span> <span style="color: #008000;">+</span> LastName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
		<span style="color: #008080; font-style: italic;">// clean up</span>
		reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<ul><li> C# Example using NT Authentication (Integrated Security):
</li></ul>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.SqlClient</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
<span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
	<span style="color: #008000;">&#123;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
			<span style="color: #666666;">&quot;Server=MyServer;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;Database=pubs;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;User ID=MyWindowsDomain<span style="color: #008080; font-weight: bold;">\\</span>MyWindowsUserid;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;Password=MyWindowsPassword;&quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;Integrated Security=SSPI&quot;</span><span style="color: #008000;">;</span>
		IDbConnection dbcon<span style="color: #008000;">;</span>
		dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlConnection<span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		IDbCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span>
			<span style="color: #666666;">&quot;SELECT fname, lname &quot;</span> <span style="color: #008000;">+</span>
			<span style="color: #666666;">&quot;FROM employee&quot;</span><span style="color: #008000;">;</span>
		dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
		IDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			<span style="color: #6666cc; font-weight: bold;">string</span> FirstName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;fname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
			<span style="color: #6666cc; font-weight: bold;">string</span> LastName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;lname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Name: &quot;</span> <span style="color: #008000;">+</span>
				FirstName <span style="color: #008000;">+</span> <span style="color: #666666;">&quot; &quot;</span> <span style="color: #008000;">+</span> LastName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
		<span style="color: #008080; font-style: italic;">// clean up</span>
		reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
		dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
	<span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Building C# Example:</b>
</p>
<ul><li> Save the example to a file, such as, TestExample.cs
</li></ul>
<ul><li> Build on Linux:
</li></ul>
<pre>
mcs TestExample.cs -r System.Data.dll
</pre>
<ul><li> Running the Example:
</li></ul>
<pre>
mono TestExample.exe
</pre>

