---
layout: obsolete
title: "WPFNotes"
permalink: /old_site/WPFNotes/
redirect_from:
  - /WPFNotes/
---

<h1>WPFNotes</h1>

<p>This document tracks some notes as I explore Silverlight and WPF.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Storyboard_and_Animations"><span class="tocnumber">1</span> <span class="toctext">Storyboard and Animations</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Interception_of_Properties"><span class="tocnumber">2</span> <span class="toctext">Interception of Properties</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Simplified_Class_Hierarchy"><span class="tocnumber">3</span> <span class="toctext">Simplified Class Hierarchy</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Paths"><span class="tocnumber">3.1</span> <span class="toctext">Paths</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Storyboard_and_Animations"> Storyboard and Animations </span></h1>
<p>Storylines can contain multiple animations, which use the timer infrastructure in the main loop to raise the events.   
</p><p>There is no separate thread to raise the events, it is possible to create an object that hangs for a few seconds when setting the value of a property:
</p>
<pre class="csharp" style="font-family:monospace;">PhotosProperty <span style="color: #008000;">=</span> DependencyPRoperty<span style="color: #008000;">.</span><span style="color: #0000FF;">Register</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Photos&quot;</span>, <a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span style="color: #008000;">typeof</span></a> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&#41;</span>, <a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span style="color: #008000;">typeof</span></a><span style="color: #008000;">&#40;</span>Camera<span style="color: #008000;">&#41;</span>, 
         <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PropertyMetadata <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">32</span>, changed_callback<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">..</span>
&#160;
<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> changed_callback <span style="color: #008000;">&#40;</span>DependencyObject target, 
                              DependencyPropertyChangedEventArgs e<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
        <span style="color: #000000;">System.<span style="color: #0000FF;">Threading</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Thread</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Sleep</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10000</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>And to try this animation use:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Window <span style="color: #008000;">...</span> <span style="color: #008000;">&#123;</span>
Camera c <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Camera <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
NameScope<span style="color: #008000;">.</span><span style="color: #0000FF;">SetNamespace</span> <span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NameScope <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
RegisterName <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;camera&quot;</span>, c<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
Int32Animation anum <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Int32Animation <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">10</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Duration <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> TimeSpan <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">40</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
Storyboard s <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Storyboard <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
s<span style="color: #008000;">.</span><span style="color: #0000FF;">Children</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>anim<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
<span style="color: #008080; font-style: italic;">// This is funky, you set these two properties through Storyboard,</span>
<span style="color: #008080; font-style: italic;">// for the actual animation, not through the animation itself.</span>
Storyboard<span style="color: #008000;">.</span><span style="color: #0000FF;">SetTargetName</span> <span style="color: #008000;">&#40;</span>anim, <span style="color: #666666;">&quot;camera&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
Storyboard<span style="color: #008000;">.</span><span style="color: #0000FF;">SetTargetProperty</span> <span style="color: #008000;">&#40;</span>anim, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PropertyPath <span style="color: #008000;">&#40;</span>Camera<span style="color: #008000;">.</span><span style="color: #0000FF;">PhotosProperty</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
s<span style="color: #008000;">.</span><span style="color: #0000FF;">Begin</span> <span style="color: #008000;">&#40;</span><span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<h1> <span class="mw-headline" id="Interception_of_Properties"> Interception of Properties </span></h1>
<p>Unlike .NET properties, where interception happens in the setter (to perform book-keeping) WPF has a runtime system for this purpose.  The idea apparently was to build "lighter" objects by turning properties that would be seldom set into runtime settable properties that are kept on a dictionary.
</p><p>To intercept value setting of those properties, the PropertyMetadata is used when creating the property in the call to DependencyProperty.Register, here some callbacks for get, set, invalidate and maybe a few others are provided, as well as the default value for the property.
</p>
<h1> <span class="mw-headline" id="Simplified_Class_Hierarchy"> Simplified Class Hierarchy </span></h1>
<p>The following is a simplified class hierarchy for the rendering system that might help understand how things work.    The words in parenthesis are the important properties introduced in a given class.
</p>
<pre>
BrowserHost

InternalCollection&lt;T&gt;
    GeometryCollection
    GradientStopCollection
    Inlines
    KeyFrameCollection
    MediaAttributeCollection
    PathFigureCollection
    PathSegmentCollection
    ResourceCollection
    StrokeCollection
    StylusPointCollection
    TimelineCollection
    TimelineMarkerCollection
    TransformCollection
    TriggerActionCollection
    TriggerCollection
    VisualCollection

Color
Colors

DependencyObject
    BeginStoryboard
    Brush
        GradientBrush
            LinearGradientBrush
            RadialGradientBrush
        SolidColorBrush
        TileBrush
            ImageBrush
            VideoBrush
    Downloader
    DrawingAttributes
    EventTrigger
    Geometry
        EllipseGeometry
        GeometryGroup
        LineGeometry
        PathGeometry
        RectangleGeometry
    GradientStop
    Inline
        LineBreak
        Run
    Ink.Stroke
    KeyFrame (KeyTime)
        ColorKeyFrame (Value)
            DiscreteColorKeyFrame
            LinearColorKeyFrame
            SplineColorKeyFrame (KeySpline)
        DoubleKeyFrame (Value)
            DiscreteDoubleKeyFrame
	    LinearDoubleKeyFrame
	    SplineDoubleKeyFrame
	PointKeyFrame (Value)
            DiscretePointKeyFrame
            LinearPointKeyFrame
            SplinePointKeyFrame
    KeySpline    
    MediaAttribute
    PathFigure
    PathSegment
        ArcSegment
        BezierSegment
        LineSegment
        PolyBezierSegment
        PolyLineSegment
        PolyQuadraticBezierSegment
        QuadraticBezierSegment
    StylusInfo
    StylusPoint
    Timeline (Begin, Duration, Loop, Repeat, Fill, Speed)
        Animation 
            ColorAnimation (From, To, By)
                ColorAnimationUsingKeyFrames (KeyFrames)
            DoubleAnimation (From, To, By)
                DoubleAnimationUsingKeyFrames (KeyFrames)
            PointAnimation (From, To, By)
                PointAnimationUsingKeyFrames (KeyFrames)
    TimelineGroup (Children)
        ParallelTimeline
            Storyboard (TargetName, TargetProperty, control methods)
    TimelineMarker
    Transform (X, Y)
        MatrixTransform (Matrix)
        RotateTransform (Angle, CenterXY)
        ScaleTransform (CenterXY, ScaleXY)
        SkewTransform (AngleXY, CenterXY)
        TransformGroup (Children)
        TranslateTransform (X, Y)
    Visual (CaptureMouse)
        UIElement (Clip, Opacity, Transform, Resources, Triggers, Visibility)
            FrameworkElement (Height, Width, Parent)
                Control (InitializeFromXaml)
                Glyphs 
                MediaBase (Source, Stretch)
                    MediaElement (media player)
                Panel (Background, Children)
                    Canvas (Left, Top)
                        InkPresenter (Strokes)
                TextBlock
                UIElement
                Shape
                    Ellipse
                    Line
                    Path
                    Polygon
                    Polyline
                    Rectangle
            
DependencyProperty
Duration
KeyTime
Matrix
MediaBase
    Image
Point
Rect
Size
RepeatBehavior
</pre>
<h2> <span class="mw-headline" id="Paths"> Paths </span></h2>
<p>Relationship of the various Path classes:
</p>
<ul><li> Paths contain Geometries 
<ul><li> GeometryGroup (a kind of Geometry) composes various existing geometries.  
</li><li> PathGeometry (a kind of Geometry) contain PathFigureCollections 
<ul><li> PathFigureCollections are collections that contain PathFigures
<ul><li> PathFigures are made up of PathSegments
</li></ul>
</li></ul>
</li></ul>
</li></ul>

