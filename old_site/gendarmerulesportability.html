---
layout: obsolete
title: "Gendarme.Rules.Portability"
permalink: /old_site/Gendarme.Rules.Portability/
---

<h1>Gendarme.Rules.Portability</h1>

<p><a href="{{site.baseurl}}/Gendarme" title="Gendarme">Gendarme</a>'s portability rules are located in the <b>Gendarme.Rules.Portability.dll</b> assembly.
Latest sources are available from 
<a href="http://anonsvn.mono-project.com/viewvc/trunk/mono-tools/gendarme/rules/Gendarme.Rules.Portability/" class="external text" rel="nofollow">anonymous SVN</a>.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Rules"><span class="tocnumber">1</span> <span class="toctext">Rules</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#DoNotHardcodePathsRule"><span class="tocnumber">1.1</span> <span class="toctext">DoNotHardcodePathsRule</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#ExitCodeIsLimitedOnUnixRule"><span class="tocnumber">1.2</span> <span class="toctext">ExitCodeIsLimitedOnUnixRule</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#FeatureRequiresRootPrivilegeOnUnixRule"><span class="tocnumber">1.3</span> <span class="toctext">FeatureRequiresRootPrivilegeOnUnixRule</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#MonoCompatibilityReviewRule"><span class="tocnumber">1.4</span> <span class="toctext">MonoCompatibilityReviewRule</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Version"><span class="tocnumber">1.4.1</span> <span class="toctext">Version</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#NewLineLiteralRule"><span class="tocnumber">1.5</span> <span class="toctext">NewLineLiteralRule</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Feedback"><span class="tocnumber">2</span> <span class="toctext">Feedback</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Rules"> Rules </span></h1>
<h3> <span class="mw-headline" id="DoNotHardcodePathsRule"> DoNotHardcodePathsRule </span></h3>
<p>This rule checks for strings that contain valid paths, either under Unix or Windows file systems. Path literals are often not portable across operating systems (e.g. different path separators). To ensure correct cross-platform functionality they should be replaced by calls to <b>Path.Combine</b> and/or <b>Environment.GetFolderPath</b>. 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> ReadConfig <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>FileStream fs <span style="color: #008000;">=</span> File<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;~/.local/share/myapp/user.config&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #008080; font-style: italic;">// read configuration</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> ReadConfig <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #6666cc; font-weight: bold;">string</span> config_file <span style="color: #008000;">=</span> Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">GetFolderPath</span> <span style="color: #008000;">&#40;</span>SpecialFolder<span style="color: #008000;">.</span><span style="color: #0000FF;">LocalApplicationData</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    config_file <span style="color: #008000;">=</span> Path<span style="color: #008000;">.</span><span style="color: #0000FF;">Combine</span> <span style="color: #008000;">&#40;</span>Path<span style="color: #008000;">.</span><span style="color: #0000FF;">Combine</span> <span style="color: #008000;">&#40;</span>config_file, <span style="color: #666666;">&quot;myapp&quot;</span><span style="color: #008000;">&#41;</span>, <span style="color: #666666;">&quot;user.config&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>FileStream fs <span style="color: #008000;">=</span> File<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span> <span style="color: #008000;">&#40;</span>config_file<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #008080; font-style: italic;">// read configuration</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<h3> <span class="mw-headline" id="ExitCodeIsLimitedOnUnixRule"> ExitCodeIsLimitedOnUnixRule </span></h3>
<p>This rule applies to all executable (i.e. EXE) assemblies. Something that many Windows developers might not be aware of is that on Unix systems, process exit code must be between zero and 255, unlike in Windows where it can be any valid integer value. This rule warns if the returned value might be out of range either by: 
</p>
<ul><li> returning an unknown value from <b>int Main()</b>;
</li><li> setting the <b>Environment.ExitCode</b> property; or
</li><li> calling <b>Environment.Exit(exitCode)</b> method.
</li></ul>
<p>An error is reported in case a number which is definitely out of range is returned as an exit code. 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> MainClass <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">int</span> Main <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">ExitCode</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">1000</span><span style="color: #008000;">;</span>
        Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">512</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">-</span><span style="color: #FF0000;">1</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> MainClass <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">int</span> Main <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">ExitCode</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">42</span><span style="color: #008000;">;</span>
        Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">Exit</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #FF0000;">1</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<h3> <span class="mw-headline" id="FeatureRequiresRootPrivilegeOnUnixRule"> FeatureRequiresRootPrivilegeOnUnixRule </span></h3>
<p>This rule fires if a feature is used which is, by default, restricted under Unix. 
</p>
<ul><li> <b>System.Net.NetworkInformation.Ping</b>: This type can only be used by root on Unix systems. As an alternative you can execute the ping command and parse its result.
</li><li> <b>System.Diagnostics.Process</b>: The PriorityClass property can only be set to <b>Normal</b> by non-root users. To avoid this problem you can do a platform check before assigning a priority.
</li></ul>
<p><br />
<b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;">process<span style="color: #008000;">.</span><span style="color: #0000FF;">PriorityClass</span> <span style="color: #008000;">=</span> ProcessPriorityClass<span style="color: #008000;">.</span><span style="color: #0000FF;">AboveNormal</span><span style="color: #008000;">;</span>
process<span style="color: #008000;">.</span><span style="color: #0000FF;">Start</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">OSVersion</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Platform</span> <span style="color: #008000;">!=</span> PlatformID<span style="color: #008000;">.</span><span style="color: #0000FF;">Unix</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
    process<span style="color: #008000;">.</span><span style="color: #0000FF;">PriorityClass</span> <span style="color: #008000;">=</span> ProcessPriorityClass<span style="color: #008000;">.</span><span style="color: #0000FF;">AboveNormal</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
process<span style="color: #008000;">.</span><span style="color: #0000FF;">Start</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><br />
</p>
<h3> <span class="mw-headline" id="MonoCompatibilityReviewRule"> MonoCompatibilityReviewRule </span></h3>
<p>This rule will fire if one of the assemblies being checked contains a call to a .NET method which is either not implemented on Mono or partially implemented. It does this by downloading a MoMA definitions file under <b>~/.local/share/Gendarme/</b> (on UNIX) or <b>C:\Documents and Settings\{username}\Local Settings\Application Data\Gendarme</b> (on Windows) and checking for calls to the methods therein. The rule will work without MoMA but if it does fire it may be useful to download and run MoMA. By default the rule will use the latest local version available. This can be overriden to use a specific, local, version if you want to review compatibility against a specific Mono version. You can also manually remove them, now and then, to ensure you are using the latest version. Also upgrading Gendarme will try to download a newer version of the definitions files. 
</p><p><b>Configuration</b>
</p><p>Some elements of this rule can be customized to better fit your needs.
</p>
<h4> <span class="mw-headline" id="Version"> Version </span></h4>
<p>The version of Mono against which you wish to review compatibility. You need to have this version of the definitions file downloaded in order to use it. This is useful if you want to upgrade Gendarme but still want to test compatibility against an older version of Mono. 
</p>
<h3> <span class="mw-headline" id="NewLineLiteralRule"> NewLineLiteralRule </span></h3>
<p>This rule warns if methods, including properties, are using the literal <b>\r</b> and/or <b>\n</b> for new lines. This isn't portable across operating systems. To ensure correct cross-platform functionality they should be replaced by <b>System.Environment.NewLine</b>. 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;">Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Hello,<span style="color: #008080; font-weight: bold;">\n</span>You should be using Gendarme!&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;">Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Hello,{0}You must be using Gendarme!&quot;</span>, Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">NewLine</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><br />
</p>
<h1> <span class="mw-headline" id="Feedback"> Feedback </span></h1>
<p>Please report any documentation errors, typos or suggestions to the 
<a href="http://groups.google.com/group/gendarme" class="external text" rel="nofollow">Gendarme Google Group</a>. Thanks!
</p>
