---
layout: obsolete
title: "Accessibility: GitSVN: Workflow"
permalink: /old_site/Accessibility:_GitSVN:_Workflow/
redirect_from:
  - /Accessibility:_GitSVN:_Workflow/
---

<h1>Accessibility: GitSVN: Workflow</h1>

<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Daily_Workflow_With_git-svn"><span class="tocnumber">1</span> <span class="toctext">Daily Workflow With git-svn</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Setup"><span class="tocnumber">1.1</span> <span class="toctext">Setup</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Getting_Stuff_Done_with_Feature_Branches_.28aka_Topic_Branches.29"><span class="tocnumber">1.2</span> <span class="toctext">Getting Stuff Done with Feature Branches (aka Topic Branches)</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Understanding_The_Staging_Area_.28aka_The_Index.29_and_git_status.2Fadd.2Fcommit"><span class="tocnumber">1.3</span> <span class="toctext">Understanding The Staging Area (aka The Index) and git status/add/commit</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#What_have_I_done.3F_How_to_effectively_visualize_your_changes"><span class="tocnumber">1.3.1</span> <span class="toctext">What have I done? How to effectively visualize your changes</span></a>
<ul>
<li class="toclevel-4 tocsection-6"><a href="#git_diff"><span class="tocnumber">1.3.1.1</span> <span class="toctext">git diff</span></a></li>
<li class="toclevel-4 tocsection-7"><a href="#gitk_and_git_gui"><span class="tocnumber">1.3.1.2</span> <span class="toctext">gitk and git gui</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-8"><a href="#Get_Feedback_With_Reviewboard"><span class="tocnumber">1.4</span> <span class="toctext">Get Feedback With Reviewboard</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Posting_Reviews_for_SVN_Branches"><span class="tocnumber">1.4.1</span> <span class="toctext">Posting Reviews for SVN Branches</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#Sharing_Patches_With_SVN_Users"><span class="tocnumber">1.5</span> <span class="toctext">Sharing Patches With SVN Users</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Merging_Your_Feature_Branch_Back_In_Preparation_For_a_Commit_to_SVN"><span class="tocnumber">1.6</span> <span class="toctext">Merging Your Feature Branch Back In Preparation For a Commit to SVN</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Updating_ChangeLog_Files_and_Committing_to_SVN"><span class="tocnumber">1.7</span> <span class="toctext">Updating ChangeLog Files and Committing to SVN</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Set_up_environment_variables"><span class="tocnumber">1.7.1</span> <span class="toctext">Set up environment variables</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#ChangeLog_Wrangling"><span class="tocnumber">1.7.2</span> <span class="toctext">ChangeLog Wrangling</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Preparing_a_Commit_Message"><span class="tocnumber">1.7.3</span> <span class="toctext">Preparing a Commit Message</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Committing_Your_Change_to_git"><span class="tocnumber">1.7.4</span> <span class="toctext">Committing Your Change to git</span></a>
<ul>
<li class="toclevel-4 tocsection-17"><a href="#Using_git_gui"><span class="tocnumber">1.7.4.1</span> <span class="toctext">Using git gui</span></a></li>
<li class="toclevel-4 tocsection-18"><a href="#Using_the_command_line"><span class="tocnumber">1.7.4.2</span> <span class="toctext">Using the command line</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-19"><a href="#For_those_.22oh_crap.22_moments:_undoing_a_git_commit"><span class="tocnumber">1.7.5</span> <span class="toctext">For those "oh crap" moments: undoing a git commit</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#DCommitting_Your_Change_to_SVN"><span class="tocnumber">1.7.6</span> <span class="toctext">DCommitting Your Change to SVN</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="#Appendix_A:_Branches_of_branches_of_branches_of_branches_.28why_git-cherry-pick_is_your_friend.29"><span class="tocnumber">1.8</span> <span class="toctext">Appendix A: Branches of branches of branches of branches (why git-cherry-pick is your friend)</span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="#When_to_use_git-cherry-pick"><span class="tocnumber">1.8.1</span> <span class="toctext">When to use git-cherry-pick</span></a>
<ul>
<li class="toclevel-4 tocsection-23"><a href="#Grabbing_latest_updates_from_parent_feature_branch"><span class="tocnumber">1.8.1.1</span> <span class="toctext">Grabbing latest updates from parent feature branch</span></a></li>
<li class="toclevel-4 tocsection-24"><a href="#Resuming_work_on_feature2_after_feature1_has_been_merged_and_committed_to_SVN"><span class="tocnumber">1.8.1.2</span> <span class="toctext">Resuming work on feature2 after feature1 has been merged and committed to SVN</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#Helpful_Resources"><span class="tocnumber">1.9</span> <span class="toctext">Helpful Resources</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Daily_Workflow_With_git-svn">Daily Workflow With git-svn</span></h1>
<h2> <span class="mw-headline" id="Setup">Setup</span></h2>
<p>Before reading this guide, make sure you set up your git repository according to the <a href="{{site.baseurl}}/old_site/Accessibility:_GitSVN#Getting_Started" title="Accessibility: GitSVN">Getting Started instructions</a>.
</p><p>Your git "master" branch will be associated with the remote git-svn/trunk branch that maps to SVN trunk.  If you need to you can create a local branch for each SVN remote branch like this:
</p>
<pre>git branch 1.0 git-svn/branches/1.0
git branch post-1.0-research git-svn/branches/post-1.0-research
</pre>
<p>You should only ever commit to SVN (git svn dcommit) from your local "master", "1.0", and "post-1.0-research" branches.
</p><p>Most of this documentation is written assuming you are working with a branch of "master".  If instead you are working on a different SVN branch, just replace "master" with the name of your local branch of the remote SVN branch (for example, "git branch myfeature 1.0", not "git branch myfeature master" or "git branch myfeature git-svn/branches/1.0").
</p><p><b>Note:</b> The latest versions of our cl, clm, and post-review scripts can be found in the 'tools' directory in uia2atk SVN trunk.
</p>
<h2> <span class="mw-headline" id="Getting_Stuff_Done_with_Feature_Branches_.28aka_Topic_Branches.29">Getting Stuff Done with Feature Branches (aka Topic Branches)</span></h2>
<p>For various reasons you should do all of your actual work on feature branches (sometimes called "topic" branches), which you will most likely delete after merging them back to "master" or "1.0" so that you can commit to SVN.
</p><p>Let's start a new feature for SVN trunk:
</p>
<pre>git checkout -b myfeature master
</pre>
<p>This command creates a new branch called "myfeature" from the master branch, then switches our working copy to the new branch.  It is equivalent to these commands:
</p>
<pre>git branch myfeature master
git checkout myfeature
</pre>
<p>You can see all of your local branches with the `git branch` command.  Use the -a option if you want to see remote branches, too.  The branch you are currently using will be preceded by a "*".
</p><p>So now, you go about your work as usual.  Periodically, ensure that you have the latest code from SVN:
</p>
<pre>git svn rebase
</pre>
<h2> <span class="mw-headline" id="Understanding_The_Staging_Area_.28aka_The_Index.29_and_git_status.2Fadd.2Fcommit">Understanding The Staging Area (aka The Index) and git status/add/commit</span></h2>
<p>In SVN, modified files show up in `svn status` output with a big "M", and you know that if you `svn commit` those modifications will be sent to the server.
</p><p>Git does not work this way.  In git, you have your working copy much like in SVN, but modified files do not get committed unless they are in the "staging area" (sometimes referred to as the "index").  You add a modification to the staging area the same way you add a new previously-untracked file: with `git add`.
</p><p>Let's look at an example.  Modify some files and then run `git status`:
</p>
<pre># On branch myfeature
# Changed but not updated:
#   (use "git add &lt;file&gt;..." to update what will be committed)
#   (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)
#
#	modified:   AUTHORS
#	modified:   README
#
# Untracked files:
#   (use "git add &lt;file&gt;..." to include in what will be committed)
#
#	.gitignore~
#	ChangeLog~
</pre>
<p>The text is self-explanatory as you become more comfortable with git.  We have modified two tracked files, AUTHORS and README.  These modifications are *not* going to be committed if we run `git commit`, because they are not in the staging area.  Let's follow the instructions and add one of them with `git add README`, then run `git status` again:
</p>
<pre># On branch myfeature
# Changes to be committed:
#   (use "git reset HEAD &lt;file&gt;..." to unstage)
#
#	modified:   README
#
# Changed but not updated:
#   (use "git add &lt;file&gt;..." to update what will be committed)
#   (use "git checkout -- &lt;file&gt;..." to discard changes in working directory)
#
#	modified:   AUTHORS
#
# Untracked files:
#   (use "git add &lt;file&gt;..." to include in what will be committed)
#
#	.gitignore~
#	ChangeLog~
</pre>
<p>Now we see that README has moved to the staging area ("Changes to be committed").  If we were to run `git commit` now, only the changes to README would be committed.
</p><p>If running `git add &lt;yetanotherfile&gt;` seems tedious to you, there are other ways to use the command.  Try `git add --patch`.  You can interactively decide what changes you want to stage, and the really neat thing is that you can choose to stage some modifications in a file, but not others <b>in the same file</b>.
</p><p>This `git add` thing may seem like an unnecessary extra step, and staging some modifications from a changed file but not others may seem like crack, but consider that one of the strengths of git is the ability to commit frequently.  With git, you may find yourself committing almost as frequently as you save.  You don't have to worry about using a nice log message or even breaking the build, because these commits are all local to you, and you will clean everything up before you commit it to SVN.
</p><p>Whenever you feel like committing some staged changes in your feature branch, do so with:
</p>
<pre>git commit -m "My message"
</pre>
<h3> <span class="mw-headline" id="What_have_I_done.3F_How_to_effectively_visualize_your_changes">What have I done? How to effectively visualize your changes</span></h3>
<h4> <span class="mw-headline" id="git_diff">git diff</span></h4>
<p>The github folks have done a wonderful job of explaining in simple terms how to use git diff to see unstaged changes, staged changes, all changes since your last commit, and all changes from the original branch.  Please read this great little guide: <a href="http://learn.github.com/p/diff.html" class="external free" rel="nofollow">http://learn.github.com/p/diff.html</a>
</p>
<h4> <span class="mw-headline" id="gitk_and_git_gui">gitk and git gui</span></h4>
<p>TODO: Use gitk to visualize committed changes (total repository history).  `gitk --all` to show all branches, `gitk &lt;somefile&gt;` to view just that file's history.  It can also show blames/annotations.  Basically, gitk is a super-fast replacement for viewvc.  I recommend everyone keep an up-to-date git repository even if they prefer to use SVN for day-to-day work, just for the ability to run gitk.
</p><p>TODO: Use git gui to visualize uncommitted changes.  You can use this as a commit gui, which is explained later.
</p>
<h2> <span class="mw-headline" id="Get_Feedback_With_Reviewboard">Get Feedback With Reviewboard</span></h2>
<p>Make sure you are familiar with our <a href="{{site.baseurl}}/old_site/Accessibility:_Reviews" title="Accessibility: Reviews">code review policy</a>.
</p><p>When you're ready for a review, make sure all of your changes are committed in the feature branch, then run `<a href="{{site.baseurl}}/old_site/Accessibility:_Reviews#Submitting_Review_Requests" title="Accessibility: Reviews">post-review</a>` from the feature branch.  For git, only committed changes will be included in the Reviewboard diff.
</p><p>If you experience any errors when running post-review, please send them to Brad or Sandy.  It would be especially helpful if you could reproduce with the "-d" (debug) option.
</p>
<h3> <span class="mw-headline" id="Posting_Reviews_for_SVN_Branches">Posting Reviews for SVN Branches</span></h3>
<p>We have added a custom option to post-review, "--gitsvnparent", which you can use if you are posting a review for one of our SVN branches.  For example, if you have SVN remote branch "git-svn/branches/1.0", with associated local branch "1.0", and feature branch "my-1.0-fix", then if you have committed your fix in "my-1.0-fix", you can run `post-review --gitsvnparent=1.0` from your feature branch.
</p><p>Please note that "--gistsvnparent" is not supported by upstream Reviewboard, but <a href="http://code.google.com/p/reviewboard/issues/detail?id=999" class="external text" rel="nofollow">we are working with them</a> to get this feature (or an equivalent) in.  Therefore these instructions might change in the future.
</p>
<h2> <span class="mw-headline" id="Sharing_Patches_With_SVN_Users">Sharing Patches With SVN Users</span></h2>
<p>You may notice that the diffs create by `git diff` do not apply correctly in an SVN checkout.  To make an SVN-style diff, use the --no-prefix option.
</p>
<h2> <span class="mw-headline" id="Merging_Your_Feature_Branch_Back_In_Preparation_For_a_Commit_to_SVN">Merging Your Feature Branch Back In Preparation For a Commit to SVN</span></h2>
<p>So by now, you have committed all of your desired changes in your feature branch, and you have had those changes reviewed.  You are ready to commit to SVN.  Because we want your change to appear as <b>one commit</b> in SVN, we merge in all of the changes at once with the --squash option:
</p>
<pre>git checkout master
git svn rebase
git merge --squash myfeature
</pre>
<p>Now all of the changes you made on your feature branch have been applied to your working copy in master, and are staged for commit.  It is now time to update your ChangeLog files, commit everything (to git) in a nice SVN-style commit, and then dcommit up to SVN.
</p>
<h2> <span class="mw-headline" id="Updating_ChangeLog_Files_and_Committing_to_SVN">Updating ChangeLog Files and Committing to SVN</span></h2>
<p>Sadly, MonoDevelop has no git support, so the process of updating ChangeLog files and generating commit messages is slightly less automated.  However, we do have two scripts from Brad (with updates for git from Sandy) that make the process quite nice: cl and clm (found in uia2atk/tools/ in master).
</p>
<h3> <span class="mw-headline" id="Set_up_environment_variables">Set up environment variables</span></h3>
<p>cl requires some environment variables to be set.  I recommend adding the following lines to your ~/.bashrc file:
</p>
<pre>export CHANGE_LOG_NAME="Joe Awesome"
export CHANGE_LOG_EMAIL_ADDRESS="jawesome@novell.com"
</pre>
<h3> <span class="mw-headline" id="ChangeLog_Wrangling">ChangeLog Wrangling</span></h3>
<p>The only really manual part of the process is finding each ChangeLog on your own (if you have a way to automate please share!).  For each ChangeLog file, do the following:
</p>
<ul><li> cd to the ChangeLog file's parent directory.
</li><li> Open the ChangeLog file in vim.
</li><li> Type Shift+o to insert at line 0.
</li><li> Type escape, then ":r!cl" to execute the cl script.  You may need to delete a blank line inserted at the top.
</li><li> Type "i" to return to edit mode.
</li><li> This should insert a nice template for editing your ChangeLog.  If for some reason you have modifications that are not tracked by git, you will see big "WARNING" lines.  Please either stage the modifications with `git add`, or remove the relevant lines from your ChangeLog template.
</li><li> When you are finished, save your changes by typing escape, then "ZZ".
</li><li> To stage your ChangeLog file modifications, don't forget to `git add ChangeLog`.
</li></ul>
<p>If you do not like vim, you can replace all but the last step with just copying the output of `cl` into your favorite text editor.  Just make sure to run `cl` from the same directory as the ChangeLog.
</p>
<h3> <span class="mw-headline" id="Preparing_a_Commit_Message">Preparing a Commit Message</span></h3>
<p>When you have finished updating all of your ChangeLog files, you can run `clm` from the root of your git repo to see what your commit message will look like (the leading "#" characters are there so you can quickly quit your editor to abort a commit; you will delete them when you actually commit).  If anything seems to be missing, then you probably forgot to `git add` one of your ChangeLog modifications.
</p>
<h3> <span class="mw-headline" id="Committing_Your_Change_to_git">Committing Your Change to git</span></h3>
<p>You will now use clm to help you make a SVN-style commit into your git repo, in preparation for dcommitting to SVN.  Remember, you can only run clm from the root of your git repo.
</p>
<h4> <span class="mw-headline" id="Using_git_gui">Using git gui</span></h4>
<p>If you would like a convenient way to view all your diffs before you hit the "commit" button, you should try `git gui`.  Copy the output of clm and paste it into the Commit Message box in git gui.  You can click on files in the Staged Changes list to see the diffs that are going to be committed.  When you are ready to commit to git, delete the leading "#" in each line of your commit message, and click the Commit button.
</p>
<h4> <span class="mw-headline" id="Using_the_command_line">Using the command line</span></h4>
<p><i>NOTE</i>: clm updated on April 9th, please make sure you are using the latest version.
</p><p>From the root of your git repo:
</p>
<ul><li> Run `git commit`
</li><li> In the vim prompt, type escape then ":r!clm"
</li><li> Uncomment lines that you want to appear in the commit message by deleting the leading "#" (delete any extra blank lines, too)
</li><li> Type escape then "ZZ" to save your message, exit vim, and complete the commit
</li></ul>
<h3> <span class="mw-headline" id="For_those_.22oh_crap.22_moments:_undoing_a_git_commit">For those "oh crap" moments: undoing a git commit</span></h3>
<p>Uh oh, you accidentally made a commit to the wrong git branch!  Or, you realized at the last minute that this change you were about to dcommit to SVN is not correct.  Or you accidentally did a git-style commit directly to master, because you forgot to checkout your feature branch.  Let's fix that!
</p><p>In the resources section you'll find a great little article on how to undo all sorts of changes in git (staged, unstaged, committed, etc).  The summary for undoing a recent commit is that you find the commit hash of the commit that you *want* to be at the top with:
</p>
<pre>git log --pretty=oneline
</pre>
<p>Then you reset your repository to go back to that commit:
</p>
<pre>git reset --hard 43a5e690  #Use the first 8 characters of the desired hash
</pre>
<p>Any commit that was listed above this one is now completely gone. &#160;:-)
</p><p><b>IMPORTANT</b>: Never use this to undo commits that are already in SVN!  You will break everything if you do.
</p>
<h3> <span class="mw-headline" id="DCommitting_Your_Change_to_SVN">DCommitting Your Change to SVN</span></h3>
<p>Now that your change has been committed to git (and you can verify it using `git log` or gitk, as you like), it is time to dcommit to SVN.
</p>
<pre>git svn rebase  #Just to be sure&#160;:-)
git svn dcommit
</pre>
<p>Congratulations!  You committed to SVN from git!
</p><p>If you like, you may now delete your feature branch:
</p>
<pre>git branch -D myfeature
</pre>
<h2> <span class="mw-headline" id="Appendix_A:_Branches_of_branches_of_branches_of_branches_.28why_git-cherry-pick_is_your_friend.29">Appendix A: Branches of branches of branches of branches (why git-cherry-pick is your friend)</span></h2>
<p>You may find yourself in a situation where you are waiting for review of feature1, but need to start working on feature2, which depends on feature1.  So you do something like this:
</p>
<pre>git checkout -b feature1+2 feature1
</pre>
<p>Here are some fun facts about this arrangement:
</p>
<ul><li> In gitk --all, you'll see that both feature1 and feature1+2 are branched directly off of trunk, with identical commits (feature1+2 does not appear to be branched off of feature1 as you might expect).
</li><li> If, during the course of review, you make updates to feature1, a simple `git merge` is probably not going to work to get those changes into feature1+2.
</li><li> Once you have squash-merged feature1 into master, and committed to trunk, your feature1 and feature1+2 branches will break if you try to `git svn rebase` in them.
</li></ul>
<p>How do we resolve this seemingly hopeless situation?  The answer is to use git-cherry-pick.
</p><p>"Cherry-picking" means copying a single commit from one branch into your current branch.  Now I will explain the best way to use it in some common situations.
</p>
<h3> <span class="mw-headline" id="When_to_use_git-cherry-pick">When to use git-cherry-pick</span></h3>
<h4> <span class="mw-headline" id="Grabbing_latest_updates_from_parent_feature_branch">Grabbing latest updates from parent feature branch</span></h4>
<p>You have branched feature1+2 from feature1, which is going through the review process.  You have recently committed changes to feature1 which you want in feature1+2.  You should:
</p>
<ul><li> Make sure you have no uncommitted changes in feature1 or feature1+2
</li><li> `git svn rebase` in feature1 and feature1+2
</li><li> git checkout feature1+2
</li><li> gitk --all
</li><li> Find the commits you want in the feature1 branch, right-click, and select "Cherry-pick this commit"
</li></ul>
<h4> <span class="mw-headline" id="Resuming_work_on_feature2_after_feature1_has_been_merged_and_committed_to_SVN">Resuming work on feature2 after feature1 has been merged and committed to SVN</span></h4>
<p>You branched feature1+2 from feature1, and now feature1 has been reviewed, merged into master, and committed to SVN.  The problem now is that because we use squashed merges, the history of master and of feature1+2 will conflict (because many commits from feature1 were squashed into one commit in master).  Here is one way to fix the problem:
</p>
<ul><li> git checkout master
</li><li> git svn rebase
</li><li> git checkout -b feature2 (we are creating a brand new branch!)
</li><li> gitk --all
</li><li> Find the feature2-related commits in the older feature1+2 branch, right-click, and select "Cherry-pick this commit"
</li><li> `git diff feature1+2 feature2`  to verify that everything in the new feature2 branch looks correct (only changes should be ChangeLog files from the commit to master before dcommitting to SVN).
</li><li> git branch -D feature1+2
</li></ul>
<h2> <span class="mw-headline" id="Helpful_Resources">Helpful Resources</span></h2>
<ul><li> <a href="http://www.viget.com/extend/effectively-using-git-with-subversion/" class="external free" rel="nofollow">http://www.viget.com/extend/effectively-using-git-with-subversion/</a> - An easy-to-understand git-svn workflow.
</li><li> <a href="http://book.git-scm.com/index.html" class="external free" rel="nofollow">http://book.git-scm.com/index.html</a> - The git community book
</li><li> <a href="http://learn.github.com/p/diff.html" class="external free" rel="nofollow">http://learn.github.com/p/diff.html</a> - An easy-to-understand explanation of how to use `git diff` when dealing with untracked, unstaged, or uncommitted changes
</li><li> <a href="http://learn.github.com/p/undoing.html" class="external free" rel="nofollow">http://learn.github.com/p/undoing.html</a> - Undoing changes is a little more complicated than a simple `svn revert`.
</li><li> <a href="http://learn.github.com/p/git-svn.html" class="external free" rel="nofollow">http://learn.github.com/p/git-svn.html</a> - A page that explains git-svn simply, in case you feel like you don't quite have your head wrapped around the concept yet.
</li><li> <a href="http://www.gitready.com/" class="external free" rel="nofollow">http://www.gitready.com/</a> - A great set of articles on beginner, intermediate, and advanced features of git.
</li><li> <a href="http://git.or.cz/course/svn.html" class="external free" rel="nofollow">http://git.or.cz/course/svn.html</a> - See the git equivalent of common svn commands
</li></ul>

