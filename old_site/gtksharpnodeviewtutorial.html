---
layout: obsolete
title: "GtkSharpNodeViewTutorial"
permalink: /old_site/GtkSharpNodeViewTutorial/
redirect_from:
  - /GtkSharpNodeViewTutorial/
---

<h1>GtkSharpNodeViewTutorial</h1>

<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Model.2FView_Separation"><span class="tocnumber">2</span> <span class="toctext">Model/View Separation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Model"><span class="tocnumber">2.1</span> <span class="toctext">Model</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#View"><span class="tocnumber">2.2</span> <span class="toctext">View</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Your_first_NodeView"><span class="tocnumber">3</span> <span class="toctext">Your first NodeView</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Setting_it_up"><span class="tocnumber">3.1</span> <span class="toctext">Setting it up</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Getting_Interactive"><span class="tocnumber">4</span> <span class="toctext">Getting Interactive</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Introduction"> Introduction </span></h1>
<p>The GTK TreeView widget is used to display data in lists and hierarchical trees. Each row in the tree or list can contain multiple columns. The TreeView API can be a little overwhelming, so we've provided the NodeView convenience APIs in Gtk# to help simplify its use.
</p><p>This tutorial is a brief introduction to the NodeView, NodeSelection, and NodeStore APIs with small samples to help get you started.  Keep in mind that the NodeView is a work in progress, and doesn't expose all of the underlying power of the TreeView, but is quite useful for simple List and Tree user interfaces.
</p>
<h1> <span class="mw-headline" id="Model.2FView_Separation"> Model/View Separation </span></h1>
<p>The NodeView, like TreeView, uses the Model-View-Controller (MVC) design pattern. The NodeStore model stores data to be displayed.  The NodeView, which is a thin subclass of TreeView, displays the data. The NodeSelection allows access to the selection state of the NodeView.
</p>
<h2> <span class="mw-headline" id="Model"> Model </span></h2>
<p>The NodeStore implements the Gtk.TreeModel interface to provide both List and Tree data to a NodeView for display.  When you create a NodeStore, you specify the node Type which it will contain.  The Type must implement the ITreeNode interface.  The NodeStore is then populated with instances of this type to expose your data.
</p><p>The TreeNode class is provided as a helper for exposing the ITreeNode interface. You can simply subclass TreeNode to create your node Type, or implement ITreeNode directly if you want to reuse an existing type to expose your data. The organization of the data within the Node is specified by annotating fields and properties with the TreeNodeValue attribute.  
</p>
<h2> <span class="mw-headline" id="View"> View </span></h2>
<p>The View is made up of three different elements - NodeView, TreeViewColumn, and CellRenderer.
</p><p>The NodeView widget is a thin subclass of TreeView, so most of the layout description is done via the underlying TreeView API. 
</p><p>Each TreeViewColumn contains at least one CellRenderer. Cell renderers are what actually display the data - items in the model are bound to cell renderer attributes.
</p><p>The following cell renderers are available:
</p>
<ul><li> <b>CellRendererText</b> - Used to display text
</li><li> <b>CellRendererPixbuf</b> - Used to display images
</li><li> <b>CellRendererProgress</b> - Used to display a progress bar
</li><li> <b>CellRendererCombo</b> - Used to display a drop-down box
</li><li> <b>CellRendererToggle</b> - Used to display a check box
</li></ul>
<p>CellRenderers are separate from TreeViewColumns for added flexibility, allowing you to have an extremely fine-tuned treeview tailored to your application. For example you can pack an image and text into the same column, which often makes much more sense than creating a separate column for each.
</p>
<h1> <span class="mw-headline" id="Your_first_NodeView"> Your first NodeView </span></h1>
<h2> <span class="mw-headline" id="Setting_it_up"> Setting it up </span></h2>
<p>Here is a basic example of how to use the NodeView and all its related components. In our example, we will show a simple list of song titles and artist names.  The first step is defining our node type, which we do by subclassing the TreeNode helper class:
</p>
<pre class="csharp" style="font-family:monospace;">        <span style="color: #008000;">&#91;</span>Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">TreeNode</span> <span style="color: #008000;">&#40;</span>ListOnly<span style="color: #008000;">=</span><span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
        <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> MyTreeNode <span style="color: #008000;">:</span> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">TreeNode</span> <span style="color: #008000;">&#123;</span>
&#160;
                <span style="color: #6666cc; font-weight: bold;">string</span> song_title<span style="color: #008000;">;</span>
&#160;
                <span style="color: #0600FF; font-weight: bold;">public</span> MyTreeNode <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> artist, <span style="color: #6666cc; font-weight: bold;">string</span> song_title<span style="color: #008000;">&#41;</span>
                <span style="color: #008000;">&#123;</span>
                        Artist <span style="color: #008000;">=</span> artist<span style="color: #008000;">;</span>
                        <span style="color: #0600FF; font-weight: bold;">this</span><span style="color: #008000;">.</span><span style="color: #0000FF;">song_title</span> <span style="color: #008000;">=</span> song_title<span style="color: #008000;">;</span>
                <span style="color: #008000;">&#125;</span>
&#160;
                <span style="color: #008000;">&#91;</span>Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">TreeNodeValue</span> <span style="color: #008000;">&#40;</span>Column<span style="color: #008000;">=</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
                <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">string</span> Artist<span style="color: #008000;">;</span>
&#160;
                <span style="color: #008000;">&#91;</span>Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">TreeNodeValue</span> <span style="color: #008000;">&#40;</span>Column<span style="color: #008000;">=</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#93;</span>
                <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">string</span> SongTitle <span style="color: #008000;">&#123;</span><span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span> <span style="color: #0600FF; font-weight: bold;">return</span> song_title<span style="color: #008000;">;</span> <span style="color: #008000;">&#125;</span> <span style="color: #008000;">&#125;</span>
        <span style="color: #008000;">&#125;</span></pre>
<p>TreeNode takes care of all the ITreeNode interface magic for us, so all we have to do is identify which fields and properties represent model column information and which column index they represent.  Only fields and properties can be annotated with the TreeNodeValue attribute.  
</p><p>In the above code we expose the Artist field as column 0 of the model, and the SongTitle property as column 1.  We will later bind these columns by this index to a specific renderer in the NodeView.
</p><p>Note also that we Added a TreeNode attribute to the class declaration to specify the data is a flat list as opposed to a hierarchical tree with children on the root nodes.  If you are creating a hierarchical tree, the TreeNode attribute is not necessary.
</p><p>The next step is to create our Application window:
</p>
<pre class="csharp" style="font-family:monospace;">        <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> NodeViewExample <span style="color: #008000;">:</span> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Window</span> <span style="color: #008000;">&#123;</span>
&#160;
                <span style="color: #0600FF; font-weight: bold;">public</span> NodeViewExample <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">:</span> <span style="color: #0600FF; font-weight: bold;">base</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;NodeView&quot;</span><span style="color: #008000;">&#41;</span>
                <span style="color: #008000;">&#123;</span>
                        SetSizeRequest <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">200</span>,<span style="color: #FF0000;">150</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
                        <span style="color: #008080; font-style: italic;">// Create our TreeView and add it as our child widget</span>
                        Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeView</span> view <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeView</span> <span style="color: #008000;">&#40;</span>Store<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                        <span style="color: #0600FF; font-weight: bold;">Add</span> <span style="color: #008000;">&#40;</span>view<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
                        <span style="color: #008080; font-style: italic;">// Create a column with title Artist and bind its renderer to model column 0</span>
                        view<span style="color: #008000;">.</span><span style="color: #0000FF;">AppendColumn</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Artist&quot;</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">CellRendererText</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #666666;">&quot;text&quot;</span>, <span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
                        <span style="color: #008080; font-style: italic;">// Create a column with title 'Song Title' and bind its renderer to model column 1</span>
                        view<span style="color: #008000;">.</span><span style="color: #0000FF;">AppendColumn</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Song Title&quot;</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">CellRendererText</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>, <span style="color: #666666;">&quot;text&quot;</span>, <span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                        view<span style="color: #008000;">.</span><span style="color: #0000FF;">ShowAll</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                <span style="color: #008000;">&#125;</span>
&#160;
                <span style="color: #0600FF; font-weight: bold;">protected</span> <span style="color: #0600FF; font-weight: bold;">override</span> <span style="color: #6666cc; font-weight: bold;">bool</span> OnDeleteEvent <span style="color: #008000;">&#40;</span>Gdk<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Event</span> ev<span style="color: #008000;">&#41;</span>
                <span style="color: #008000;">&#123;</span>
                        Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Quit</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
                <span style="color: #008000;">&#125;</span></pre>
<p>We derive a Gtk.Window subclass and override its OnDeleteEvent handler to shutdown the application gracefully on a window manager close event.  The constructor creates a NodeView using a Store property that will be defined in the next code snippet.  The view is added as the window's child and we append a couple of TreeViewColumns to the view.  The columns each have a single CellRendererText renderer with its text attribute bound to the model column indexes exposed by MyTreeNode.  Then we do a ShowAll on the view to make it visible when the window is shown.
</p><p>The Store property is defined as follows:
</p>
<pre class="csharp" style="font-family:monospace;">                Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeStore</span> store<span style="color: #008000;">;</span>
                Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeStore</span> Store <span style="color: #008000;">&#123;</span>
                        <span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
                                <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>store <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
                                        store <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeStore</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span style="color: #008000;">typeof</span></a> <span style="color: #008000;">&#40;</span>MyTreeNode<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                                        store<span style="color: #008000;">.</span><span style="color: #0000FF;">AddNode</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> MyTreeNode <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;The Beatles&quot;</span>, <span style="color: #666666;">&quot;Yesterday&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                                        store<span style="color: #008000;">.</span><span style="color: #0000FF;">AddNode</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> MyTreeNode <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Peter Gabriel&quot;</span>, <span style="color: #666666;">&quot;In Your Eyes&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                                        store<span style="color: #008000;">.</span><span style="color: #0000FF;">AddNode</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> MyTreeNode <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Rush&quot;</span>, <span style="color: #666666;">&quot;Fly By Night&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                                <span style="color: #008000;">&#125;</span>
                                <span style="color: #0600FF; font-weight: bold;">return</span> store<span style="color: #008000;">;</span>
                        <span style="color: #008000;">&#125;</span>
                <span style="color: #008000;">&#125;</span></pre>
<p>If we haven't already built it, we create a NodeStore which will contain MyTreeNodes.  Then we instantiate a few MyTreeNodes and add them to the store.  All that's left is a Main method, which is pretty standard for any Gtk# program:
</p>
<pre class="csharp" style="font-family:monospace;">                <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
                <span style="color: #008000;">&#123;</span>
                        Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Init</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                        NodeViewExample win <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> NodeViewExample <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                        win<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                        Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Application</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Run</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                <span style="color: #008000;">&#125;</span></pre>
<p>The whole sample named "Simple NodeView" can be found [http:/GtkSharpNodeViewTutorialExamples here] and when compiled and executed it looks like this:
</p><p><a href="{{site.baseurl}}/images/old_site/0/04/GtkSharpNodeViewSimple.png" class="image"><img alt="GtkSharpNodeViewSimple.png" src="{{site.baseurl}}/images/old_site/0/04/GtkSharpNodeViewSimple.png" width="210" height="179" /></a>
</p>
<h1> <span class="mw-headline" id="Getting_Interactive"> Getting Interactive </span></h1>
<p>This sample demonstrates the use of NodeSelection to react to changes in the selection state of the NodeView.  We'll build on the source of the previous example by adding a Label field to display information about the currently selected node in the NodeView.
</p><p>To monitor the selection state of the NodeView, we connect an event handler to the NodeSelection's Changed event:
</p>
<pre class="csharp" style="font-family:monospace;">                        view<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeSelection</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Changed</span> <span style="color: #008000;">+=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">EventHandler</span> <span style="color: #008000;">&#40;</span>OnSelectionChanged<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>The event handler grabs the currently selected node and updates the new label widget accordingly:
</p>
<pre class="csharp" style="font-family:monospace;">                <span style="color: #6666cc; font-weight: bold;">void</span> OnSelectionChanged <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, <span style="color: #000000;">System</span><span style="color: #008000;">.</span><span style="color: #0000FF;">EventArgs</span> args<span style="color: #008000;">&#41;</span>
                <span style="color: #008000;">&#123;</span>
                        Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeSelection</span> selection <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">NodeSelection</span><span style="color: #008000;">&#41;</span> o<span style="color: #008000;">;</span>
                        MyTreeNode node <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>MyTreeNode<span style="color: #008000;">&#41;</span> selection<span style="color: #008000;">.</span><span style="color: #0000FF;">SelectedNode</span><span style="color: #008000;">;</span>
                        label<span style="color: #008000;">.</span><span style="color: #0000FF;">Text</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Current Selection: <span style="color: #008080; font-weight: bold;">\&quot;</span>&quot;</span> <span style="color: #008000;">+</span> node<span style="color: #008000;">.</span><span style="color: #0000FF;">SongTitle</span> <span style="color: #008000;">+</span> <span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\&quot;</span> by &quot;</span> <span style="color: #008000;">+</span> node<span style="color: #008000;">.</span><span style="color: #0000FF;">Artist</span><span style="color: #008000;">;</span>
                <span style="color: #008000;">&#125;</span></pre>
<p>Note that all the complexity of TreeIters and GValues is removed and you can access your data in a nice object-oriented fashion.  The NodeSelection API exposes ITreeNodes which can be cast to get directly at the data.
</p><p>The complete source for this sample, Interactive NodeView, can be found [http:/GtkSharpNodeViewTutorialExamples here] and when compiled and executed, it produces the following application:
</p><p><br />
<a href="{{site.baseurl}}/images/old_site/9/96/GtkSharpNodeViewInteractive.png" class="image"><img alt="GtkSharpNodeViewInteractive.png" src="{{site.baseurl}}/images/old_site/9/96/GtkSharpNodeViewInteractive.png" width="310" height="254" /></a>
</p>
