---
layout: obsolete
title: "GtkGLAreaSharp:With MonoDevelop"
permalink: /old_site/GtkGLAreaSharp:With_MonoDevelop/
redirect_from:
  - /GtkGLAreaSharp:With_MonoDevelop/
---

<h1>GtkGLAreaSharp:With MonoDevelop</h1>

<p>There are few steps involved in getting a simple OpenGL project working with MonoDevelop. 
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Getting_GtkGLAreaSharp"> Getting GtkGLAreaSharp </span></h3>
<p>First step is get all the packages. Open a console and go to a folder where you want to download cj's script. Run it with:
</p>
 <pre class="nowiki" style="font-family:monospace;">wget http://colliertech.org/svn/openGL/gtkgl-build/build.sh &amp;&amp; sh ./build.sh</pre>
<p>This script will download and compile all the software required into your $HOME/opt folder. Go to this folder and you will see three folders: include, lib &amp; src.
</p><p>Inside lib is the libgtkgl-2.0.so.1.0.0 which is the actual system library that GtkGLAreaSharp wraps around to bring GtkGLArea into Mono. At this point we should first check if the library works on your setup. If it does not, then there's no point continuing until this is right. Come out of the lib folder and make your way to $HOME/opt/src/gtkgl/gtkglarea-1.99.0/examples
</p><p>Run the simple demo with:
</p>
<pre>./simple
</pre>
<p>If you get a black and white divided box in a Gtk window, then all is well on that side. If you get nothing but a grey Gtk window, there something wrong with your hardware OpenGL setup. This was the case for me first time around. I restarted X using the vesa driver then again with the nvidia driver and all was fine. Not sure why it fixed itself.
</p><p>Now to check the mono side. Make your way to $HOME/opt/src/gtkgl/gtkglarea-sharp-0.0.15/examples/trackball
</p><p>To build the example use:
</p>
<pre>make run
</pre>
<p>If all is well, you will get a Gtk window with a teapot. If not, you may end with an error such as:
</p>
<pre>MONO_PATH=./../util mono --debug TrackballExample.exe

** (TrackballExample.exe:26013): WARNING **: The following assembly referenced from /home/wayne/opt/src/gtkgl/gtkglarea-sharp-0.0.15/examples/util/gtkglarea-sharp-util.dll could not be loaded:
     Assembly:   gtkglarea-sharp    (assemblyref_index=0)
     Version:    0.0.3.0
     Public Key: 7df758c0fb49fe62
The assembly was not found in the Global Assembly Cache, a path listed in the MONO_PATH environment variable, or in the location of the executing assembly (/home/wayne/opt/src/gtkgl/gtkglarea-sharp-0.0.15/examples/util/).


** (TrackballExample.exe:26013): WARNING **: The class GtkGL.GLArea could not be loaded, used in /home/wayne/opt/src/gtkgl/gtkglarea-sharp-0.0.15/examples/util/gtkglarea-sharp-util.dll (token 0x01000001)

** ERROR **: file class.c: line 2119 (mono_class_setup_parent): should not be reached
aborting...
make: *** [run] Aborted
</pre>
<p>If this is the case you will need to type the following:
</p>
<pre>. ~/_devenv.sh (that's DOT SPACE _devenv)
</pre>
<p>and try again:
</p>
<pre>make run
</pre>
<p>This time you should have the Gtk window and a teapot. You can even click and drag the mouse to rotate the teapot.
</p>
<h3> <span class="mw-headline" id="Getting_a_project_started_in_MonoDevelop"> Getting a project started in MonoDevelop </span></h3>
<p>First things first obviously load up MonoDevelop and start a Gtk# 2.0 project. Bring up the MyWindow.cs file and change the entire contents to the following:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">Gtk</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">GtkSharp</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">GtkGL</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> MyWindow
	<span style="color: #008000;">&#123;</span>
		Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Window</span> win<span style="color: #008000;">;</span>
		GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">Teapot</span> pot<span style="color: #008000;">;</span>
		GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">GLWidget</span> glWidget<span style="color: #008000;">;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">public</span> MyWindow <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
		<span style="color: #008000;">&#123;</span>
			win <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Window</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;My Gtk Window&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			win<span style="color: #008000;">.</span><span style="color: #0000FF;">DeleteEvent</span> <span style="color: #008000;">+=</span> CloseWindow<span style="color: #008000;">;</span>
			win<span style="color: #008000;">.</span><span style="color: #0000FF;">Resize</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">400</span>, <span style="color: #FF0000;">400</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			glWidget <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">GLWidget</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			glWidget<span style="color: #008000;">.</span><span style="color: #0000FF;">GLSetup</span> <span style="color: #008000;">+=</span> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">GLWidget</span><span style="color: #008000;">.</span><span style="color: #0000FF;">EnableLighting</span><span style="color: #008000;">;</span>
			pot <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">Teapot</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			pot<span style="color: #008000;">.</span><span style="color: #0000FF;">Translate</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">-</span><span style="color: #FF0000;">0.0</span>, <span style="color: #FF0000;">0.0</span>, <span style="color: #FF0000;">3</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			glWidget<span style="color: #008000;">.</span><span style="color: #0000FF;">AddGLObject</span><span style="color: #008000;">&#40;</span>pot<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			win<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span>glWidget<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>			
&#160;
			win<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			glWidget<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>			
		<span style="color: #008000;">&#125;</span>	
&#160;
		<span style="color: #6666cc; font-weight: bold;">void</span> CloseWindow<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, DeleteEventArgs args<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#123;</span>
			Application<span style="color: #008000;">.</span><span style="color: #0000FF;">Quit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			args<span style="color: #008000;">.</span><span style="color: #0000FF;">RetVal</span> <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span> <span style="color: #008080; font-style: italic;">//this is necessary to stop an error on close.</span>
		<span style="color: #008000;">&#125;</span>
	<span style="color: #008000;">&#125;</span></pre>
<p>Run the example and you should get errors:
</p>
<pre>Cannot find type 'GtkGL.Teapot
The namespace `GtkGL' can not be found (missing assembly reference?)
</pre>
<p>Teapot is contained in the shapes.dll assembly which lives in examples/shapes. But Mono does not know about this folder. Mono only knows about the $HOME/opt/lib/mono folder. Also, GtkGL is contained in the gtkglarea-sharp-util.dll assembly which is found at examples/util. Copy these two dll files to: $HOME/opt/lib/mono/gtkglarea-sharp
</p><p>Edit References, and and click on the .NET Assembly tab. Browse to the $HOME/opt/lib/mono/gtkglarea-sharp folder. Select the gtkglarea-sharp-util.dll first and add that. Then shapes.dll. For some strange reason, adding shapes.dll first might crash mono. Finally, add: gtkglarea-sharp.dll.
</p><p>When you run the program now, you can expect to receive the following error:
</p>
<pre>Unhandled Exception: System.TypeInitializationException: An exception was thrown by the type initializer for GtkGL.GLArea ---&gt; System.DllNotFoundException: libgtkglarea-win32-2.0-0.dll
</pre>
<p>Two things need to be fixed here.
</p><p>1. Mono needs a dll name translation
</p><p>Mono is looking for the native libgtkglarea-win32-2.0-0.dll. We don't have this file on the system. But we do have libgtkgl-2.0.so which is the library that GtkGLAreaSharp wraps around. It's pretty important that Mono can load this file. Therefore we have to add a lookup to the Mono config file. In most installations, this config file is found at /etc/mono/config. You can add a lookup line into this with: 
</p>
<pre>vi /etc/mono/config

</pre>
<p>The inserted entry in the config should look something like this:
</p><p><br />
</p>
<pre>&lt;configuration&gt;
	&lt;dllmap dll="libgtkglarea-win32-2.0-0.dll" target="libgtkgl-2.0.so.1" /&gt;

	&lt;dllmap dll="cygwin1.dll" target="libc.so.6" /&gt;
	&lt;dllmap dll="libc" target="libc.so.6" /&gt;
	&lt;dllmap dll="libintl" target="libc.so.6" /&gt;
	&lt;dllmap dll="libxslt.dll" target="libxslt.so" /&gt;
	&lt;dllmap dll="libmySQL.dll" target="libmysqlclient.so" /&gt;
	&lt;dllmap dll="odbc32.dll" target="libodbc.so" /&gt;
	&lt;dllmap dll="oci" target="clntsh" /&gt;
	&lt;dllmap dll="db2cli" target="libdb2_36.so"/&gt;
	&lt;dllmap dll="msvcrt" target="libc.so.6"/&gt;
	&lt;dllmap dll="MonoPosixHelper" target="libMonoPosixHelper.so"/&gt;

	..etc etc
&lt;/configuration&gt;
</pre>
<p><br />
</p><p>2. linux doesn't know what lib folder libgtkgl-2.0.so.1.0.0 lives in.
</p><p>The libgtkgl-2.0.so.1.0.0 file was installed to $HOME/opt/lib so therefore you need to add (for example) /home/wayne/opt/lib to your /etc/ld.so.conf file. Remember to do an ldconfig afterwards so that the path is added to the linux system permanently.
</p><p>Now run the program and you should get a Gtk# Window with a GLWidget containing a teapot. To make it more interesting we can add a GLib.Timeout event to trigger some animation:
</p>
<pre class="csharp" style="font-family:monospace;">Lib<span style="color: #008000;">.</span><span style="color: #0000FF;">Timeout</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GLib<span style="color: #008000;">.</span><span style="color: #0000FF;">TimeoutHandler</span><span style="color: #008000;">&#40;</span>Animate<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>And our Animate routine:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">bool</span> Animate<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#123;</span>
	GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">EulerRotation</span> rot <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">EulerRotation</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0.02</span>, <span style="color: #FF0000;">0.0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">Quaternion</span> q <span style="color: #008000;">=</span> rot<span style="color: #008000;">.</span><span style="color: #0000FF;">ToQuaternion</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	pot<span style="color: #008000;">.</span><span style="color: #0000FF;">Rotate</span><span style="color: #008000;">&#40;</span>q<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
	<span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>So that the program looks like this:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">Gtk</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">GtkSharp</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">GtkGL</span><span style="color: #008000;">;</span>
&#160;
	<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> MyWindow
	<span style="color: #008000;">&#123;</span>
		Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Window</span> win<span style="color: #008000;">;</span>
		GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">Teapot</span> pot<span style="color: #008000;">;</span>
		GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">GLWidget</span> glWidget<span style="color: #008000;">;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">public</span> MyWindow <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
		<span style="color: #008000;">&#123;</span>
			win <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Gtk<span style="color: #008000;">.</span><span style="color: #0000FF;">Window</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;My Gtk Window&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			win<span style="color: #008000;">.</span><span style="color: #0000FF;">DeleteEvent</span> <span style="color: #008000;">+=</span> CloseWindow<span style="color: #008000;">;</span>
			win<span style="color: #008000;">.</span><span style="color: #0000FF;">Resize</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">400</span>, <span style="color: #FF0000;">400</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			glWidget <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">GLWidget</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			glWidget<span style="color: #008000;">.</span><span style="color: #0000FF;">GLSetup</span> <span style="color: #008000;">+=</span> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">GLWidget</span><span style="color: #008000;">.</span><span style="color: #0000FF;">EnableLighting</span><span style="color: #008000;">;</span>
			pot <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">Teapot</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			pot<span style="color: #008000;">.</span><span style="color: #0000FF;">Translate</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">-</span><span style="color: #FF0000;">0.0</span>, <span style="color: #FF0000;">0.0</span>, <span style="color: #FF0000;">3</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			glWidget<span style="color: #008000;">.</span><span style="color: #0000FF;">AddGLObject</span><span style="color: #008000;">&#40;</span>pot<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			win<span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span>glWidget<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>			
&#160;
			GLib<span style="color: #008000;">.</span><span style="color: #0000FF;">Timeout</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GLib<span style="color: #008000;">.</span><span style="color: #0000FF;">TimeoutHandler</span><span style="color: #008000;">&#40;</span>Animate<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			win<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			glWidget<span style="color: #008000;">.</span><span style="color: #0000FF;">Show</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>			
&#160;
&#160;
		<span style="color: #008000;">&#125;</span>	
&#160;
		<span style="color: #6666cc; font-weight: bold;">bool</span> Animate<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#123;</span>
			GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">EulerRotation</span> rot <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">EulerRotation</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0.02</span>, <span style="color: #FF0000;">0.0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			GtkGL<span style="color: #008000;">.</span><span style="color: #0000FF;">Quaternion</span> q <span style="color: #008000;">=</span> rot<span style="color: #008000;">.</span><span style="color: #0000FF;">ToQuaternion</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			pot<span style="color: #008000;">.</span><span style="color: #0000FF;">Rotate</span><span style="color: #008000;">&#40;</span>q<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			<span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #6666cc; font-weight: bold;">void</span> CloseWindow<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, DeleteEventArgs args<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#123;</span>
			Application<span style="color: #008000;">.</span><span style="color: #0000FF;">Quit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			args<span style="color: #008000;">.</span><span style="color: #0000FF;">RetVal</span> <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span> <span style="color: #008080; font-style: italic;">//this is necessary to stop an error on close.</span>
		<span style="color: #008000;">&#125;</span>
	<span style="color: #008000;">&#125;</span></pre>
<p>Now your MonoDevelop work flow should be ready for tinkering.
</p>
