---
layout: obsolete
title: "FastCGI Cherokee"
permalink: /old_site/FastCGI_Cherokee/
redirect_from:
  - /FastCGI_Cherokee/
---

<h1>FastCGI Cherokee</h1>

<p>by Brian Nickel &lt;<a href="http://kerrick.wordpress.com" class="external free" rel="nofollow">http://kerrick.wordpress.com</a>&gt;
</p><p>Information on how to configure the <a href="{{site.github.url}}/old_site/FastCGI" title="FastCGI">FastCGI</a> support for the Cherokee server.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Table of contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Configuration_Tested_On..."><span class="tocnumber">1.1</span> <span class="toctext">Configuration Tested On...</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#General_Warnings"><span class="tocnumber">2</span> <span class="toctext">General Warnings</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Using_Paths_.5BRecommended.5D"><span class="tocnumber">3</span> <span class="toctext">Using Paths [Recommended]</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Warnings"><span class="tocnumber">3.1</span> <span class="toctext">Warnings</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Step_1:_Setting_Up_the_Handler"><span class="tocnumber">3.2</span> <span class="toctext">Step 1: Setting Up the Handler</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Using_Extensions"><span class="tocnumber">4</span> <span class="toctext">Using Extensions</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Warnings_2"><span class="tocnumber">4.1</span> <span class="toctext">Warnings</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Step_1:_Setting_Up_the_Handler_2"><span class="tocnumber">4.2</span> <span class="toctext">Step 1: Setting Up the Handler</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Step_2:_Adding_Index_Pages"><span class="tocnumber">4.3</span> <span class="toctext">Step 2: Adding Index Pages</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Bada_Bing.21"><span class="tocnumber">5</span> <span class="toctext">Bada Bing!</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Introduction">Introduction</span></h2>
<p><a href="http://www.cherokee-project.com/" class="external text" rel="nofollow">Cherokee HTTP Server</a> is a very fast, flexible and easy to configure Web Server. Adding ASP.NET support through <tt>fastcgi-mono-server</tt> is very simple and requires modification of only one file. 
As late as Cherokee 0.5.6, the FastCGI extension fails to send and empty Record when the request contains no input. <tt>fastcgi-mono-server</tt> does not currently work around this. <b>This documentation is for the <a href="http://www.cherokee-project.com/download/0.6/0.6.0/" class="external text" rel="nofollow">0.6.0 series</a>.</b> 
</p>
<h3> <span class="mw-headline" id="Configuration_Tested_On...">Configuration Tested On...</span></h3>
<ol><li><a href="http://en.opensuse.org/OpenSUSE_News/10.2-Release" class="external text" rel="nofollow">OpenSuSE10.2</a> (Cherokee 0.6.0b700 from its YaST repository) 
</li><li><i>If you have tested an additional configuration,please email me at <a href="mailto:brian.nickel@gmail.com" class="external text" rel="nofollow">brian.nickel@gmail.com</a>.</i>  
</li></ol>
<h2> <span class="mw-headline" id="General_Warnings">General Warnings</span></h2>
<p>Before doing anthing else, you should read "<a href="{{site.github.url}}/old_site/FastCGI#ImportantInformation" title="FastCGI">FastCGI#ImportantInformation</a>" on the main page. 
</p>
<h2> <span class="mw-headline" id="Using_Paths_.5BRecommended.5D">Using Paths [Recommended]</span></h2>
<h3> <span class="mw-headline" id="Warnings">Warnings</span></h3>
<p><b>Not all the kinks of using the FastCGI Mono Server as a directory handler have been worked out.</b> Notably some test pages still aren't working and there appears to be some problems with running several concurrent requests.  
</p>
<h3> <span class="mw-headline" id="Step_1:_Setting_Up_the_Handler">Step 1: Setting Up the Handler</span></h3>
<p>All configuration is done in [file:///etc/cherokee/cherokee.conf /etc/cherokee/cherokee.conf] or [file:///usr/etc/cherokee/cherokee.conf /usr/etc/cherokee/cherokee.conf]. The following block can be inserted anywhere, but most appropriately near the bottom of the file. 
</p>
<pre>
vserver!default!directory!/!handler = fcgi
vserver!default!directory!/!handler!balancer = round_robin
vserver!default!directory!/!handler!balancer!type = interpreter
vserver!default!directory!/!handler!balancer!local1!host = localhost:8002
vserver!default!directory!/!handler!balancer!local1!interpreter = /usr/bin/fastcgi-mono-server /socket=tcp:8002
vserver!default!directory!/!priority = 99999
</pre>
<p>Yep, Cherokee's new format does take a few more bytes than it used to, but what can you do? This configuration tells Cherokee to look for the server at localhost:8002 and if it doesn't find it, spawn a new server using the command line: 
</p>
<pre>/usr/bin/fastcgi-mono-server /socket=tcp:8002</pre>
<p>A few changes can be made to this. First, you can switch to the <b>.NET 2.0</b> runtime by calling "<tt>fastcgi-mono-server2</tt>" instead in the "<tt>local1!interpreter</tt>" line. Second, you can change the port. You may have another server using 8002, so you can change the port to whatever number you want (less than 65536). Just make sure, you update the port on both the "<tt>local1!host</tt>" line and "<tt>local1!interpreter</tt>" line otherwise you'll keep trying to spawn a host you can't use. 
</p><p>The third and biggest change is to not spawn a host at all, but instead use an existing host. To do this, you must manually start the Mono server as shown above, remove the "<tt>local1!interpreter</tt>" line, and update the "<tt>local1!host</tt>" line to the resolvable hostname or IP address and port of the server. For example, "<tt>192.168.0.123:8002</tt>" or "<tt>monohost.localnetwork:8002</tt>". 
</p>
<h2> <span class="mw-headline" id="Using_Extensions">Using Extensions</span></h2>
<h3> <span class="mw-headline" id="Warnings_2">Warnings</span></h3>
<p><b>Using Extensions in place place of paths is NOT recommended.</b> Please consult "[../index.html#info1 Paths vs. Extensions]" on the main page for an in depth explanation. If you decide to use this configuration, please bear in mind that it is less secure suffers additional disadvantages when compared to using paths. 
</p>
<h3> <span class="mw-headline" id="Step_1:_Setting_Up_the_Handler_2">Step 1: Setting Up the Handler</span></h3>
<p>All configuration is done in [file:///etc/cherokee/cherokee.conf /etc/cherokee/cherokee.conf] or [file:///usr/etc/cherokee/cherokee.conf /usr/etc/cherokee/cherokee.conf]. The following block can be inserted anywhere, but most appropriately near the bottom of the file. 
</p><p><br />
</p>
		<pre>vserver!default!extensions!aspx,asmx,ashx,asax,ascx,soap,rem,axd,cs,config,dll!handler = fcgi
vserver!default!extensions!aspx,asmx,ashx,asax,ascx,soap,rem,axd,cs,config,dll!handler!balancer = round_robin
vserver!default!extensions!aspx,asmx,ashx,asax,ascx,soap,rem,axd,cs,config,dll!handler!balancer!type = interpreter
vserver!default!extensions!aspx,asmx,ashx,asax,ascx,soap,rem,axd,cs,config,dll!handler!balancer!local1!host = localhost:8002
vserver!default!extensions!aspx,asmx,ashx,asax,ascx,soap,rem,axd,cs,config,dll!handler!balancer!local1!interpreter = /usr/bin/fastcgi-mono-server /socket=tcp:8002
vserver!default!extensions!aspx,asmx,ashx,asax,ascx,soap,rem,axd,cs,config,dll!priority = 99999</pre>
<p>Yep, Cherokee's new format does take a few more bytes than it used to, but what can you do? This configuration tells Cherokee to look for the server at localhost:8002 and if it doesn't find it, spawn a new server using the command line: 
</p>
		<pre>/usr/bin/fastcgi-mono-server /socket=tcp:8002</pre>
<p>A few changes can be made to this. First, you can switch to the <b>.NET 2.0</b> runtime by calling "<tt>fastcgi-mono-server2</tt>" instead in the "<tt>local1!interpreter</tt>" line. Second, you can change the port. You may have another server using 8002, so you can change the port to whatever number you want (less than 65536). Just make sure, you update the port on both the "<tt>local1!host</tt>" line and "<tt>local1!interpreter</tt>" line otherwise you'll keep trying to spawn a host you can't use. 
</p><p>The third and biggest change is to not spawn a host at all, but instead use an existing host. To do this, you must manually start the Mono server as shown above, remove the "<tt>local1!interpreter</tt>" line, and update the "<tt>local1!host</tt>" line to the resolvable hostname or IP address and port of the server. For example, "<tt>192.168.0.123:8002</tt>" or "<tt>monohost.localnetwork:8002</tt>". 
</p>
<h3> <span class="mw-headline" id="Step_2:_Adding_Index_Pages">Step 2: Adding Index Pages</span></h3>
<p>Once you have finished Step 1, you should have a working ASP.NET server with one exception, if you look at a folder like "/", you'll get a 503 error or directory listing instead of "default.aspx". To fix this, you need modify <tt>vserver!default!directory_index</tt>. You'll probably see the following block: 
</p><p><br />
</p>
		<pre>vserver!default!directory_index = index.php,index.html</pre>
<p>You will need to modify it so it includes "index.aspx" and "default.aspx". For example, 
</p>
		<pre>vserver!default!directory_index = index.php,index.html&lt;b&gt;,index.aspx,default.aspx&lt;/b&gt;</pre>
<p><br />
</p>
<h2> <span class="mw-headline" id="Bada_Bing.21">Bada Bing!</span></h2>
<p>You should now have ASP.NET working with Cherokee. Enjoy!
</p>
