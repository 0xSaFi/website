---
layout: obsolete
title: "Web Services (Visual Basic)"
permalink: /old_site/Web_Services_(Visual_Basic)/
redirect_from:
  - /Web_Services_(Visual_Basic)/
---

<h1>Web Services (Visual Basic)</h1>

<p>Web services are basically a modern form of a remote procedure call (RPC) system. They allow applications on one machine to execute operations on another machine. Systems integrators use web services to make widely differing systems talk to one another. 
</p>
<ul><li> <a href="{{site.baseurl}}/Webservices_and_GtkSharp" title="Webservices and GtkSharp">Using WebServices with Gtk# applications</a>
</li><li> <a href="{{site.baseurl}}/Web_Services" title="Web Services">See this article with C# code</a>
</li></ul>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#An_Example"><span class="tocnumber">1</span> <span class="toctext">An Example</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Technical_Background:_SOAP"><span class="tocnumber">2</span> <span class="toctext">Technical Background: SOAP</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Internal_Communication"><span class="tocnumber">3</span> <span class="toctext">Internal Communication</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Consuming_Web_Services"><span class="tocnumber">4</span> <span class="toctext">Consuming Web Services</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#First_Steps:_Creating_the_Local_Stub"><span class="tocnumber">4.1</span> <span class="toctext">First Steps: Creating the Local Stub</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Google_License_key"><span class="tocnumber">4.2</span> <span class="toctext">Google License key</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Application_1:_The_Google_Spell_Checker_on_a_Webpage"><span class="tocnumber">4.3</span> <span class="toctext">Application 1: The Google Spell Checker on a Webpage</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Application_2:_A_Console_Application"><span class="tocnumber">4.4</span> <span class="toctext">Application 2: A Console Application</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Documentation"><span class="tocnumber">4.5</span> <span class="toctext">Documentation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#Contributors"><span class="tocnumber">5</span> <span class="toctext">Contributors</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="An_Example"> An Example </span></h1>
<p>To understand, let's take a look at a hypothetical example. Imagine a class like this: 
</p>
<pre>
Dim ournews As NewsTicker= new NewsTicker()
Dim headline As String = ournews.GetHeadline(1)
Console.WriteLine(headline)
</pre>
<p>This could be a local function operating on your own machine, or it could be a web service. If it were a web service, the actual code that returns the headline might be running on some other machine somewhere on the internet. You don't have to know what it's doing; there might be a database on the other end of the service, a screen-scraper, or a carrier-pigeon-message translation service. The code on the remote webserver might be PHP, Java, Python, or COBOL. That's the point of web services. 
</p>
<h1> <span class="mw-headline" id="Technical_Background:_SOAP"> Technical Background: SOAP </span></h1>
<p>Under the hood, Mono uses a protocol called SOAP to make web services work just like other methods. In the example above, when GetHeadline() is called, Mono generates an XML file that describes an information request. It could look like this: 
</p>
<pre>
&lt;webservice url=&quot;http://somenewsservice.com/webservice&quot;&gt;
        &lt;function name=&quot;GetHeadLine&quot; &gt;
                &lt;int name=&quot;number&quot; value=&quot;1&quot; /&gt;
        &lt;/function&gt;
&lt;/webservice&gt;
</pre>
<p>In the real world it looks very different and much more complicated, but that's the basic logic. The remote webserver reads the request, interprets it, and runs some business logic. It sends back an XML response packet something like this: 
</p>
<pre>
&lt;webservice url=&quot;http://somenewsservice.com/webservice&quot;&gt;
        &lt;function name=&quot;GetHeadLine&quot; &gt;
                &lt;int name=&quot;return&quot; value=&quot;This is some new from CNN&quot; /&gt;
        &lt;/function&gt;
&lt;/webservice&gt;
</pre>
<p>Mono knows how to take XML response packets and turn them into data your application can use. 
</p>
<h1> <span class="mw-headline" id="Internal_Communication"> Internal Communication </span></h1>
<p>In order to use a web service, Mono requires a descriptor file written in WSDL (Web Services Description Language). WSDL is an XML description of the API for a given web service. Mono's tool <tt>wsdl </tt>knows how to translate a WSDL file into a C# library that can run that web service. The local library file is a wrapper around the web service, but it gets installed into the GAC just like any other library. 
</p>
<h1> <span class="mw-headline" id="Consuming_Web_Services"> Consuming Web Services </span></h1>
<p>As an example of what can be done with web services, let's use a part of Google's publicly accessible web services, the Google spell checker. When you enter "spelll checker" in Google, it will ask you if you meant "spell checker". With the Google web service, you can use that function directly from C#. 
</p>
<h2> <span class="mw-headline" id="First_Steps:_Creating_the_Local_Stub"> First Steps: Creating the Local Stub </span></h2>
<p>To create the local library that will invoke Google's web service, we'll use their WSDL file. You can get the Google WSDL files at <a href="http://api.google.com/GoogleSearch.wsdl" class="external free" rel="nofollow">http://api.google.com/GoogleSearch.wsdl</a>. To generate the C# stub source type: 
</p>
<pre class="bash" style="font-family:monospace;">wsdl http:<span style="color: #000000; font-weight: bold;">//</span>api.google.com<span style="color: #000000; font-weight: bold;">/</span>GoogleSearch.wsdl -language:vb</pre>
<p>This will result in <tt>GoogleSearchService.vb </tt>. Compile with: 
</p>
<pre class="bash" style="font-family:monospace;">vbnc <span style="color: #000000; font-weight: bold;">/</span>target:library GoogleSearchService.vb -r:System.Web.Services.dll,System.Xml.dll</pre>
<p>The above command line instructs the compiler to generate a library, and to reference (-r:) the System.Web.Services library.
</p><p>Now you have the final stub assembly: <tt>GoogleSearchService.dll </tt>
</p>
<h2> <span class="mw-headline" id="Google_License_key"> Google License key </span></h2>
<p>Google does lock the web service with a special key. You can obtain a key at <a href="https://www.google.com/accounts/NewAccount" class="external free" rel="nofollow">https://www.google.com/accounts/NewAccount</a>. This key allows ~50 actions per day. You must replace my sample key with yours. 
</p>
<h2> <span class="mw-headline" id="Application_1:_The_Google_Spell_Checker_on_a_Webpage"> Application 1: The Google Spell Checker on a Webpage </span></h2>
<p>We will start by using the spell checker on a simple web page. First you will have to drop the stub GoogleSearchService.dll in your ASP.NET bin directory. The example is very simple to understand. 
</p>
<pre>
&lt;%@ Page Language=&quot;VB&quot;&#160;%&gt;
&lt;script runat=&quot;Server&quot;&gt;

Sub Page_Load (ByVal sender As Object, ByVal e As EventArgs)
    
	// Put your license key here
	Const licensekey As String = &quot;FCszK/FQFHJWQE1n5OkeGmZAWzCFY5+7&quot;
	
	// Create a Google Search object
	Dim Service1 As GoogleSearchService = new GoogleSearchService()
	
	// Ask for spelling suggestion
	// The first argument is your key
	// The second one, the text the user should enter.
	
	Dim suggestion As String = Service1.doSpellingSuggestion(licensekey, TextBox1.Text)
	
	// Display the suggestion, if any
	If suggestion Is Nothing Then
		Label1.Text = &quot;[No suggestion]&quot;
	Else	
		Label1.Text = suggestion
	End If
End Sub

&lt;/script&gt;

&lt;html&gt;
&lt;body&gt;
&lt;h2&gt;Hello WebService!&lt;/h2&gt;
&lt;form runat=&quot;server&quot;&gt;
&lt;p&gt;&lt;asp:TextBox id=&quot;TextBox1&quot; runat=&quot;server&quot;&gt;&lt;/asp:TextBox&gt;&lt;/p&gt;
&lt;p&gt;&lt;asp:Label id=&quot;Label1&quot; runat=&quot;server&quot;&gt;&lt;/asp:Label&gt;&lt;/p&gt;
&lt;p&gt;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot; runat=&quot;server&quot;&gt;&lt;/input&gt;&lt;/p&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<p>This will look like this: 
</p><p>[Image:google.png]  
</p><p>The code where the web service is accessed is marked red. To test the service enter "spelll checker" for example, and watch it correct your spelling. 
</p>
<h2> <span class="mw-headline" id="Application_2:_A_Console_Application"> Application 2: A Console Application </span></h2>
<p>You can also consume the WebService with a Console or Gtk# application. You'll need to reference GoogleSearchService.dll when you compile. 
</p>
<pre class="bash" style="font-family:monospace;">vbnc <span style="color: #000000; font-weight: bold;">/</span>r:GoogleSearchService.dll spellchecker.vb</pre>
<p>The Code: 
</p>
<pre>
Imports System

Module UseWSInMono
    Public Sub Main(ByVal args() As String)

        Dim licensekey As String = &quot;FCszK/FQFHJWQE1n5OkeGmZAWzCFY5+7&quot;
        Dim Service1 As GoogleSearchService = New GoogleSearchService()
        Dim suggestion As String = Service1.doSpellingSuggestion(licensekey, args(0))

        Console.WriteLine(suggestion)
    End Sub
End Module
</pre>
<h2> <span class="mw-headline" id="Documentation"> Documentation </span></h2>
<p>If you want to do more, you will require documentation of the web service. For Google's API, one place to look is in the comments of the WSDL file. Individual web service providers are responsible for providing good documentation, though you may be able to use the C# introspection tools or read the source generated by <tt>wsdl </tt>for a slightly better idea of how any given web service works. 
</p>
<h1> <span class="mw-headline" id="Contributors"> Contributors </span></h1>
<p>Johannes Roith, Shane Landrum, Rolf Bjarne Kvinge, Lennie de Villiers
</p>
