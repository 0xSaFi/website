---
layout: obsolete
title: "Cecil"
permalink: /old_site/Cecil/
---

<h1>Cecil</h1>

<p>Cecil is a library written by <a href="http://evain.net/blog/" class="external text" rel="nofollow">Jb Evain</a> to generate and inspect programs and libraries in the ECMA CIL format. It has full support for generics, and support some debugging symbol format.
</p><p>In simple English, with Cecil, you can load existing managed assemblies, browse all the contained types, modify them on the fly and save back to the disk the modified assembly.
</p><p>Today it is used by the Mono <a href="{{site.baseurl}}/Debugger" title="Debugger">Debugger</a>, the bug-finding and compliance checking tool <a href="{{site.baseurl}}/Gendarme" title="Gendarme">Gendarme</a>, <a href="{{site.baseurl}}/MoMA" title="MoMA">MoMA</a>, <a href="{{site.baseurl}}/DB4O" title="DB4O">DB4O</a>, as well as <a href="http://groups.google.com/group/mono-cecil/web/projects-using-cecil" class="external text" rel="nofollow">many other tools</a>.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Mailing_List"><span class="tocnumber">1</span> <span class="toctext">Mailing List</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Versions"><span class="tocnumber">2</span> <span class="toctext">Versions</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Using_Cecil"><span class="tocnumber">3</span> <span class="toctext">Using Cecil</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Download"><span class="tocnumber">4</span> <span class="toctext">Download</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Documentation"><span class="tocnumber">5</span> <span class="toctext">Documentation</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Release_notes"><span class="tocnumber">6</span> <span class="toctext">Release notes</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Differences_with_other_alternatives"><span class="tocnumber">7</span> <span class="toctext">Differences with other alternatives</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Reflection.2FReflection.Emit"><span class="tocnumber">7.1</span> <span class="toctext">Reflection/Reflection.Emit</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#Projects"><span class="tocnumber">8</span> <span class="toctext">Projects</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Mailing_List"> Mailing List </span></h1>
<p>There is a Google Group to discuss everything Cecil related: <a href="http://groups.google.com/group/mono-cecil" class="external text" rel="nofollow">mono-cecil</a>
</p>
<h1> <span class="mw-headline" id="Versions"> Versions </span></h1>
<p>Recently, Cecil undergone a large refactoring, to be able to fix some issues the previous version had. In its previous form, the code was compilable on a .net 1.0 profile, and you need to use Cecil from the 0.6 family if you still want to use it.
</p><p>For every other usage, you're urged to switch to the new version 0.9. Its development has been moved to the <a href="http://github.com/jbevain/cecil" class="external text" rel="nofollow">Cecil github page</a> until all the code in Mono is updated to this version.
</p>
<h1> <span class="mw-headline" id="Using_Cecil"> Using Cecil </span></h1>
<p>Since Cecil's API has not yet been frozen as we want to continue improving it from the lessons learned from various consumers of the API, using Cecil requires your project to take some extra steps compared to when you use a published API.
</p><p>The 0.9 family of Cecil, is very close to API stability.
</p><p>The pattern used for using libraries whose API is not frozen is described in  the [<a href="http://www.mono-project.com/Guidelines:Application_Deployment%7CApplication" class="external text" rel="nofollow">Deployment</a>] guidelines.
</p><p>To summarize it, it is necessary for you to copy and bundle a version of Cecil with your project before using it.   To do this, you use the following pattern:
</p>
<pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">cp</span> <span style="color: #000000; font-weight: bold;">`</span>pkg-config <span style="color: #660033;">--variable</span>=Libraries cecil<span style="color: #000000; font-weight: bold;">`</span> .
$ gmcs program.cs -r:Mono.Cecil.dll</pre>
<p>In a Makefile you would achieve that by doing:
</p>
<pre class="bash" style="font-family:monospace;">Mono.Cecil.dll: 
        <span style="color: #c20cb9; font-weight: bold;">cp</span> <span style="color: #000000; font-weight: bold;">`</span>pkg-config <span style="color: #660033;">--variable</span>=Libraries cecil<span style="color: #000000; font-weight: bold;">`</span> .</pre>
<p>And adding Mono.Cecil.dll as one of your dependencies.
</p>
<h1> <span class="mw-headline" id="Download"> Download </span></h1>
<p>If you want the up to date version of Mono.Cecil, you need to get it from its <a href="http://github.com/jbevain/cecil" class="external text" rel="nofollow">github page</a>.
</p><p>If you need a recent build of the 0.6 branch, the recommended way of quickly getting a binary of Mono.Cecil.dll, is to grab it from the last MonoCharge tarball which are part of our <a href="http://mono.ximian.com/daily/" class="external text" rel="nofollow">daily builds</a>.
</p><p>If needed, you can download Cecil's last revision from the <a href="{{site.baseurl}}/SVN" title="SVN" class="mw-redirect">Subversion repository</a> in mcs/class/Mono.Cecil.
</p>
<h1> <span class="mw-headline" id="Documentation"> Documentation </span></h1>
<p>You can visit, and even contribute, to Cecil's <a href="http://wiki.github.com/jbevain/cecil/" class="external text" rel="nofollow">wiki</a>.
</p>
<h1> <span class="mw-headline" id="Release_notes"> Release notes </span></h1>
<p>Here are the release notes for every version of Cecil:
</p>
<pre>* <a href="http://evain.net/blog/articles/2010/04/12/mono-cecil-0-9-cecil-light" class="external text" rel="nofollow">Mono.Cecil 0.9.1</a>
* <a href="http://evain.net/blog/articles/2010/04/12/mono-cecil-0-9-cecil-light" class="external text" rel="nofollow">Mono.Cecil 0.9</a>
* <a href="http://evain.net/blog/articles/2007/10/05/mono-cecil-0-6" class="external text" rel="nofollow">Mono.Cecil 0.6</a>
* <a href="http://evain.net/blog/articles/2007/03/27/mono-cecil-0-5" class="external text" rel="nofollow">Mono.Cecil 0.5</a>
* <a href="http://evain.net/blog/articles/2006/08/24/mono-cecil-0-4-3-released" class="external text" rel="nofollow">Mono.Cecil 0.4.3</a>
* <a href="http://evain.net/blog/articles/2006/04/04/mono-cecil-0-4-1" class="external text" rel="nofollow">Mono.Cecil 0.4.1</a>
* <a href="http://evain.net/blog/articles/2006/02/07/mono-cecil-0-3" class="external text" rel="nofollow">Mono.Cecil 0.3</a>
* <a href="http://evain.net/blog/articles/2005/12/24/mono-cecil-0-2" class="external text" rel="nofollow">Mono.Cecil 0.2</a>
* <a href="http://evain.net/blog/articles/2005/10/31/mono-cecil-0-1-released" class="external text" rel="nofollow">Mono.Cecil 0.1</a>
</pre>
<h1> <span class="mw-headline" id="Differences_with_other_alternatives"> Differences with other alternatives</span></h1>
<h2> <span class="mw-headline" id="Reflection.2FReflection.Emit"> Reflection/Reflection.Emit </span></h2>
<p>Reflection and Reflection.Emit only expose a subset of all the features in a CLI image.  Since we want to remain compatible with the Microsoft implementation, we can not add or change the behavior of this library to be more complete.
</p><p>Two big differences are that:
</p>
<ul><li> Cecil has support for extracting the CIL bytecodes.
</li><li> Cecil does not need to load the assembly or have compatible assemblies to introspect the images.
</li></ul>
<h1> <span class="mw-headline" id="Projects"> Projects </span></h1>
<p>The following are projects that we want to implement using Cecil:
</p><p><br />
</p>
<table border="1" cellpadding="2" cellspacing="0" align="center" style="margin: 0 0 1em 1em; text-align:left; border-collapse:collapse; border:1px gray solid; font-size:95%; background:#f9f9f9">

<tr>
<th align="center">Area</th>
<th align="center">Description</th>
<th align="center">Difficulty</th>
<th align="center">Time estimate</th>
<th align="center">Additional information
</th></tr>
<tr>
<td>Disassembler/assembler
</td>
<td>
<p>although today we have both tools, we are not very happy with our disassembler as it uses the Mono internal calls which are not really designed to cope with incomplete assemblies (we have an all-or-nothing codebase in this scenario).
</p>
</td>
<td>
<p>Medium
</p>
</td>
<td>3-4 Months
</td>
<td> jbevain is working on ildasm, still need to update the assembler.
</td></tr>
<tr>
<td>Code optimization using Cecil
</td>
<td>
<p>this is a longer-term project, but today compilers that target the CIL are known to generate fairly straightforward CIL code leaving most of the work to the JIT engine.  An optimizer that could perform some tasks before the JIT compiler hits the code would be useful.
</p><p>Although our code generator is fairly good, and getting better the most effective optimizations are never turned on for JIT-use as they are very time consuming.
</p><p>There are a couple of temporary measures that can be taken to address this issue (ahead-of-time compilation and dynamic recompilation).  Both have small drawbacks.
</p><p>A code optimizer would convert a CIL stream into a different CIL stream that is compatible but has applied some
optimizations before the JIT sees them.
</p><p>These optimizations could be a lot more complex than what the JIT compiler can do today doing things like loop unrolling or
processing a file to automatically multithread some pieces of
the program.  
</p><p>It is rumored that the MS C++ compiler produces better code than the C# compiler as it does do some IL-level loop unrolling for example.
</p>
</td>
<td>
<p>Medium-Hard
</p>
</td>
<td> 3-4 Months
</td>
<td> Must validate claims, could reuse the semantic information from a bug-finding tool.
</td></tr></table>

