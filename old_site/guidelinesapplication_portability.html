---
layout: obsolete
title: "Guidelines:Application Portability"
permalink: /old_site/Guidelines:Application_Portability/
redirect_from:
  - /Guidelines:Application_Portability/
  - /Guide:Writing_Cross_Platform_applications/
---

<h1>Guidelines:Application Portability</h1>

<p><br />
This document describes some practices that are useful when building software that is portable across Windows and Unix systems using .NET and Mono. 
</p><p>In addition to this page, these are some resources that are useful when porting software to run on Mono:
</p>
<ul><li> <a href="{{site.github.url}}/old_site/ASP.NET" title="ASP.NET">Mono's ASP.NET</a>
</li><li> <a href="{{site.github.url}}/old_site/WinForms" title="WinForms">Mono's Windows.Forms implementation</a>
</li></ul>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Table of contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Porting_Strategy"><span class="tocnumber">1</span> <span class="toctext">Porting Strategy</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Developing_on_Windows.2C_running_on_Unix"><span class="tocnumber">1.1</span> <span class="toctext">Developing on Windows, running on Unix</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Developing_Natively_on_Linux"><span class="tocnumber">1.2</span> <span class="toctext">Developing Natively on Linux</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#General_Guidelines"><span class="tocnumber">2</span> <span class="toctext">General Guidelines</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Case_sensitivity"><span class="tocnumber">2.1</span> <span class="toctext">Case sensitivity</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Path_Separators"><span class="tocnumber">2.2</span> <span class="toctext">Path Separators</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Absolute_path_names"><span class="tocnumber">2.3</span> <span class="toctext">Absolute path names</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Platform_Invocation_.28P.2FInvoke.29"><span class="tocnumber">2.4</span> <span class="toctext">Platform Invocation (P/Invoke)</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Registry_Usage"><span class="tocnumber">2.5</span> <span class="toctext">Registry Usage</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Endianess"><span class="tocnumber">2.6</span> <span class="toctext">Endianess</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#ASP.NET_Guidelines"><span class="tocnumber">3</span> <span class="toctext">ASP.NET Guidelines</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Windows.Forms_Guidelines"><span class="tocnumber">4</span> <span class="toctext">Windows.Forms Guidelines</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Database_Migration"><span class="tocnumber">5</span> <span class="toctext">Database Migration</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Missing_Functionality"><span class="tocnumber">6</span> <span class="toctext">Missing Functionality</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#No_Enterprise.Services"><span class="tocnumber">6.1</span> <span class="toctext">No Enterprise.Services</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#No_cross-process_transactions"><span class="tocnumber">6.2</span> <span class="toctext">No cross-process transactions</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#No_COM"><span class="tocnumber">6.3</span> <span class="toctext">No COM</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#User_Interface"><span class="tocnumber">7</span> <span class="toctext">User Interface</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Using_Windows.Forms_as_a_cross-platform_API"><span class="tocnumber">7.1</span> <span class="toctext">Using Windows.Forms as a cross-platform API</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Using_a_native_UI_for_each_platform"><span class="tocnumber">7.2</span> <span class="toctext">Using a native UI for each platform</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Porting_Tools"><span class="tocnumber">8</span> <span class="toctext">Porting Tools</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#MonoDevelop"><span class="tocnumber">8.1</span> <span class="toctext">MonoDevelop</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#installvsts"><span class="tocnumber">8.2</span> <span class="toctext">installvsts</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Prj2make"><span class="tocnumber">8.3</span> <span class="toctext">Prj2make</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Porting_Strategy"> Porting Strategy </span></h1>
<p>Today Mono contains the core development libraries, the development and deployment tools.  Most of these are command-line tools and compiler, there is no complete replacement for Visual Studio to do Windows.Forms and ASP.NET applications natively on Linux.
</p><p>There are a number of strategies that you can adopt depending on how comfortable you are with using Linux.
</p>
<h2> <span class="mw-headline" id="Developing_on_Windows.2C_running_on_Unix"> Developing on Windows, running on Unix </span></h2>
<p>You can continue to use Visual Studio to develop your applications on Windows, the binaries produced by Visual Studio are binary compatible with Mono, so you only need to get these files to your Linux/Unix server.
</p><p>You can do this by either manually copying the files (a directory, using XCopy deployment is probably the easiest), but ideally you would want to have a network share between Unix and Windows:
</p>
<ul><li> You could mount from Linux, a Windows share.
</li><li> You could mount from Windows, a Linux share.
</li></ul>
<p><b>Important</b> Visual Studio can produce "incremental" executables, these are executables that do not have some of their tables compressed, and they are used by Visual Studio during development.
</p><p>These assemblies do not work with Mono, as Mono does not support them, you must turn off "incremental" builds.
</p><p>The incremental option can be set from the Project's Configuration/Advanced properties.
</p>
<h2> <span class="mw-headline" id="Developing_Natively_on_Linux"> Developing Natively on Linux </span></h2>
<p>There are a couple of IDEs that can be used on Linux, with various degrees of functionality:
</p>
<ul><li> <a href="http://www.omnicore.com/xdevelop.htm" class="external text" rel="nofollow">X-Develop</a> from Omnicore is a commercial product that provides auto-complete, a cross-platform GUI designer and works on Windows, Linux and OS/X.
</li><li> <a href="http:///www.monodevelop.com" class="external text" rel="nofollow">MonoDevelop</a> is an IDE produced by the Mono community that has support for developing graphical applications with Gtk# but currently lacks support for Windows.Forms or ASP.NET
</li></ul>
<p>If you feel comfortable using command line tools, and any of the other Unix editors, that would work as well.
</p>
<h1> <span class="mw-headline" id="General_Guidelines"> General Guidelines </span></h1>
<p>Starting with Mono 1.1.18, a new <a href="{{site.github.url}}/old_site/IOMap" title="IOMap">IO Remapping</a> functionality is provided that copes with case sensitivity in the file system and with directory separators in filenames.
</p><p>Using the <a href="{{site.github.url}}/old_site/IOMap" title="IOMap">IOMap</a> functionality is a quick way of porting your applications, but the practices are still useful as they will help your application not depend on this remapping (as the remapping has a slight performance penalty).
</p><p>See the <a href="{{site.github.url}}/old_site/IOMap" title="IOMap">IOMap</a> page for more information on how to use it.
</p>
<h2> <span class="mw-headline" id="Case_sensitivity"> Case sensitivity </span></h2>
<p>The Linux and Unix file systems is case sensitive
</p><p>On Linux and Unix the files "readme" and "README" are two different files, that is, Linux has a case-sensitive file system.
</p><p>This is an important distinction for many applications because you might have created a "Login.aspx" page, but you reference the page as "login.aspx" or "LOGIN.ASPX" from your source code.   You must make sure that all references use the same file name casing.
</p><p>Alternatively, starting with Mono 1.1.18, you can set the MONO_IOMAP environment variable to "case" or "all" to eliminate these problems.  See <a href="{{site.github.url}}/old_site/IOMap" title="IOMap">IOMap</a> for details. 
</p>
<h2> <span class="mw-headline" id="Path_Separators"> Path Separators </span></h2>
<p>On Windows, the directory path separator is "\" while on Linux it is "/", it is possible to create files that contain a "\" in their names on Linux.
</p><p>For quickly porting applications, starting with Mono 1.1.18, you can set the MONO_IOMAP environment variable to "all" and it will take care of it.  See <a href="{{site.github.url}}/old_site/IOMap" title="IOMap">IOMap</a> for more details. 
</p><p>To write portable software, you must make sure that you use the [http:/monodoc/P:System.IO.Path.DirectorySeparatorChar System.IO.Path.DirectorySeparatorChar] character when you must concatenate paths, or even better, use the [http:/monodoc/M:System.IO.Path.Combine(string,string) System.IO.Path.Combine] method to combine pathnames.
</p><p>In addition, code that manually scans for path separators must be changed, for example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">int</span> index <span style="color: #008000;">=</span> exePath<span style="color: #008000;">.</span><span style="color: #0000FF;">LastIndexOf</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;<span style="color: #008080; font-weight: bold;">\\</span>&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
exeDir <span style="color: #008000;">=</span> exePath<span style="color: #008000;">.</span><span style="color: #0000FF;">Substring</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, index<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
exeFile <span style="color: #008000;">=</span> exePath<span style="color: #008000;">.</span><span style="color: #0000FF;">Substring</span><span style="color: #008000;">&#40;</span>index<span style="color: #008000;">+</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>Can be changed to the more portable:
</p>
<pre class="csharp" style="font-family:monospace;">exeDir <span style="color: #008000;">=</span> Path<span style="color: #008000;">.</span><span style="color: #0000FF;">GetDirectoryName</span> <span style="color: #008000;">&#40;</span>exePath<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
exeFile <span style="color: #008000;">=</span> Path<span style="color: #008000;">.</span><span style="color: #0000FF;">GetFileName</span> <span style="color: #008000;">&#40;</span>exePath<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>The PATH and other environment variables have directories separated by a semicolon ";" on Windows and a colon ":" on Linux.  You would use System.IO.Path.PathSeparator to separate these paths in environment variables.
</p>
<pre class="csharp" style="font-family:monospace;">Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Subdirectories found in the PATH environment variable:&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #6666cc; font-weight: bold;">string</span> path_env <span style="color: #008000;">=</span> Environment<span style="color: #008000;">.</span><span style="color: #0000FF;">GetEnvironmentVariable</span> <span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;PATH&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> path_dirs <span style="color: #008000;">=</span> path_env<span style="color: #008000;">.</span><span style="color: #0000FF;">Split</span> <span style="color: #008000;">&#40;</span>Path<span style="color: #008000;">.</span><span style="color: #0000FF;">PathSeparator</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">foreach</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> pathdir <span style="color: #0600FF; font-weight: bold;">in</span> path_dirs<span style="color: #008000;">&#41;</span>
	Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span>pathdir<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><br />
Some guidelines for this:
</p>
<ol><li> In general, I'd try to encapsulate _all_ operations that operate on file paths. Case sensitivity, the PathSeparator, the DirectorySeparatorChar, etc. are all at issue. More subtle things include what's an absolute path: /bin is absolute on Linux but needs a drive to make it absolute on Windows.
</li><li> For classes that manipulate paths, it's useful to use dependency injection for the platform rather than have them detect it. That way, you can test for each platform under a single platform. 
</li><li> For some tests, you can use paths like /a/b/c that work on both platforms, but watch out: methods like Path.GetAbsolutePath() will do different things on each platform.
</li></ol>
<h2> <span class="mw-headline" id="Absolute_path_names"> Absolute path names </span></h2>
<p>Do not use absolute path names in your application, as absolute path names will not work across Windows and Linux.
</p><p>If you need to locate some services, you should use the proper .NET APIs, for example, to discover your application configuration file can be done with:
</p>
<pre class="csharp" style="font-family:monospace;">AppDomain<span style="color: #008000;">.</span><span style="color: #0000FF;">CurrentDomain</span><span style="color: #008000;">.</span><span style="color: #0000FF;">SetupInformation</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ConfigurationFile</span></pre>
<h2> <span class="mw-headline" id="Platform_Invocation_.28P.2FInvoke.29"> Platform Invocation (P/Invoke) </span></h2>
<p>Most code containing P/Invoke calls into native Windows Libraries (as opposed to P/Invokes done to your own C libraries) will need to be adapted to the equivalent call in Linux, or the code will have to be refactored to use a different call.
</p>
<h2> <span class="mw-headline" id="Registry_Usage"> Registry Usage </span></h2>
<p>The registry classes are provided on Linux, but these are only useful as long as they reference configuration options that your application uses.   
</p><p>The registry classes will not provide any useful information about any operating system configuration or settings.
</p><p>Key and value names are converted to lower case by Mono. Normal access is case insensitive, but if your application retrieves the names from the registry and compares them to a fixed value, you must use a case-insensitive comparison. This  applies most frequently to test code, but can arise in other situations as well.
</p>
<h2> <span class="mw-headline" id="Endianess"> Endianess </span></h2>
<p>To make your code run in as many platforms as possible, you might want to keep your code Endian-independent.  This means that you should not assume the order of bytes.   
</p><p>See the <a href="http://en.wikipedia.org/wiki/Endianess" class="external text" rel="nofollow">endianess</a> entry in the Wikipedia for more details.
</p>
<h1> <span class="mw-headline" id="ASP.NET_Guidelines"> ASP.NET Guidelines </span></h1>
<p>You might want to familiarize yourself with some of the Frequently Asked Questions about ASP.NET on Mono, they are on this page: <a href="{{site.github.url}}/old_site/FAQ:_ASP.NET" title="FAQ: ASP.NET">FAQ: ASP.NET</a>
</p>
<h1> <span class="mw-headline" id="Windows.Forms_Guidelines"> Windows.Forms Guidelines </span></h1>
<p>You might want to familiarize yourself with some of the Frequently Asked Questions about running Windows.Forms applications on Mono.  The list is on this page: <a href="{{site.github.url}}/old_site/FAQ:_Winforms" title="FAQ: Winforms">FAQ: Winforms</a>.
</p>
<h1> <span class="mw-headline" id="Database_Migration"> Database Migration </span></h1>
<p>You can continue using your SQL Server database with Mono,
you do not have to migrate this.  But if you want to replace SQL server with another database, Mono provides an extensive set of database connetors for MySQL, PostgreSQL, Sybase, Oracle, IBM DB2, Firebird, ODBC, and also the embedded SQLite database. 
</p><p>Your existing code and connection strings will continue to work.  The only change necessary might be to change the hostname for the database.
</p>
<h1> <span class="mw-headline" id="Missing_Functionality"> Missing Functionality </span></h1>
<p>Mono lacks a number of features available on the .NET, here are some of the main missing features.
</p>
<h2> <span class="mw-headline" id="No_Enterprise.Services"> No Enterprise.Services </span></h2>
<p>If your application requires EnterpriseServices, your software will not likely run on Mono as we have not implemented it.
</p>
<h2> <span class="mw-headline" id="No_cross-process_transactions"> No cross-process transactions </span></h2>
<p>Mono currently supports only local-process transactions.
</p>
<h2> <span class="mw-headline" id="No_COM"> No COM </span></h2>
<p>COM does not exist on Unix as part of the operating system and Mono does not currently provide support for it.
</p><p>If your application requires COM, you need to wrap the various methods that you want to call using <a href="{{site.github.url}}/old_site/Interop_with_Native_Libraries" title="Interop with Native Libraries">P/Invoke</a>.
</p><p>There is currently a work in progress project to support it, see <a href="{{site.github.url}}/old_site/COM_Interop" title="COM Interop">COM Interop</a> for more details.
</p>
<h1> <span class="mw-headline" id="User_Interface"> User Interface </span></h1>
<p>In this section we should cover the differences between Windows.Forms and Gtk# and show the differences and how to structure an application to have multiple UIs depending on the platform.
</p>
<h2> <span class="mw-headline" id="Using_Windows.Forms_as_a_cross-platform_API"> Using Windows.Forms as a cross-platform API </span></h2>
<h2> <span class="mw-headline" id="Using_a_native_UI_for_each_platform"> Using a native UI for each platform </span></h2>
<p>One UI per OS, split core from UI, mention gtk#, cocoa#.
</p>
<h1> <span class="mw-headline" id="Porting_Tools"> Porting Tools </span></h1>
<h2> <span class="mw-headline" id="MonoDevelop"> MonoDevelop </span></h2>
<p>MonoDevelop version 0.14 is able to load Visual Studio 2005 solutions and can compile the projects or it can generate Unix makefiles to go with it.
</p><p>Just import the Visual Studio 2005 .sln file in MonoDevelop and compile as usual.   To generate makefiles, right click on the solution and select the "Generate Autotools Framework".
</p>
<h2> <span class="mw-headline" id="installvsts"> installvsts </span></h2>
<p>You can use the <b>installvst</b> program to install the various starter kits that are distributed from the <a href="http://asp.net" class="external free" rel="nofollow">http://asp.net</a> site.
</p>
<h2> <span class="mw-headline" id="Prj2make"> Prj2make </span></h2>
<p>If you choose to move your development to Linux, the prj2make tool will be useful.  
</p><p>Mono ships with a tool called prj2make that transforms Visual Studio 2003 solutions into a series of Makefiles.   The program is able to transform about 50% of the existing solutions into Makefiles, and can be useful in doing a first pass conversion from your project into a set of Unix-makefiles, but it is not rock-solid.
</p><p>One problem that prj2make has, is that it is unable to cope with filename differences, so it is possible that your project references a file "Core.cs" while the file on disk was called "core.cs", if the compilation fails, you will have to fix those names.
</p>
