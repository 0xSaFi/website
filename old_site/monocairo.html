---
layout: obsolete
title: "Mono.Cairo"
permalink: /old_site/Mono.Cairo/
redirect_from:
  - /Mono.Cairo/
---

<h1>Mono.Cairo</h1>

<p>Cairo is a low-level 2D vector drawing library. Various rendering backends (XRender, Win32) are already supported and more (ie. glitz -- OpenGL hardware accelerated backend) are on the way. The Mono.Cairo.dll assembly exposes the Cairo API to managed applications. The mapping is a pretty straightforward one, and the programming model is very close to the OpenGL model (although much simpler) 
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Table of contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#More_Resources"><span class="tocnumber">1</span> <span class="toctext">More Resources</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Using_Cairo_with_Gtk.2FGdk"><span class="tocnumber">2</span> <span class="toctext">Using Cairo with Gtk/Gdk</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Drawing_simple_primitives"><span class="tocnumber">3</span> <span class="toctext">Drawing simple primitives</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Saving_and_restoring_the_Cairo_state"><span class="tocnumber">4</span> <span class="toctext">Saving and restoring the Cairo state</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Filling_shapes_with_gradients"><span class="tocnumber">5</span> <span class="toctext">Filling shapes with gradients</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Hints"><span class="tocnumber">6</span> <span class="toctext">Hints</span></a></li>
</ul>
</td></tr></table>
<h3> <span class="mw-headline" id="More_Resources"> More Resources </span></h3>
<ul><li> <a href="{{site.github.url}}/old_site/Mono.Cairo_Tutorial" title="Mono.Cairo Tutorial">Mono.Cairo Tutorial</a> - An in-depth guide to getting started with Cairo and Mono.
</li><li> <a href="{{site.github.url}}/old_site/Mono.Cairo_Cookbook" title="Mono.Cairo Cookbook">Mono.Cairo Cookbook</a> - Some short recipes to help spice up your Cairo usage.
</li></ul>
<h3> <span class="mw-headline" id="Using_Cairo_with_Gtk.2FGdk"> Using Cairo with Gtk/Gdk </span></h3>
<p>A core class that does all the drawing is the <tt>Cairo.Context</tt> class. <tt>Context</tt> is always attached to a <tt>Surface</tt>. <tt>Surface</tt> can be window on the screen, an off-screen buffer or a static file on the disk.
</p><p>To use Cairo in Gdk/Gtk applications, a <tt>Context</tt> with a <tt>Gdk.Drawable</tt> target surface is needed. It can be obtained using two methods: 
</p>
<ul><li> Beginning in Gtk# 2.8, the Gdk.CairoHelper class provides cairo access to Gdk drawables.  You can create a cairo context for a given drawable:
</li></ul>
<pre class="csharp" style="font-family:monospace;">    Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Context</span> context <span style="color: #008000;">=</span> Gdk<span style="color: #008000;">.</span><span style="color: #0000FF;">CairoHelper</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Create</span><span style="color: #008000;">&#40;</span>drawable<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<ul><li> A second choice (recommended for older versions of Gtk) is to use a function provided in the <a href="http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/Mono.Cairo/Samples/" class="external text" rel="nofollow">Mono.Cairo samples</a>. This will work on all platforms and with older Gdk versions. The code in question resides in <a href="http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/Mono.Cairo/Samples/gtk/sysdraw.cs?view=markup" class="external text" rel="nofollow">sysdraw.cs</a> and you can simply download &amp; use this file in your project.
</li></ul>
<p>The best place to create and use the <tt>Context</tt> is the <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=5@ecma%3a1351%23Widget%2fE%2f26" class="external text" rel="nofollow">ExposeEvent</a> for the given widget. Usually you'll want to use the <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=5@ecma%3a838%23DrawingArea%2f" class="external text" rel="nofollow">Gtk.DrawingArea</a> for this task. An example implementation of the Expose event method:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> OnDrawingAreaExposed <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, ExposeEventArgs args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    DrawingArea area <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>DrawingArea<span style="color: #008000;">&#41;</span> o<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Context</span> context <span style="color: #008000;">=</span> Gdk<span style="color: #008000;">.</span><span style="color: #0000FF;">CairoHelper</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Create</span> <span style="color: #008000;">&#40;</span>area<span style="color: #008000;">.</span><span style="color: #0000FF;">GdkWindow</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// Perform some drawing</span>
&#160;
        <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>IDisposable<span style="color: #008000;">&#41;</span> gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Target</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>                               
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>Notice that <tt>Context</tt> is manually disposed before we leave the function. This is required for the time being since garbage collecting is not yet supported in Mono.Cairo.
</p>
<h3> <span class="mw-headline" id="Drawing_simple_primitives"> Drawing simple primitives </span></h3>
<p>Cairo drawing model works very much like a plotting machine. An abstract pen moves around the <tt>Surface</tt> area drawing lines and curves. The basic functions to handle the "plotting" are: <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fM%2f7" class="external text" rel="nofollow">MoveTo</a>, <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fM%2f8" class="external text" rel="nofollow">LineTo</a>, <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fM%2f9" class="external text" rel="nofollow">CurveTo</a>. These functions take <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a26%23PointD%2f" class="external text" rel="nofollow">PointD</a> objects as the arguments. <tt>PointD</tt> is a two-dimensional coordinate where <tt>X</tt> and <tt>Y</tt> are expressed as <tt>double</tt>.
</p>
<ul><li> <tt>Graphics.MoveTo (PointD coordinate)</tt> will position the cursor/pen at the given coordinate
</li><li> <tt>Graphics.LineTo (PointD coordinate)</tt> will make a straight line from the current pen position to the given coordinate. After calling this function the pen is located at the given coordinate. 
</li><li> <tt>Graphics.CurveTo (PointD coordinate1, PointD coordinate2, PointD coordinate3)</tt> draws a curved line from the current pen position to the coordinate3 position. Coordinates 1 &amp; 2 act as control points and affect the shape of the curve (Bezier). 
</li></ul>
<p>Having this in mind, we can draw a square using the following instructions:
</p>
<pre class="csharp" style="font-family:monospace;">PointD p1,p2,p3,p4<span style="color: #008000;">;</span>
p1 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10</span>,<span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
p2 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
p3 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
p4 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
<span style="color: #008080; font-style: italic;">// g is a Graphics object               </span>
g<span style="color: #008000;">.</span><span style="color: #0000FF;">MoveTo</span> <span style="color: #008000;">&#40;</span>p1<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p2<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p3<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p4<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p1<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
g<span style="color: #008000;">.</span><span style="color: #0000FF;">ClosePath</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p>However, our plotter analogy ends here -- <b>nothing has been drawn to the surface yet</b>. At this point we only have an outlined path, which we made sure is closed (thanks to <tt>ClosePath</tt>). To actually draw the path we need to call the <tt>Stroke</tt> method (<tt>g.Stroke ()</tt>). To fill the path one would call <tt>g.Fill ()</tt>. 
</p><p>Notice, that the <tt>Stroke</tt> and <tt>Fill</tt> methods don't take any arguments. The color for the stroke/fill, pen width and other interesting parameters are taken from the <tt>Graphics</tt> at the moment of stroking/filling. In other words we can say that <tt>Graphics</tt> class acts like a state machine. 
</p><p>Here is a complete implementation of the <tt>ExposeEvent</tt> that draws a black square with a red border inside a Gtk.DrawingArea:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> OnDrawingAreaExposed <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, ExposeEventArgs args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    DrawingArea area <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>DrawingArea<span style="color: #008000;">&#41;</span> o<span style="color: #008000;">;</span>
    Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Graphics</span> g <span style="color: #008000;">=</span> Graphics<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateDrawable</span> <span style="color: #008000;">&#40;</span>area<span style="color: #008000;">.</span><span style="color: #0000FF;">GdkWindow</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    PointD p1,p2,p3,p4<span style="color: #008000;">;</span>
    p1 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10</span>,<span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    p2 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    p3 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    p4 <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">10</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">MoveTo</span> <span style="color: #008000;">&#40;</span>p1<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p2<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p3<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p4<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span>p1<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">ClosePath</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Color <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">FillPreserve</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Color <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">Stroke</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>IDisposable<span style="color: #008000;">&#41;</span> g<span style="color: #008000;">.</span><span style="color: #0000FF;">Target</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>                                      
    <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>IDisposable<span style="color: #008000;">&#41;</span> g<span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><a href="{{site.github.url}}/images/old_site/f/f2/CairoGtk_1.png" class="image"><img alt="CairoGtk 1.png" src="{{site.github.url}}/images/old_site/f/f2/CairoGtk_1.png" width="310" height="323" /></a>
</p><p>I used <tt>FillPreserve</tt> method instead of <tt>Fill</tt> because the latter  destroys the current path. If you want to keep the path use <tt>StrokePreserve</tt> and <tt>FillPreserve</tt>.
</p><p>Take a look at the <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2f%2a" class="external text" rel="nofollow">Graphics class members</a> for other functions used to outline paths (ie. <tt>ArcTo</tt>, <tt>Rectangle</tt>).
</p>
<h3> <span class="mw-headline" id="Saving_and_restoring_the_Cairo_state"> Saving and restoring the Cairo state </span></h3>
<p>As you have already noticed, most of the drawing parameters are controlled in a stated-based manner. Various <tt>Graphics</tt> properties you can set include:
</p>
<ul><li> <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fP%2f3" class="external text" rel="nofollow">Color</a> -- to set the stroke/fill color. Color values (Red, Green, Blue, Alpha) are expressed in a 0 - 1 range (as <tt>double</tt>). 
</li><li> <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fP%2f7" class="external text" rel="nofollow">LineWidth</a> -- to control the width of the stroke line. 
</li><li> <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fP%2f8" class="external text" rel="nofollow">LineCap</a> -- controls the line capping (round, square, etc.)
</li></ul>
<p>This state-based approach is far more convenient than specifying all drawing parameters in a single function call (like it's done ie. in the low-level <a href="/index.php?title=Gdk&amp;action=edit&amp;redlink=1" class="new" title="Gdk (page does not exist)">Gdk</a> drawing methods). However, once you started creating your own custom drawing functions, you'll notice that it's hard to control all the state modifications spanned across multiple methods. In most cases you will not want to care about certain state modifiers assuming they're unset. 
</p><p>Cairo provides us with methods to control the state stack. The respective <tt>Graphics</tt> members are <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fM%2f2" class="external text" rel="nofollow">Save</a> and <a href="http://www.go-mono.com/docs/monodoc.ashx?tlink=0@ecma%3a15%23Graphics%2fM%2f3" class="external text" rel="nofollow">Restore</a>. 
</p><p><tt>Grahics.Save</tt> will copy the current state and push the copy on the top of the stack. <tt>Graphics.Restore</tt> will pop one state back from the stack. Clearly all the state-altering calls placed inside <tt>Save</tt>/<tt>Restore</tt> parenthesis are local. 
</p><p>It's a good programming practice to place <i>all</i> state modifications inside <tt>Save</tt>/<tt>Restore</tt> brackets. This way you can easily control the Cairo state and work on a "clean" (unpolluted) state in higher-level functions. 
</p><p>For example, you might create yourself the following function to draw a triangle:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> DrawTriangle <span style="color: #008000;">&#40;</span>Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Graphics</span> g, <span style="color: #6666cc; font-weight: bold;">double</span> x, <span style="color: #6666cc; font-weight: bold;">double</span> y, <span style="color: #6666cc; font-weight: bold;">bool</span> fill<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">MoveTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span>x <span style="color: #008000;">-</span> <span style="color: #FF0000;">10</span>, y <span style="color: #008000;">+</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span>x, y <span style="color: #008000;">-</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span>x <span style="color: #008000;">+</span> <span style="color: #FF0000;">10</span>, y <span style="color: #008000;">+</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">LineTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span>x <span style="color: #008000;">-</span> <span style="color: #FF0000;">10</span>, y <span style="color: #008000;">+</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">ClosePath</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Color <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>fill<span style="color: #008000;">&#41;</span> 
        g<span style="color: #008000;">.</span><span style="color: #0000FF;">Fill</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">else</span>
        g<span style="color: #008000;">.</span><span style="color: #0000FF;">Stroke</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    g<span style="color: #008000;">.</span><span style="color: #0000FF;">Restore</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p>In this example, the state we have when entering the function remains same when leaving the function. The <tt>Color</tt> modification we perform is local. 
</p>
<h3> <span class="mw-headline" id="Filling_shapes_with_gradients"> Filling shapes with gradients </span></h3>
<p>In most cases the <tt>Color</tt> property is used as the fill/stroke solid
color. You can, however, use a pattern as the fill/stroke pen.
<tt>Pattern</tt> can be a gradient, a bitmap or a surface part. To draw using
a pattern, you need to set the <tt>Graphics.Pattern</tt> property to a valid
<tt>Pattern</tt> object. I will discuss only gradients here. 
</p><p>A handy subclass of the <tt>Pattern</tt> class is the <tt>Gradient</tt> class.
Moreover, <tt>Gradient</tt> has two more sub-classes --
<tt>LinearGradient</tt> and <tt>RadialGradient</tt>. Gradients are built using
the color-stops -- a concept known from image editing software. 
</p><p>To create a simple black-to-white gradient you might write:
</p>
<pre class="csharp" style="font-family:monospace;">Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Gradient</span> pat <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">LinearGradient</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">0</span>, <span style="color: #FF0000;">100</span>, <span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
pat<span style="color: #008000;">.</span><span style="color: #0000FF;">AddColorStop</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
pat<span style="color: #008000;">.</span><span style="color: #0000FF;">AddColorStop</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Pattern</span> <span style="color: #008000;">=</span> pat<span style="color: #008000;">;</span></pre>
<p>The four parameters (double) given to <tt>LinearGradient</tt> constructor
specify a gradient vector (x0, y0, x1, y1). The first parameter given to
<tt>AddColorStop</tt> is the offset (0 to 1). The point located at x0, y0
will have the color where offset = 0, while point located at x1,y1 will have
a color of offset = 1. Other values are interpolated between the two. You can
add as many color stops as you need. Bear in mind that colorstops can be used as a method to perform alpha blending (just use the four-params constructor for
<tt>Color</tt>).
</p><p>Here is a sample <tt>ExposeEvent</tt> that draws some smooth shapes.  
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">void</span> OnDrawingAreaExposed <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> o, ExposeEventArgs args<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
        DrawingArea area <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span>DrawingArea<span style="color: #008000;">&#41;</span> o<span style="color: #008000;">;</span>
        Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Graphics</span> gr <span style="color: #008000;">=</span> CreateDrawable <span style="color: #008000;">&#40;</span>area<span style="color: #008000;">.</span><span style="color: #0000FF;">GdkWindow</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// Shape</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">MoveTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">200</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">CurveTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span>,
                    <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">200</span>,<span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">CurveTo</span> <span style="color: #008000;">&#40;</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">200</span>,<span style="color: #FF0000;">200</span><span style="color: #008000;">&#41;</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">200</span>,<span style="color: #FF0000;">200</span><span style="color: #008000;">&#41;</span>,
                    <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> PointD <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">200</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">ClosePath</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// Save the state to restore it later. That will NOT save the path</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Save</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Gradient</span> pat <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">LinearGradient</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">100</span>,<span style="color: #FF0000;">200</span>, <span style="color: #FF0000;">200</span>, <span style="color: #FF0000;">100</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        pat<span style="color: #008000;">.</span><span style="color: #0000FF;">AddColorStop</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        pat<span style="color: #008000;">.</span><span style="color: #0000FF;">AddColorStop</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Cairo<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">1</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Pattern</span> <span style="color: #008000;">=</span> pat<span style="color: #008000;">;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// Fill the path with pattern</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">FillPreserve</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// We &quot;undo&quot; the pattern setting here</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Restore</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        <span style="color: #008080; font-style: italic;">// Color for the stroke</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Color</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> Color <span style="color: #008000;">&#40;</span><span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span>,<span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">LineWidth</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">3</span><span style="color: #008000;">;</span>
        gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Stroke</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
        <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>IDisposable<span style="color: #008000;">&#41;</span> gr<span style="color: #008000;">.</span><span style="color: #0000FF;">Target</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
        <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>IDisposable<span style="color: #008000;">&#41;</span> gr<span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><a href="{{site.github.url}}/images/old_site/d/d2/CairoGtk_2.png" class="image"><img alt="CairoGtk 2.png" src="{{site.github.url}}/images/old_site/d/d2/CairoGtk_2.png" width="310" height="323" /></a>
</p>
<h3> <span class="mw-headline" id="Hints"> Hints </span></h3>
<ul><li> Don't try to keep <tt>Graphics</tt> across multiple expose events, this will not work due to double-buffering
</li><li> Don't try to use Cairo in threads other than the main (Gdk) thread. 
</li><li> If you need to draw sharp (crisp) 1 pixel lines, add 0.5 to the coordinates. This is related to how the anti-aliasing works. Normally a 1px line is drawn "between" two pixels, which means that two points get 1/2 of the color value (blur)
</li><li> Don't assume Cairo is the ultimate answer to every drawing need. Raw <a href="/index.php?title=Gdk&amp;action=edit&amp;redlink=1" class="new" title="Gdk (page does not exist)">Gdk</a> pixbuf blitting is still much faster than Cairo drawing and <a href="/index.php?title=Pango&amp;action=edit&amp;redlink=1" class="new" title="Pango (page does not exist)">Pango</a> is a better choice if you need to perform advanced text rendering (wrapping, ellipsizing, etc.) Gdk and Pango routines can be used along with Cairo without any special tricks.
</li><li> Color (and Alpha) values are expressed in a 0-1 range not 0-255 range.
</li><li> Don't forget to manually dispose the <tt>Graphics</tt> and the target <tt>Surface</tt> at the end of the expose event. Automatic garbage collecting is not yet 100% working in Cairo.
</li></ul>

