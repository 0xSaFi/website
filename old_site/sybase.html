---
layout: obsolete
title: "Sybase"
permalink: /old_site/Sybase/
---

<h1>Sybase</h1>

<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Info"><span class="tocnumber">1</span> <span class="toctext">Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Current_Status"><span class="tocnumber">2</span> <span class="toctext">Current Status</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Action_plan"><span class="tocnumber">3</span> <span class="toctext">Action plan</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Testing"><span class="tocnumber">4</span> <span class="toctext">Testing</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Connection_String_Format"><span class="tocnumber">5</span> <span class="toctext">Connection String Format</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#C.23_Example"><span class="tocnumber">6</span> <span class="toctext">C# Example</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Building_C.23_Example"><span class="tocnumber">6.1</span> <span class="toctext">Building C# Example</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Info"> Info </span></h2>
<ul><li> ADO.NET Provider for Sybase SQL Server databases
</li></ul>
<ul><li> Exists in namespace Mono.Data.SybaseClient and assembly Mono.Data.SybaseClient
</li></ul>
<ul><li> Used the <a href="http://www.freetds.org/" class="external text" rel="nofollow">FreeTDS</a> and <a href="http://jtds.sourceforge.net/" class="external text" rel="nofollow">jTDS</a> projects as resources.
</li></ul>
<ul><li> Does not require a client library
</li></ul>
<ul><li> Requires the assembly Mono.Data.Tds.dll which implements the TDS protocol
</li></ul>
<ul><li> Uses TDS Protocol Version 5.0
</li></ul>
<h2> <span class="mw-headline" id="Current_Status"> Current Status </span></h2>
<ul><li> Able to connect to Sybase ASE (Adapter Server Enterprise) 12.x databases
</li></ul>
<ul><li> Does not work with Sybase databases prior to 12.x, such as, 11.x.  Is this due to Unicode or something with our TDS 5.0 implementation?
</li></ul>
<ul><li> Does not work with Sybase ASA (Adaptive SQL Anywhere) databases.  Maybe the <a href="http://www.freetds.org/" class="external text" rel="nofollow">FreeTDS</a> project could help you on this.
</li></ul>
<ul><li> SQL commands can be executed via ExecuteNonQuery() of a SybaseCommand.
</li></ul>
<ul><li> SQL aggregates can be executed and a single row and single column result can be retrieved via ExecuteScalar() of a SybaseCommand
</li></ul>
<ul><li> SQL queries can be executed via ExecuteReader() and results can be retrieved via SybaseDataReader.
</li></ul>
<ul><li> a DataTable with schema info about a result can be gotten via GetSchemaTable() in a SybaseDataReader
</li></ul>
<ul><li> Data can be filled in a DataTable in a DataSet via a SybaseDataAdapter
</li></ul>
<ul><li> SybaseCommandBuilder has been implemented; however, it will not work due to Sybase provider does not return the table names nor key info.  This may need modification of TDS 5.0 support in Mono.Data.Tds.
</li></ul>
<h2> <span class="mw-headline" id="Action_plan"> Action plan </span></h2>
<ul><li> Need for people to create more tests...
</li></ul>
<ul><li> Make sure the provider works with Sybase ASE 15.  
</li></ul>
<ul><li> Add support for new features in Sybase ASE 15
</li></ul>
<ul><li> Make Mono's Sybase provider compatible with Sybase's own ADO.NET provider
</li></ul>
<ul><li> When executing a SQL statement using CommandBehavior of KeyInfo, get the table names used in the SQL and any primary key info.  This is needed by the SybaseCommandBuilder to build the where clause of Update and Delete statements.
</li></ul>
<ul><li> Add support for Sybase ASA (Adapter Server Anywhere)
</li></ul>
<ul><li> Add support for older Sybase ASE (Adapter Server Enterprise) databases prior to 12.x
</li></ul>
<h2> <span class="mw-headline" id="Testing"> Testing </span></h2>
<p><b>Prerequisites</b> 
</p>
<ul><li> Have a working mono and mcs installed
</li></ul>
<ul><li> Have access to a Sybase ASE 12.x or higher database or either download it:
</li></ul>
<ul><li> <a href="http://www.sybase.com/downloads" class="external text" rel="nofollow">Sybase</a>
</li></ul>
<ul><li> When you install Sybase Adapter Server Enterprise 12.x from Sybase, the default port is 5000.
</li></ul>
<h1> <span class="mw-headline" id="Connection_String_Format"> Connection String Format </span></h1>
<ul><li> Has a connection string format:
</li></ul>
<pre>
Server=hostname;Database=databaseName;User ID=userid;Password=password
</pre>
<ul><li> The Server part can be used two ways:
</li></ul>
<ul><li> hostname - "Server=MYHOST"
</li></ul>
<ul><li> hostname,port - "Server=MYHOST,5000"
</li></ul>
<ul><li> Connection String Parameters:
</li></ul>
<table border="1" cellpadding="2" cellspacing="0" align="center" style="margin: 0 0 1em 1em; text-align:left; border-collapse:collapse; border:1px gray solid; font-size:95%; background:#f9f9f9">
<tr>
<th> Parameter Definition </th>
<th> Description </th>
<th> Example
</th></tr>
<tr>
<td> Server or Data Source </td>
<td> hostname of the SQL Server </td>
<td> Server=MYHOST
</td></tr>
<tr>
<td> Database or Initial Catalog </td>
<td> name of the database </td>
<td> Database=pubs
</td></tr>
<tr>
<td> User ID or UID </td>
<td> name of SQL Server user. </td>
<td> User ID=sa
</td></tr>
<tr>
<td> Password </td>
<td> password for SQL Server user. </td>
<td> Password=mypass12
</td></tr>
<tr>
<td> Min Pool Size </td>
<td> Specifies the minimum number of connections in the connection pool.  Default is 0. </td>
<td> Min Pool Size=0
</td></tr>
<tr>
<td> Max Pool Size </td>
<td> Specifies the maximum number of connections in the connection pool.  Default is 100. </td>
<td> Max Pool Size=100
</td></tr>
<tr>
<td> Pooling </td>
<td> Specifies whether or not to use connection pooling.  Valid values are TRUE or YES to use connection pooling or FALSE or NOT to not use connection pooling.  Default is TRUE. </td>
<td> Pooling=true
</td></tr></table>
<p><br />
</p>
<h1> <span class="mw-headline" id="C.23_Example"> C# Example </span></h1>
<pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">Mono.Data.SybaseClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Server=myhostname,5000;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Database=pubs;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=myuserid;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=mypassword;&quot;</span><span style="color: #008000;">;</span>
       IDbConnection dbcon<span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SybaseConnection<span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       IDbCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span>
            <span style="color: #666666;">&quot;SELECT name &quot;</span> <span style="color: #008000;">+</span>
            <span style="color: #666666;">&quot;FROM master.dbo.sysobjects&quot;</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
       IDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
            <span style="color: #6666cc; font-weight: bold;">string</span> objName <span style="color: #008000;">=</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;name&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">ToString</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
            Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Name: &quot;</span> <span style="color: #008000;">+</span> objName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #008000;">&#125;</span>
       <span style="color: #008080; font-style: italic;">// clean up</span>
       reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       reader <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Dispose</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcmd <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
       dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Close</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
       dbcon <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<h2> <span class="mw-headline" id="Building_C.23_Example"> Building C# Example </span></h2>
<p>Save the example to a file, such as, TestExample.cs, then to build on Linux, do:
</p>
<pre>
 mcs TestExample.cs -r:System.Data.dll -r:Mono.Data.SybaseClient.dll
</pre>
<p>To run the example:
</p>
<pre>
 mono TestExample.exe 
</pre>

