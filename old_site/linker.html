---
layout: obsolete
title: "Linker"
permalink: /old_site/Linker/
redirect_from:
  - /Linker/
  - /Mink/
---

<h1>Linker</h1>

<p>The linker is a tool one can use to only ship the minimal possible set of functions that a set of programs might require to run as opposed to the full libraries.
</p><p><a href="http://evain.net/blog/" class="external text" rel="nofollow">Jb Evain</a> started to work on the linker during the <a href="{{site.github.url}}/old_site/Summer2006" title="Summer2006"> Summer Of Code 2006</a>.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Table of contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Why_would_one_use_the_linker_.3F"><span class="tocnumber">1</span> <span class="toctext">Why would one use the linker&#160;?</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Usage"><span class="tocnumber">1.1</span> <span class="toctext">Usage</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#mkbundle.2C_the_linker.27s_best_friend"><span class="tocnumber">1.2</span> <span class="toctext">mkbundle, the linker's best friend</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Download"><span class="tocnumber">2</span> <span class="toctext">Download</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Links"><span class="tocnumber">3</span> <span class="toctext">Links</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Linker_2.0_Requirements"><span class="tocnumber">4</span> <span class="toctext">Linker 2.0 Requirements</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Why_would_one_use_the_linker_.3F"> Why would one use the linker&#160;? </span></h1>
<p>There are a couple of scenarios for the linker:
</p>
<ul><li> Reducing the size of a library.
</li><li> Creating a library based on a profile definition.
</li></ul>
<p>Because you don't always use every feature of the libraries you are using for your program. By using the linker, you can reduce the size of what you have to distribute to your users.
</p>
<h2> <span class="mw-headline" id="Usage"> Usage </span></h2>
<h2> <span class="mw-headline" id="mkbundle.2C_the_linker.27s_best_friend"> mkbundle, the linker's best friend </span></h2>
<p>The linker operates only at the assemblies level. By using the <a href="{{site.github.url}}/old_site/Command-Line_Tools#Project_converstion_.26_deployment" title="Command-Line Tools">mkbundle</a> program, you can create a single executable which will contain the strict minimum it needs to run.
</p><p>See the man page for mkbundle for details on its operation.
</p>
<h1> <span class="mw-headline" id="Download"> Download </span></h1>
<p>For the moment, no versions has been released, but you can download the code from the <a href="{{site.github.url}}/old_site/SourceCodeRepository">SVN</a>, in the module <a href="http://anonsvn.mono-project.com/viewvc/trunk/mcs/tools/linker" class="external text" rel="nofollow">/mcs/tools/linker</a>
</p>
<h1> <span class="mw-headline" id="Links"> Links </span></h1>
<ul><li> <a href="http://evain.net/blog/articles/2006/08/21/link-to-link" class="external text" rel="nofollow">Sample use of the linker</a>
</li><li> <a href="http://evain.net/blog/articles/2006/08/22/linking-all-the-way-down" class="external text" rel="nofollow">Sample use of the Linker and mkbundle</a>
</li></ul>
<h1> <span class="mw-headline" id="Linker_2.0_Requirements"> Linker 2.0 Requirements </span></h1>
<p>We would like to use the linker to generate multiple assemblies from the same code base.   Instead of using an increasingly large number of ifdefs in the source code to add or remove features we would like to use the linker in this situation.
</p><p><b>mscorlib handling:</b> Currently the linker is not able to link mscorlib as it  would accidentally remove fields that are shared between the C runtime and the managed code in mscorlib (and we must investigate if there are cases in System that also need to be handled specially). (Implemented in SVN)
</p><p>The linker should have a list of types whose fields must not be removed or reordered and that must be kept as they are.
</p><p><b>blacklist support:</b> This is an extension of mscorlib handling, but it should be possible for a user of the linker to specify a list of classes that should remain untouched.    (Implemented in SVN)
</p><p><b>Profile-based Linking:</b>  The linker should support reading one of the .info files as generated by mono-api-info (in mcs/tools/CorCompare) and generate an assembly that contains the same API entry points.   In this mode:
</p>
<ul><li> The linker should turn any public types and members that are pulled by the mark process that are absent from the source profile into "internal" types or members to ensure that the public API does not expose more than it should.
</li></ul>
<ul><li> Handle base-classes that are not present.   In a few cases (System.AppDomain) classes are made public because they are exposed by the inheritance chain should either be removed (_AppDomain interface) or we should decide on a case-by-case basis if it is worth exposing them.
</li></ul>
<p>For example, the following should be possible:
</p>
<pre class="bash" style="font-family:monospace;">$ <span style="color: #c20cb9; font-weight: bold;">mkdir</span> silverlight
$ monolinker -profile:mscorlib.silver.info <span style="color: #000000; font-weight: bold;">/</span>usr<span style="color: #000000; font-weight: bold;">/</span>lib<span style="color: #000000; font-weight: bold;">/</span>mono<span style="color: #000000; font-weight: bold;">/</span>full<span style="color: #000000; font-weight: bold;">/</span>mscorlib.dll -out:silverlight<span style="color: #000000; font-weight: bold;">/</span>mscorlib.dll</pre>

