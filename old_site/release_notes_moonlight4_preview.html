---
layout: obsolete
title: "Release Notes Moonlight4 Preview"
permalink: /old_site/Release_Notes_Moonlight4_Preview/
---

<h1>Release Notes Moonlight4 Preview</h1>

<p>Moonlight 4 Preview 1 is the first preview of Moonlight that includes support for the Siverlight 3 APIs and partial support for Silverlight 4 APIs.  We consider the Silverlight 3 API support to be feature complete while the Silverlight 4 APIs are both partial and might be missing features.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Major_Highlights"><span class="tocnumber">1</span> <span class="toctext">Major Highlights</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#API_Compatibility"><span class="tocnumber">1.1</span> <span class="toctext">API Compatibility</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#New_Rendering_Engine"><span class="tocnumber">1.2</span> <span class="toctext">New Rendering Engine</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#GPU-based_acceleration"><span class="tocnumber">1.2.1</span> <span class="toctext">GPU-based acceleration</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#3D_Transformations"><span class="tocnumber">1.2.2</span> <span class="toctext">3D Transformations</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Shaders"><span class="tocnumber">1.2.3</span> <span class="toctext">Shaders</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#New_Platform_Abstraction_Layer"><span class="tocnumber">1.3</span> <span class="toctext">New Platform Abstraction Layer</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Windowing_System"><span class="tocnumber">1.3.1</span> <span class="toctext">Windowing System</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Network_Status"><span class="tocnumber">1.3.2</span> <span class="toctext">Network Status</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Capture_Service"><span class="tocnumber">1.3.3</span> <span class="toctext">Capture Service</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Local_Messaging"><span class="tocnumber">1.3.4</span> <span class="toctext">Local Messaging</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#OOB_Application_Installation"><span class="tocnumber">1.3.5</span> <span class="toctext">OOB Application Installation</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-13"><a href="#Out_of_Browser_Execution"><span class="tocnumber">1.4</span> <span class="toctext">Out of Browser Execution</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Video_Capture"><span class="tocnumber">1.5</span> <span class="toctext">Video Capture</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Developer_Tools"><span class="tocnumber">1.6</span> <span class="toctext">Developer Tools</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Chrome_Support"><span class="tocnumber">1.7</span> <span class="toctext">Chrome Support</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Linux_Chrome_libjpeg_issue"><span class="tocnumber">1.7.1</span> <span class="toctext">Linux Chrome libjpeg issue</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#New_Codecs"><span class="tocnumber">1.8</span> <span class="toctext">New Codecs</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Smooth_Streaming"><span class="tocnumber">1.9</span> <span class="toctext">Smooth Streaming</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Local_Connections"><span class="tocnumber">1.10</span> <span class="toctext">Local Connections</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Missing_Features"><span class="tocnumber">2</span> <span class="toctext">Missing Features</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Obtaining_Moonlight_4_Preview_1"><span class="tocnumber">3</span> <span class="toctext">Obtaining Moonlight 4 Preview 1</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Keeping_up_with_Moonlight_4"><span class="tocnumber">4</span> <span class="toctext">Keeping up with Moonlight 4</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#Nightly_Builds"><span class="tocnumber">4.1</span> <span class="toctext">Nightly Builds</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Source_code"><span class="tocnumber">4.2</span> <span class="toctext">Source code</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Major_Highlights"> Major Highlights </span></h1>
<h2> <span class="mw-headline" id="API_Compatibility"> API Compatibility </span></h2>
<p>The major change from Moonlight 2 is that we now implement the Silverlight 3 API as well as parts of the Silverlight 4 API.   The actual missing pieces from the API are documented below.
</p>
<h2> <span class="mw-headline" id="New_Rendering_Engine"> New Rendering Engine </span></h2>
<p>Moonlight's rendering engine has been rewritten to support hardware acceleration, 3D transformations and pixel shaders. The engine provides a backend system that makes it easy to implement hardware acceleration support for new platforms. The brilliant <a href="http://en.wikipedia.org/wiki/Gallium3D" class="external text" rel="nofollow">Gallium3D</a> open source project is used as the default software rendering backend on systems that lack sufficient hardware acceleration support.
</p><p>The following sections describe how this new rendering engine is used.  
</p>
<h3> <span class="mw-headline" id="GPU-based_acceleration"> GPU-based acceleration </span></h3>
<p>If your system has a GPU with OpenGL 2.0 drivers installed for it, Moonlight can offload the visual tree composition to the GPU and developers can also direct Moonlight to cache images directly into the GPU to accelerate rendering and animations on a case-by-case basis.
</p><p>Developers can also choose to use GPU acceleration for images by using the CacheMode property and setting it to BitmapCache.
</p><p>Go to the <a href="{{site.baseurl}}/Moonlight4_OpenGL_Status" title="Moonlight4 OpenGL Status">OpenGL status page</a> to find out if your driver is currently supported by Moonlight.
</p>
<h3> <span class="mw-headline" id="3D_Transformations"> 3D Transformations </span></h3>
<p>This release of Moonlight supports all of the 3D transformations that were introduced in Silverlight. 3D transformations are typically used to create elements or animations that have perspective in them.
</p><p>You can see some <a href="http://www.silverlightshow.net/items/Perspective-3D-in-Silverlight-3.aspx" class="external text" rel="nofollow">demos here</a>.
</p>
<h3> <span class="mw-headline" id="Shaders"> Shaders </span></h3>
<p>Moonnlight supports both the pre-defined blur and drop shadow effects on any visual element(exposed by the BlurShadowEffect and the DropShadowEffect classes) it also supports user-specified <a href="http://msdn.microsoft.com/en-us/library/system.windows.media.effects.pixelshader(VS.95).aspx" class="external text" rel="nofollow">pixel shaders</a> that allow developers to apply complex effects to their visual elements.
</p>
<h2> <span class="mw-headline" id="New_Platform_Abstraction_Layer"> New Platform Abstraction Layer </span></h2>
<p>In order to ease porting to other operating systems, messaging systems, windowing systems, and hardware configurations, moonlight 4 has been restructured so that all interactions with these systems goes through an abstract layer, called the PAL.
</p><p>There are several interfaces within each subsection, some of which are listed below:
</p>
<h3> <span class="mw-headline" id="Windowing_System"> Windowing System </span></h3>
<ul><li> MoonWindowingSystem
</li><li> MoonWindow
</li><li> MoonWindowless
</li><li> MoonClipboard
</li><li> MoonEvent and various specialized subclasses
</li></ul>
<h3> <span class="mw-headline" id="Network_Status"> Network Status </span></h3>
<ul><li> MoonNetworkService
</li></ul>
<h3> <span class="mw-headline" id="Capture_Service"> Capture Service </span></h3>
<ul><li> MoonVideoCaptureService
</li><li> MoonAudioCaptureService
</li></ul>
<h3> <span class="mw-headline" id="Local_Messaging"> Local Messaging </span></h3>
<ul><li> MoonMessagingService
</li></ul>
<h3> <span class="mw-headline" id="OOB_Application_Installation"> OOB Application Installation </span></h3>
<ul><li> MoonInstallerService
</li></ul>
<h2> <span class="mw-headline" id="Out_of_Browser_Execution"> Out of Browser Execution </span></h2>
<p>Moonlight now supports out of browser execution of the websites that support it.
</p>
<h2> <span class="mw-headline" id="Video_Capture"> Video Capture </span></h2>
<p>Moonlight supports capture using <a href="http://en.wikipedia.org/wiki/V4L2" class="external text" rel="nofollow">V4L2</a>.  The following pixel formats are supported at present.
</p>
<ul><li> YUYV
</li><li> YUV420
</li></ul>
<p>If your camera or tuner card doesn't work, please let us know the model and/or any other info about your hardware setup, and we'll make it work.
</p>
<h2> <span class="mw-headline" id="Developer_Tools"> Developer Tools </span></h2>
<p>We are providing certain features for developers that want to improve the performance of their application or want to debug how Moonlight is rendering things.   When you right-click on a Silverlight surface, the "Advanced" tab has features that will let you:
</p>
<ul><li> Display the Frames Per Second counters
</li><li> Track exposed regions
</li><li> Track clipping rectangles
</li><li> Show UIElement bounding boxes
</li><li> Show textbox bounds
</li><li> Enable/disable occlusion culling
</li><li> Emulate the Windows Platform key codes
<ul><li> Some applications have hardcoded Windows platform key codes, this lets those applications run on Moonlight.
</li></ul>
</li><li> Allows users to use the Curl bridge over the browser HTTP stack
</li><li> Enable or disable the GPU acceleration stack.
</li></ul>
<h2> <span class="mw-headline" id="Chrome_Support"> Chrome Support </span></h2>
<p>In addition to supporting Firefox, the new Moonlight preview ships with Google Chrome packages and works as an out-of-browser plugin.
</p>
<h3> <span class="mw-headline" id="Linux_Chrome_libjpeg_issue"> Linux Chrome libjpeg issue </span></h3>
<p>Current google-built linux versions of chrome link against the widely deployed libjpeg.so.62.  All linux distributions should have this library installed, but some of them (including openSUSE 11.3) install them for legacy purposes only, and link their own libraries against libjpeg.so.8.
</p><p>It is very easy to end up in a situation where both versions of libjpeg are loaded into the same process, at which time it's also very easy to end up in a situation where code compiled to use libjpeg.so.8 is actually calling through to dynamic symbols exported from libjpeg.so.62.  This causes an immediate abort().
</p><p>For moonlight specifically this happens because the chrome process pulls in libjpeg.so.62, and the gdk-pixbuf jpeg loader pulls in libjpeg.so.8.  We have added code (pending for preview 2, in git already if you're tracking it) specifically to check for this situation and disable jpeg loading entirely if we find it to be present.  Chrome has plans to move to libjpeg-turbo in the future, so this will eventually not (hopefully) be an issue.
</p><p>If there are chromium packages as part of your linux distribution, those might fix the problem, as they are more likely to link against the blessed libjpeg.so, whatever version it might be.
</p><p>Some other chrome issue regarding libjpeg versions are:
</p>
<ul><li> <a href="http://code.google.com/p/chromium/issues/detail?id=31427" class="external text" rel="nofollow">chromium issue #31427</a>
</li><li> <a href="http://code.google.com/p/chromium/issues/detail?id=30205" class="external text" rel="nofollow">chromium issue #30205</a>
</li><li> <a href="http://code.google.com/p/chromium/issues/detail?id=48789" class="external text" rel="nofollow">chromium issue #48789 (re: libjpeg-turbo)</a>
</li></ul>
<h2> <span class="mw-headline" id="New_Codecs"> New Codecs </span></h2>
<p>In addition to the MP3, VC1, WMA, and the various WMV codecs that were supported in Moonlight 2, the Microsoft Media Pack that Moonlight uses also contains the video codec for H.264 and the AAC audio codec.
</p>
<h2> <span class="mw-headline" id="Smooth_Streaming"> Smooth Streaming </span></h2>
<p>Even though Moonlight 2 shipped with support for Smooth Streaming, the underlying pipeline that is used by the Smooth Streaming system has been upgraded.
</p>
<h2> <span class="mw-headline" id="Local_Connections"> Local Connections </span></h2>
<p>Moonlight supports the System.Windows.Messaging namespace which allows for multiple moonlight plugins on the same web page (or different webpages) to communicate directly, and safely.
</p>
<h1> <span class="mw-headline" id="Missing_Features"> Missing Features </span></h1>
<p>Some features are presently missing or incomplete:
</p>
<ul><li> RichTextBox (incomplete)
</li><li> Printing (missing)
</li><li> Elevated Trust (incomplete)
</li><li> WebBrowser (missing)
</li><li> CachedComposition&#160;???
</li><li> TextInput event (missing)
</li><li> Navigation (incomplete)
</li><li> Microphone (missing)
</li><li> WebCam (incomplete&#160;???)
</li><li> UDP sockets
<ul><li> UdpAnySourceMulticastClient (not implemented)
</li><li> UdpSingleSourceMulticastClient (not implemented)
</li></ul>
</li><li> Analytics (missing)
</li><li> Window
<ul><li> ChildWindow (incomplete)
</li><li> NotificationWindow (not implemented)
</li></ul>
</li><li> Seadragon BlurFactor (missing)
</li></ul>
<h1> <span class="mw-headline" id="Obtaining_Moonlight_4_Preview_1"> Obtaining Moonlight 4 Preview 1 </span></h1>
<p>The current release of Moonlight can be downloaded <a href="http://go-mono.com/moonlight/" class="external text" rel="nofollow">here</a>.
</p>
<h1> <span class="mw-headline" id="Keeping_up_with_Moonlight_4"> Keeping up with Moonlight 4 </span></h1>
<h2> <span class="mw-headline" id="Nightly_Builds"> Nightly Builds </span></h2>
<p>You can always download the most recent bleeding edge bits (basically the last successful compile) from <a href="http://go-mono.com/moonlight/nightlies.aspx" class="external text" rel="nofollow">here</a>.  Be aware these have had no testing done on them at all.  They might crash your browser, or worse.
</p>
<h2> <span class="mw-headline" id="Source_code"> Source code </span></h2>
<p>Source code for current and previous moonlight releases is available from <a href="http://ftp.novell.com/pub/mono/sources/moon/" class="external text" rel="nofollow">our ftp site.</a>
</p><p>If you plan on tracking the source it's much easier to use git.  The instructions for checking things out can be found <a href="{{site.baseurl}}/Moonlight#Developing_Moonlight" title="Moonlight">here</a>.
</p>
