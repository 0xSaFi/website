---
layout: obsolete
title: "MonoTorrent"
permalink: /old_site/MonoTorrent/
redirect_from:
  - /MonoTorrent/
  - /Bitsharp/
---

<h1>MonoTorrent</h1>

<p><span style="color:#ff0000">Some of the information here is out of date. For up to date information and samples please check at <a href="http://www.monotorrent.com" class="external free" rel="nofollow">http://www.monotorrent.com</a>.</span>
</p><p><br />
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#About_MonoTorrent"><span class="tocnumber">1</span> <span class="toctext">About MonoTorrent</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Licensing"><span class="tocnumber">1.1</span> <span class="toctext">Licensing</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Source_Code_and_Binaries"><span class="tocnumber">1.2</span> <span class="toctext">Source Code and Binaries</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#UIs"><span class="tocnumber">1.3</span> <span class="toctext">UIs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Client_Library"><span class="tocnumber">2</span> <span class="toctext">Client Library</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Features"><span class="tocnumber">2.1</span> <span class="toctext">Features</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Sample_Code"><span class="tocnumber">2.2</span> <span class="toctext">Sample Code</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Tracker_Library"><span class="tocnumber">3</span> <span class="toctext">Tracker Library</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Features_2"><span class="tocnumber">3.1</span> <span class="toctext">Features</span></a></li>
</ul>
</li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="About_MonoTorrent"> About MonoTorrent </span></h2>
<p>MonoTorrent is the product of Googles Summer of Code 2006. It is a complete BitTorrent suite of libraries which can be embedded in an application. The suite contains:
</p>
<ol><li> <b>Client Library</b> - Allows the uploading/downloading of torrents.
</li><li> <b>Tracker Library</b> - Allows the hosting of .torrents.
</li><li> <b>Torrent Creator</b> - Allows the creation and editing of .torrent files.
</li></ol>
<p>All of these libraries were written with Mono in mind. As a result these libraries will function on any operating system that supports either the Microsoft .NET Framework or Mono Framework, be it Windows, Linux, MacOs or other.
</p>
<h4> <span class="mw-headline" id="Licensing"> Licensing </span></h4>
<p>All the modules in MonoTorrent are licensed under the MIT/X11 license, so anyone is free to use them as they will. Hopefully anyone who decides to use a library in an application would send an email in to get their application named in the Products Using MonoTorrent section.
</p>
<h4> <span class="mw-headline" id="Source_Code_and_Binaries"> Source Code and Binaries </span></h4>
<p>The sourcecode for MonoTorrent is located in the mono SVN. It is available via annoymous SVN at this location: <a href="http://anonsvn.mono-project.com/viewvc/trunk/bitsharp/" class="external free" rel="nofollow">http://anonsvn.mono-project.com/viewvc/trunk/bitsharp/</a>
</p><p>Currently there are no precompiled binaries hosted anywhere.
</p>
<h4> <span class="mw-headline" id="UIs"> UIs </span></h4>
<p>There is a curses based UI, in module <a href="{{site.github.url}}/old_site/MonoCurses" title="MonoCurses">MonoCurses</a> and a Windows.Forms UI in <a href="http://code.google.com/p/monotorrent" class="external free" rel="nofollow">http://code.google.com/p/monotorrent</a>.
</p>
<h2> <span class="mw-headline" id="Client_Library"> Client Library </span></h2>
<p>The client library contains all the functionality to create a BitTorrent client, or embed BitTorrent functionality in an application (e.g. an automatic update module).
</p><p><br />
</p>
<h4> <span class="mw-headline" id="Features"> Features </span></h4>
<ol><li> Compact and Non-Compact tracker responses supported
</li><li> Multi-Tracker support
</li><li> Scrape and Multi-Scrape support
</li><li> Supports Fast Peers Extensions
</li><li> Supports upload and download speed limiting on per-torrent and a global basis
</li><li> Multiple simultaneous downloads
</li><li> Quick Resume
</li><li> Selective File Downloading
</li><li> File Prioritisation
</li><li> Manual Announce
</li><li> Only uses one port for all communications
</li><li> Can set default download directory
</li><li> Supports connection encryption
</li></ol>
<p><br />
</p>
<h4> <span class="mw-headline" id="Sample_Code"> Sample Code </span></h4>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
        <span style="color: #008000;">&#123;</span>
            <span style="color: #008080; font-style: italic;">// An ITorrentManager is passed out of the engine when you load a torrent. This is</span>
            <span style="color: #008080; font-style: italic;">// used for controlling the torrent.</span>
            ITorrentManager torrentManager<span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// These are the default settings for the engine for this session</span>
            EngineSettings engineSettings <span style="color: #008000;">=</span> EngineSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">DefaultSettings</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// The default location to download files to on your HardDrive, like a downloads folder</span>
            <span style="color: #008080; font-style: italic;">// All files will be downloaded using this as the base directory. Single file torrents will</span>
            <span style="color: #008080; font-style: italic;">// go directly into this directory, multifile torrents will create a directory within this</span>
            <span style="color: #008080; font-style: italic;">// and download there.</span>
            engineSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">DefaultSavePath</span> <span style="color: #008000;">=</span> <span style="color: #666666;">@&quot;D:\Downloads\Torrents&quot;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Maximum upload speed of 30 kB/sec. At upload speeds of less than 5kB/sec, there will</span>
            <span style="color: #008080; font-style: italic;">// be automatic download speed limiting to 5x the selected upload.</span>
            engineSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">GlobalMaxUploadSpeed</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">30</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Every torrent loaded into the engine for this session will start off with these default settings</span>
            <span style="color: #008080; font-style: italic;">// unless other settings are specified.</span>
            TorrentSettings torrentSettings <span style="color: #008000;">=</span> TorrentSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">DefaultSettings</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Each torrent will be allowed a max of 10kB/sec upload speed</span>
            torrentSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">MaxUploadSpeed</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">10</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Each torrent will have 4 upload slots to allow 2.5kB/sec per slot.</span>
            torrentSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">UploadSlots</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">4</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Instantiate a new engine with the engineSettings and Default Torrent settings.</span>
            ClientEngine engine <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> ClientEngine<span style="color: #008000;">&#40;</span>engineSettings, torrentSettings<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// A torrent can be downloaded from the specified url, saved to the specified file and</span>
            <span style="color: #008080; font-style: italic;">// then loaded into the engine.</span>
            <span style="color: #008080; font-style: italic;">// torrentManager =engine.LoadTorrent(new Uri(&quot;http://example.com/example.torrent&quot;), @&quot;D:\Downloads\example.torrent&quot;);</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Alternatively a .torrent can just be loaded from the disk. This torrent will save</span>
            <span style="color: #008080; font-style: italic;">// to the DefaultSaveLocation as specified in the EngineSettings and will inherit the</span>
            <span style="color: #008080; font-style: italic;">// default settings that are set in the Engine.</span>
            <span style="color: #008080; font-style: italic;">//torrentManager = engine.LoadTorrent(@&quot;D:\Downloads\Torrents\MyTorrentFile.torrent&quot;);</span>
&#160;
            <span style="color: #008080; font-style: italic;">// This torrent would use the supplied settings instead of using the ones that were</span>
            <span style="color: #008080; font-style: italic;">// supplied when instantiating the engine</span>
            torrentManager <span style="color: #008000;">=</span> engine<span style="color: #008000;">.</span><span style="color: #0000FF;">LoadTorrent</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">@&quot;D:\Downloads\Torrents\MyTorrentFile.torrent&quot;</span>, TorrentSettings<span style="color: #008000;">.</span><span style="color: #0000FF;">DefaultSettings</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// If you have loaded multiple torrents into the engine, you can start them all at once with this:</span>
            <span style="color: #008080; font-style: italic;">// engine.Start();</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Or you can start one specific torrent by passing in that torrents ITorrentManager</span>
            engine<span style="color: #008000;">.</span><span style="color: #0000FF;">Start</span><span style="color: #008000;">&#40;</span>torrentManager<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// You can hook into various events in order to display information on screen:</span>
            <span style="color: #008080; font-style: italic;">// Fired every time a peer is added through DHT, PEX or Tracker Updates</span>
            torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">OnPeersAdded</span><span style="color: #008000;">+=</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> EventHandler<span style="color: #008000;">&lt;</span>PeersAddedEventArgs<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>PeersAdded<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Fired every time a piece is hashed</span>
            torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">OnPieceHashed</span><span style="color: #008000;">+=</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> EventHandler<span style="color: #008000;">&lt;</span>PieceHashedEventArgs<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>PieceHashed<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Fired every time the torrent State changes (i.e. paused/hashing/downloading)</span>
            torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">OnTorrentStateChanged</span><span style="color: #008000;">+=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> EventHandler<span style="color: #008000;">&lt;</span>TorrentStateChangedEventArgs<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>torrentStateChanged<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Fired every time a piece changes. i.e. block sent/received/written to disk</span>
            torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">PieceManager</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OnPieceChanged</span><span style="color: #008000;">+=</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> EventHandler<span style="color: #008000;">&lt;</span>PieceEventArgs<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>pieceStateChanged<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Fired every time a connection is either created or destroyed</span>
            ClientEngine<span style="color: #008000;">.</span><span style="color: #0000FF;">connectionManager</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OnPeerConnectionChanged</span><span style="color: #008000;">+=</span><a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> EventHandler<span style="color: #008000;">&lt;</span>PeerConnectionEventArgs<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>peerConnectionChanged<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Fired every time a peer message is sent</span>
            ClientEngine<span style="color: #008000;">.</span><span style="color: #0000FF;">connectionManager</span><span style="color: #008000;">.</span><span style="color: #0000FF;">OnPeerMessages</span><span style="color: #008000;">+=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> EventHandler<span style="color: #008000;">&lt;</span>PeerMessageEventArgs<span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span>peerMessageSentOrRecieved<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
            <span style="color: #008080; font-style: italic;">// Keep running while the torrent isn't stopped or paused.</span>
            <span style="color: #0600FF; font-weight: bold;">while</span> <span style="color: #008000;">&#40;</span>torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">State</span> <span style="color: #008000;">!=</span> TorrentState<span style="color: #008000;">.</span><span style="color: #0000FF;">Stopped</span> <span style="color: #008000;">&amp;&amp;</span> torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">State</span> <span style="color: #008000;">!=</span> TorrentState<span style="color: #008000;">.</span><span style="color: #0000FF;">Paused</span><span style="color: #008000;">&#41;</span>
            <span style="color: #008000;">&#123;</span>
                Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span>torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">Progress</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                <span style="color: #000000;">System.<span style="color: #0000FF;">Threading</span></span><span style="color: #008000;">.</span><span style="color: #0000FF;">Thread</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Sleep</span><span style="color: #008000;">&#40;</span><span style="color: #FF0000;">1000</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
                <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span>torrentManager<span style="color: #008000;">.</span><span style="color: #0000FF;">Progress</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">==</span> <span style="color: #FF0000;">100.0</span><span style="color: #008000;">&#41;</span>
                <span style="color: #008000;">&#123;</span>
                    <span style="color: #008080; font-style: italic;">// If we want to stop a torrent, or the engine for whatever reason, we call engine.Stop()</span>
                    <span style="color: #008080; font-style: italic;">// A tracker update *must* be performed before the engine is shut down, so you must</span>
                    <span style="color: #008080; font-style: italic;">// wait for the waithandle to become signaled before continuing with the complete</span>
                    <span style="color: #008080; font-style: italic;">// shutdown of your client. Otherwise stats will not get reported correctly.</span>
                    WaitHandle<span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> handles <span style="color: #008000;">=</span> engine<span style="color: #008000;">.</span><span style="color: #0000FF;">Stop</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                    WaitHandle<span style="color: #008000;">.</span><span style="color: #0000FF;">WaitAll</span><span style="color: #008000;">&#40;</span>handles<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                    <span style="color: #0600FF; font-weight: bold;">return</span><span style="color: #008000;">;</span>
                <span style="color: #008000;">&#125;</span>
            <span style="color: #008000;">&#125;</span>
        <span style="color: #008000;">&#125;</span></pre>
<h2> <span class="mw-headline" id="Tracker_Library"> Tracker Library </span></h2>
<p>The client library contains all the functionality to host a BitTorrent Tracker, or embed Tracker functionality in an application.
</p><p><br />
</p>
<h4> <span class="mw-headline" id="Features_2"> Features </span></h4>
<p>?????
</p>
