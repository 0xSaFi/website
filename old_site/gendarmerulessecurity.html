---
layout: obsolete
title: "Gendarme.Rules.Security"
permalink: /old_site/Gendarme.Rules.Security/
redirect_from:
  - /Gendarme.Rules.Security/
---

<h1>Gendarme.Rules.Security</h1>

<p><a href="{{site.baseurl}}/old_site/Gendarme" title="Gendarme">Gendarme</a>'s security rules are located in the <b>Gendarme.Rules.Security.dll</b> assembly.
Latest sources are available from 
<a href="http://anonsvn.mono-project.com/viewcvs/trunk/mono-tools/gendarme/rules/Gendarme.Rules.Security/" class="external text" rel="nofollow">anonymous SVN</a>.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Rules"><span class="tocnumber">1</span> <span class="toctext">Rules</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#ArrayFieldsShouldNotBeReadOnlyRule"><span class="tocnumber">1.1</span> <span class="toctext">ArrayFieldsShouldNotBeReadOnlyRule</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#DoNotShortCircuitCertificateCheckRule"><span class="tocnumber">1.2</span> <span class="toctext">DoNotShortCircuitCertificateCheckRule</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#NativeFieldsShouldNotBeVisibleRule"><span class="tocnumber">1.3</span> <span class="toctext">NativeFieldsShouldNotBeVisibleRule</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#StaticConstructorsShouldBePrivateRule"><span class="tocnumber">1.4</span> <span class="toctext">StaticConstructorsShouldBePrivateRule</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Feedback"><span class="tocnumber">2</span> <span class="toctext">Feedback</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Rules"> Rules </span></h1>
<h3> <span class="mw-headline" id="ArrayFieldsShouldNotBeReadOnlyRule"> ArrayFieldsShouldNotBeReadOnlyRule </span></h3>
<p>This rule warns if a type declares a public <b>readonly</b> array field. Marking a field <b>readonly</b> only prevents the field from being assigned a different value, the object itself can still be changed. This means, that the elements inside the array can still be changed. 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Bad <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">readonly</span> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> Array <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">&#123;</span> <span style="color: #666666;">&quot;A&quot;</span>, <span style="color: #666666;">&quot;B&quot;</span> <span style="color: #008000;">&#125;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
&#160;
HasPublicReadonlyArray obj <span style="color: #008000;">=</span> HasPublicReadonlyArray <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
obj<span style="color: #008000;">.</span><span style="color: #0000FF;">Array</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;B&quot;</span><span style="color: #008000;">;</span> <span style="color: #008080; font-style: italic;">// valid</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> Good <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">readonly</span> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> array <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">&#123;</span> <span style="color: #666666;">&quot;A&quot;</span>, <span style="color: #666666;">&quot;B&quot;</span> <span style="color: #008000;">&#125;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> GetArray <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> <span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span> array<span style="color: #008000;">.</span><span style="color: #0000FF;">Clone</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> obj <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> HasPublicReadonlyArray <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">GetArray</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
obj <span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;B&quot;</span><span style="color: #008000;">;</span> <span style="color: #008080; font-style: italic;">// valid, but has no effect on other users</span></pre>
<p><br />
</p>
<h3> <span class="mw-headline" id="DoNotShortCircuitCertificateCheckRule"> DoNotShortCircuitCertificateCheckRule </span></h3>
<p>This rule checks for methods that implements pass-through certificate checks. I.e. methods that override the framework decision about a certificate validity without checking anything specific about the supplied certificate or error code. Protocols like TLS/SSL are only secure if the certificates are used correctly. 
</p><p><b>Bad</b> example (ICertificatePolicy):
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> AcceptEverythingCertificatePolicy <span style="color: #008000;">:</span> ICertificatePolicy <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">bool</span> CheckValidationResult <span style="color: #008000;">&#40;</span>ServicePoint srvPoint, X509Certificate certificate, WebRequest request, <span style="color: #6666cc; font-weight: bold;">int</span> certificateProblem<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #008080; font-style: italic;">// this accepts everything making it easy for MITM</span>
        <span style="color: #008080; font-style: italic;">// (Man-in-the-middle) attacks</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example (ICertificatePolicy):
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> AllowSpecificCertificatePolicy <span style="color: #008000;">:</span> ICertificatePolicy <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">bool</span> CheckValidationResult <span style="color: #008000;">&#40;</span>ServicePoint srvPoint, X509Certificate certificate, WebRequest request, <span style="color: #6666cc; font-weight: bold;">int</span> certificateProblem<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #008080; font-style: italic;">// this accept only a specific certificate, even if others would be ok</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span>certificate<span style="color: #008000;">.</span><span style="color: #0000FF;">GetCertHashString</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;D62F48D013EE7FB58B79074512670D9C5B3A5DA9&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Bad</b> example (RemoteCertificateValidationCallback):
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">bool</span> CertificateValidationCallback <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #008080; font-style: italic;">// this accepts everything making it easy for MITM</span>
    <span style="color: #008080; font-style: italic;">// (Man-in-the-middle) attacks</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">true</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
&#160;
SslStream ssl <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SslStream <span style="color: #008000;">&#40;</span>stream, <span style="color: #0600FF; font-weight: bold;">false</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> RemoteCertificateValidationCallback <span style="color: #008000;">&#40;</span>CertificateValidationCallback<span style="color: #008000;">&#41;</span>, <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><b>Good</b> example (RemoteCertificateValidationCallback):
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">bool</span> CertificateValidationCallback <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #008080; font-style: italic;">// this accept only a specific certificate, even if others would be ok</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #008000;">&#40;</span>certificate<span style="color: #008000;">.</span><span style="color: #0000FF;">GetCertHashString</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">==</span> <span style="color: #666666;">&quot;D62F48D013EE7FB58B79074512670D9C5B3A5DA9&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span>
&#160;
SslStream ssl <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SslStream <span style="color: #008000;">&#40;</span>stream, <span style="color: #0600FF; font-weight: bold;">false</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> RemoteCertificateValidationCallback <span style="color: #008000;">&#40;</span>CertificateValidationCallback<span style="color: #008000;">&#41;</span>, <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.4
</li></ul>
<h3> <span class="mw-headline" id="NativeFieldsShouldNotBeVisibleRule"> NativeFieldsShouldNotBeVisibleRule </span></h3>
<p>This rule checks if a class exposes native fields. Native fields should not be public because you lose control over their lifetime (other code could free the memory or use it after it has been freed). 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> HasPublicNativeField <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> IntPtr NativeField<span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example (hide):
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> HasPrivateNativeField <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">private</span> IntPtr NativeField<span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">void</span> DoSomethingWithNativeField <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example (read-only):
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #6666cc; font-weight: bold;">class</span> HasReadOnlyNativeField <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">readonly</span> IntPtr NativeField<span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><br />
</p>
<h3> <span class="mw-headline" id="StaticConstructorsShouldBePrivateRule"> StaticConstructorsShouldBePrivateRule </span></h3>
<p>This rule will fire if a type's static constructor is not private. This is a problem because the static constructor is meant to be called by the runtime but if it is not private then other code may call it as well which may lead to security vulnerabilities. Note that C# and VB.NET enforce this rule. 
</p><p><br />
</p>
<h1> <span class="mw-headline" id="Feedback"> Feedback </span></h1>
<p>Please report any documentation errors, typos or suggestions to the 
<a href="http://groups.google.com/group/gendarme" class="external text" rel="nofollow">Gendarme Google Group</a>. Thanks!
</p>
