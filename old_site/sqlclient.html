---
layout: obsolete
title: "SQLClient"
permalink: /old_site/SQLClient/
redirect_from:
  - /SQLClient/
  - /MS_SQL_Client/
  - /MSSQL/
---

<h1>SQLClient</h1>

<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Info"><span class="tocnumber">1</span> <span class="toctext">Info</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Current_Status"><span class="tocnumber">2</span> <span class="toctext">Current Status</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Action_Plan"><span class="tocnumber">3</span> <span class="toctext">Action Plan</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Testing"><span class="tocnumber">4</span> <span class="toctext">Testing</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Info"> Info </span></h2>
<ul><li> ADO.NET Provider for Microsoft SQL Server 7/2000/2005/2008 databases 
</li></ul>
<ul><li> Exists in namespace System.Data.SqlClient and assembly System.Data
</li></ul>
<ul><li> Used the <a href="http://www.freetds.org/" class="external text" rel="nofollow">FreeTDS</a> and <a href="http://jtds.sourceforge.net/" class="external text" rel="nofollow">jTDS</a> projects as resources.
</li></ul>
<ul><li> Does not require a client library because it is fully managed.
</li></ul>
<ul><li> Requires the assembly Mono.Data.Tds.dll which implements the TDS protocol in C#
</li></ul>
<ul><li> Uses TDS Protocol Version 7.0
</li></ul>
<h2> <span class="mw-headline" id="Current_Status"> Current Status </span></h2>
<ul><li> Connect to Microsoft SQL Server 7, 2000, 2005, and 2008 databases via SQL Server authentication and NT Authentication.  However, if you want to use NT Authentication, you must trully be on an NT/2000/2003 Domain.
</li></ul>
<ul><li> Connection pooling works.
</li></ul>
<ul><li> Stored Procedures work.
</li></ul>
<ul><li> Named pipes are not supported.  However, if you knew jCIFS or Samba, you probably could implement this functionality for SqlClient.
</li></ul>
<ul><li> Parameters work.
</li></ul>
<ul><li> Prepare works.
</li></ul>
<ul><li> SQL commands can be executed via ExecuteNonQuery() of a SqlCommand.
</li></ul>
<ul><li> SQL aggregates can be executed and a single row and single column result can be retrieved via ExecuteScalar() of a SqlCommand
</li></ul>
<ul><li> SQL queries can be executed via ExecuteReader() and results can be retrieved via SqlDataReader.
</li></ul>
<ul><li> a DataTable with schema info about a result can be gotten via GetSchemaTable() in a SqlDataReader
</li></ul>
<ul><li> XML can be read via ExecuteXmlReader in a SqlCommand.
</li></ul>
<ul><li> Data can be filled in a DataTable in a DataSet via a SqlDataAdapter
</li></ul>
<ul><li> Works in the SQL# command-line and Gtk# GUI version
</li></ul>
<h2> <span class="mw-headline" id="Action_Plan"> Action Plan </span></h2>
<ul><li> Needs more testing and fixing bugs
</li></ul>
<ul><li> Start work on TDS Protocol Version 8.0 support
</li></ul>
<ul><li> Add support for the .NET Framework 2.0
</li></ul>
<ul><li> Add support for ADO.NET 2.0
</li></ul>
<ul><li> Add support for Microsoft SQL Server 2005
</li></ul>
<ul><li> Add support for distributed transactions
</li></ul>
<ul><li> Add support for Named Pipes
</li></ul>
<ul><li> Better support for Integrated Security (NTLM Authentication)
</li></ul>
<h2> <span class="mw-headline" id="Testing"> Testing </span></h2>
<p><b>Prerequisites</b> 
</p>
<ul><li> Have a working mono and mcs installed.  Recommend at least Mono 1.1.5 since there have been lots of bug fixes.
</li></ul>
<ul><li> Have access to a Microsoft SQL Server database or either download it: <a href="http://www.microsoft.com/sql/default.mspx" class="external text" rel="nofollow">Microsoft SQL Server</a>
</li></ul>
<p>There is a trial version which allows you to use it for 120 days.  There is also MSDE and <a href="http://msdn.microsoft.com/vstudio/express/sql/download/" class="external text" rel="nofollow">SQL Server 2005 Express</a> which are free downloads.  MSDE (Desktop version of SQL Server) will not be supported on the Windows Vista operating system - use SQL Server 2005 Express instead.  If you get SQL Server 2005 Express, also get the SQL Server Management Studio Express.
</p>
<ul><li> <b>IMPORTANT:</b> If using Microsoft SQL Server 2000, make sure you are using at least Service Pack 3 for Microsoft SQL Server 2000. If using MSDE 2000, make sure you have the special Service Pack 3 for MSDE 2000.  Currently, the latest service pack is SP4.  You can get it from <a href="http://www.microsoft.com/technet/prodtechnol/sql/2000/downloads/default.mspx" class="external text" rel="nofollow">here</a>
</li></ul>
<ul><li> For those that only have MSDE installed. You can change the authentication mode from Windows Only Authentication to SQL Server and Windows Authentications (also knows as Mixed-mode authentication) via the <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;Q322336&amp;sd=tech#4" class="external text" rel="nofollow">registry</a>. It is the LoginMode you need to change. By default, MSDE is installed with Windows Only Authentication. If you want SqlClient to work with MSDE via SQL Server authentication, you will need to change the setting. Otherwise, you wil have to use NT Authentication.
</li></ul>
<ul><li> If using MSDE, you might need to create a new user with password. Give this user access to various databases in this MSDE instance. Also, for each database, give this new user at least SELECT access to the various tables you want to retrieve data from.
</li></ul>
<ul><li> If you have Enterprise Manager, you can easily change the authentication mode for both MSDE and Microsoft SQL Server. To change the authentication mode in Enterprise Mananger, select the instance, right-click on it, and select properites. The SQL Server properties dialog for that instance will pop up. Choose the Security tab. Change the Authentication from Windows Only to SQL Server and Windows. If the instance of your database does not show up in Enterprise Manager, Register first by selecting the Action menu and choosing New SQL Server Registration.
</li></ul>
<ul><li> By default, SQL Server 2005 Express has TCP/IP disabled. So, you have to go into SQL Server Configuration Manager and enable TCP/IP for each instance you wish to connect via TCP/IP. But, you also must make sure the TCP/IP Protocol is one of the allowed client protocols.  You may need to make sure your firewall allows mono.exe to do networking. And allow the SQL Server Monitor UDP Port 1434 in your firewall. If this UDP port is not enabled, then SqlClient running on Linux will not be able to get the TCP port to connect to based on the instance name SQLEXPRESS.  SQL Server 2005 Network Configuration - Protocols for - SQLEXPRESS - enable TCP/IP.  And SQL Server Native Client - Client Protocols -     enable TCP/IP.
</li></ul>
<ul><li> If you want to use Integrated Security (aka NT Authentication aka Trusted Connection aka Domain Login), you will need to specify the Windows NT/2000/2003 Domain User ID and Password. This is because Mono is not integrated with Windows nor SQL Server.
</li></ul>
<p><b>Connection string format</b> 
</p><p><br />
</p>
<ul><li> Has a connection string format for SQL Server Authentication:
</li></ul>
<pre>
Server=hostname;Database=databaseName;User ID=sqlServerUserid;Password=sqlServerPassword
</pre>
<ul><li> Has a connection string format for NT Authentication:
</li></ul>
<pre>
Server=hostname;Database=databaseName;User ID=windowsDomain\windowsUserid;Password=windowsPassword;Integrated Security=SSPI
</pre>
<ul><li> Connection String Parameters:
</li></ul>
<table border="1" cellpadding="2" cellspacing="0" align="center" style="margin: 0 0 1em 1em; text-align:left; border-collapse:collapse; border:1px gray solid; font-size:95%; background:#f9f9f9">
<tr>
<th> Parameter Definition </th>
<th> Description </th>
<th> Example
</th></tr>
<tr>
<td> Server or Data Source </td>
<td> hostname of the SQL Server </td>
<td> Server=MYHOST
</td></tr>
<tr>
<td> Database or Initial Catalog </td>
<td> name of the database </td>
<td> Database=pubs
</td></tr>
<tr>
<td> User ID or UID </td>
<td> name of SQL Server user.  If using integrated security, it is the name of the domain, backslash, and the name of the domain user </td>
<td> User ID=sa or UID=MYDOMAIN\SomeDomainUser
</td></tr>
<tr>
<td> Password or PWD </td>
<td> password for SQL Server user. If using integrated security, is the password of the domain user </td>
<td> Password=mypass12
</td></tr>
<tr>
<td> Integrated Security </td>
<td> use NT Authentication using a Windows domain user id and password </td>
<td> Integrated Security=SSPI
</td></tr>
<tr>
<td> Min Pool Size </td>
<td> Specifies the minimum number of connections in the connection pool.  Default is 0. </td>
<td> Min Pool Size=0
</td></tr>
<tr>
<td> Max Pool Size </td>
<td> Specifies the maximum number of connections in the connection pool.  Default is 100. </td>
<td> Max Pool Size=100
</td></tr>
<tr>
<td> Pooling </td>
<td> Specifies whether or not to use connection pooling.  Valid values are TRUE or YES to use connection pooling or FALSE or NOT to not use connection pooling.  Default is TRUE. </td>
<td> Pooling=true
</td></tr></table>
<p><br />
</p>
<ul><li> The Server connection string parameter can be used in three different ways:
</li></ul>
<table border="1" cellpadding="2" cellspacing="0" align="center" style="margin: 0 0 1em 1em; text-align:left; border-collapse:collapse; border:1px gray solid; font-size:95%; background:#f9f9f9">
<tr>
<th> Server Definition </th>
<th> Example
</th></tr>
<tr>
<td> hostname </td>
<td> Server=MYHOST
</td></tr>
<tr>
<td> hostname,port </td>
<td> Server=MYHOST,1433
</td></tr>
<tr>
<td> hostname\instance </td>
<td> Server=MYHOST\NETSDK
</td></tr></table>
<p><br />
</p>
<ul><li> C# Example using SQL Server Authentication:
</li></ul>
<pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.SqlClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Server=MyServer;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Database=pubs;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=MySqlServerUserId;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=MySqlServerPassword;&quot;</span><span style="color: #008000;">;</span>
       IDbConnection dbcon<span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlConnection<span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
           dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
           <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>IDbCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
               <span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span>
                   <span style="color: #666666;">&quot;SELECT fname, lname &quot;</span> <span style="color: #008000;">+</span>
                   <span style="color: #666666;">&quot;FROM employee&quot;</span><span style="color: #008000;">;</span>
               dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
               <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>IDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
                   <span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
                       <span style="color: #6666cc; font-weight: bold;">string</span> FirstName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;fname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
                       <span style="color: #6666cc; font-weight: bold;">string</span> LastName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;lname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
                       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Name: &quot;</span> <span style="color: #008000;">+</span>
                            FirstName <span style="color: #008000;">+</span> <span style="color: #666666;">&quot; &quot;</span> <span style="color: #008000;">+</span> LastName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                   <span style="color: #008000;">&#125;</span>
               <span style="color: #008000;">&#125;</span>
           <span style="color: #008000;">&#125;</span>
       <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<ul><li> C# Example using NT Authentication (Integrated Security)
</li></ul>
<pre class="csharp" style="font-family:monospace;"> <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
 <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.SqlClient</span><span style="color: #008000;">;</span>
&#160;
 <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test
 <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main<span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
       <span style="color: #6666cc; font-weight: bold;">string</span> connectionString <span style="color: #008000;">=</span>
          <span style="color: #666666;">&quot;Server=MyServer;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Database=pubs;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;User ID=MyWindowsDomain<span style="color: #008080; font-weight: bold;">\\</span>MyWindowsUserid;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Password=MyWindowsPassword;&quot;</span> <span style="color: #008000;">+</span>
          <span style="color: #666666;">&quot;Integrated Security=SSPI&quot;</span><span style="color: #008000;">;</span>
       IDbConnection dbcon<span style="color: #008000;">;</span>
       <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>dbcon <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlConnection<span style="color: #008000;">&#40;</span>connectionString<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
           dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
           <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>IDbCommand dbcmd <span style="color: #008000;">=</span> dbcon<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
               <span style="color: #6666cc; font-weight: bold;">string</span> sql <span style="color: #008000;">=</span>
                   <span style="color: #666666;">&quot;SELECT fname, lname &quot;</span> <span style="color: #008000;">+</span>
                   <span style="color: #666666;">&quot;FROM employee&quot;</span><span style="color: #008000;">;</span>
               dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
               <span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>IDataReader reader <span style="color: #008000;">=</span> dbcmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
                   <span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
                       <span style="color: #6666cc; font-weight: bold;">string</span> FirstName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;fname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
                       <span style="color: #6666cc; font-weight: bold;">string</span> LastName <span style="color: #008000;">=</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#41;</span> reader<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;lname&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
                       Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Name: &quot;</span> <span style="color: #008000;">+</span>
                            FirstName <span style="color: #008000;">+</span> <span style="color: #666666;">&quot; &quot;</span> <span style="color: #008000;">+</span> LastName<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
                   <span style="color: #008000;">&#125;</span>
               <span style="color: #008000;">&#125;</span>
          <span style="color: #008000;">&#125;</span>
       <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<ul><li> C# Example using Command Builder and Data Adapter to easily update the database based on inserts, updates, or deletes in a DataTable
</li></ul>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.Common</span><span style="color: #008000;">;</span>
<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008080;">System.Data.SqlClient</span><span style="color: #008000;">;</span>
&#160;
<span style="color: #0600FF; font-weight: bold;">namespace</span> TestSqlClientAdapter <span style="color: #008000;">&#123;</span>
	<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> Test <span style="color: #008000;">&#123;</span>
		<span style="color: #0600FF; font-weight: bold;">static</span> SqlConnection con<span style="color: #008000;">;</span>
		<span style="color: #0600FF; font-weight: bold;">static</span> SqlTransaction trans<span style="color: #008000;">;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Main <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span><span style="color: #008000;">&#91;</span><span style="color: #008000;">&#93;</span> args<span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Apapter Test Begin...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>con <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlConnection<span style="color: #008000;">&#40;</span>
                            <span style="color: #666666;">&quot;server=localhost;&quot;</span> <span style="color: #008000;">+</span> 
                            <span style="color: #666666;">&quot;database=pubs;&quot;</span> <span style="color: #008000;">+</span>
                            <span style="color: #666666;">&quot;user id=sa;&quot;</span> <span style="color: #008000;">+</span>
                            <span style="color: #666666;">&quot;password=mypass&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
			    con<span style="color: #008000;">.</span><span style="color: #0000FF;">Open</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			    Setup<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			    trans <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">BeginTransaction</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			    Insert<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			    trans<span style="color: #008000;">.</span><span style="color: #0000FF;">Commit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			    trans <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">BeginTransaction</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			    Update<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			    trans<span style="color: #008000;">.</span><span style="color: #0000FF;">Commit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			    trans <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">BeginTransaction</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			    Delete<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			    trans<span style="color: #008000;">.</span><span style="color: #0000FF;">Commit</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			<span style="color: #008000;">&#125;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Done.&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Setup<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>SqlCommand cmd <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
				cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Transaction</span> <span style="color: #008000;">=</span> trans<span style="color: #008000;">;</span>
				cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
        	                      <span style="color: #666666;">&quot;DROP TABLE MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">;</span>
&#160;
				<span style="color: #0600FF; font-weight: bold;">try</span> <span style="color: #008000;">&#123;</span> cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span> 
				<span style="color: #008000;">&#125;</span> <span style="color: #0600FF; font-weight: bold;">catch</span><span style="color: #008000;">&#40;</span>SqlException e<span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span> <span style="color: #008000;">&#125;</span>
&#160;
				cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> 
					<span style="color: #666666;">&quot;CREATE TABLE MONO_TEST_ADAPTER1 (&quot;</span> <span style="color: #008000;">+</span>
					<span style="color: #666666;">&quot; num_value int primary key,&quot;</span> <span style="color: #008000;">+</span>
					<span style="color: #666666;">&quot; txt_value varchar(64))&quot;</span><span style="color: #008000;">;</span>
				cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteNonQuery</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			<span style="color: #008000;">&#125;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Insert<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Insert...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			SqlDataAdapter adapter <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlDataAdapter<span style="color: #008000;">&#40;</span>
                                <span style="color: #666666;">&quot;SELECT * FROM MONO_TEST_ADAPTER1&quot;</span>, con<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">MissingSchemaAction</span>  <span style="color: #008000;">=</span> MissingSchemaAction<span style="color: #008000;">.</span><span style="color: #0000FF;">AddWithKey</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">SelectCommand</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Transaction</span> <span style="color: #008000;">=</span> trans<span style="color: #008000;">;</span>
			SqlCommandBuilder builder <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlCommandBuilder<span style="color: #008000;">&#40;</span>adapter<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			DataSet ds <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> DataSet<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Fill</span><span style="color: #008000;">&#40;</span>ds,<span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			DataRow row <span style="color: #008000;">=</span> ds<span style="color: #008000;">.</span><span style="color: #0000FF;">Tables</span><span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">NewRow</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			row<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;num_value&quot;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #FF0000;">3</span><span style="color: #008000;">;</span>
			row<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;txt_value&quot;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Value inserted&quot;</span><span style="color: #008000;">;</span>
&#160;
			ds<span style="color: #008000;">.</span><span style="color: #0000FF;">Tables</span><span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Rows</span><span style="color: #008000;">.</span><span style="color: #0600FF; font-weight: bold;">Add</span><span style="color: #008000;">&#40;</span>row<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Update</span><span style="color: #008000;">&#40;</span>ds, <span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			row <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			builder <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			adapter <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			ds <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
			ReadData<span style="color: #008000;">&#40;</span>con, <span style="color: #666666;">&quot;SELECT * FROM MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Update<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Update...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			SqlDataAdapter adapter <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlDataAdapter<span style="color: #008000;">&#40;</span>
                                <span style="color: #666666;">&quot;SELECT * FROM MONO_TEST_ADAPTER1&quot;</span>, con<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">SelectCommand</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Transaction</span> <span style="color: #008000;">=</span> trans<span style="color: #008000;">;</span>
			SqlCommandBuilder builder <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlCommandBuilder<span style="color: #008000;">&#40;</span>adapter<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			DataSet ds <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> DataSet<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Fill</span><span style="color: #008000;">&#40;</span>ds,<span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			DataRow row <span style="color: #008000;">=</span> ds<span style="color: #008000;">.</span><span style="color: #0000FF;">Tables</span><span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Rows</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">;</span>
			row<span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;txt_value&quot;</span><span style="color: #008000;">&#93;</span> <span style="color: #008000;">=</span> <span style="color: #666666;">&quot;Value updated&quot;</span><span style="color: #008000;">;</span>
&#160;
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Update</span><span style="color: #008000;">&#40;</span>ds, <span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			row <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			builder <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			adapter <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			ds <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
			ReadData<span style="color: #008000;">&#40;</span>con, <span style="color: #666666;">&quot;SELECT * FROM MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> Delete<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Delete...&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			SqlDataAdapter adapter <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlDataAdapter<span style="color: #008000;">&#40;</span>
                                <span style="color: #666666;">&quot;SELECT * FROM MONO_TEST_ADAPTER1&quot;</span>, con<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">SelectCommand</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Transaction</span> <span style="color: #008000;">=</span> trans<span style="color: #008000;">;</span>
			SqlCommandBuilder builder <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SqlCommandBuilder<span style="color: #008000;">&#40;</span>adapter<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			DataSet ds <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> DataSet<span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Fill</span><span style="color: #008000;">&#40;</span>ds,<span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			ds<span style="color: #008000;">.</span><span style="color: #0000FF;">Tables</span><span style="color: #008000;">&#91;</span><span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Rows</span><span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">.</span><span style="color: #0000FF;">Delete</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			adapter<span style="color: #008000;">.</span><span style="color: #0000FF;">Update</span><span style="color: #008000;">&#40;</span>ds, <span style="color: #666666;">&quot;MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
			builder <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			adapter <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
			ds <span style="color: #008000;">=</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">;</span>
&#160;
			ReadData<span style="color: #008000;">&#40;</span>con, <span style="color: #666666;">&quot;SELECT * FROM MONO_TEST_ADAPTER1&quot;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
		<span style="color: #008000;">&#125;</span>
&#160;
		<span style="color: #0600FF; font-weight: bold;">private</span> <span style="color: #0600FF; font-weight: bold;">static</span> <span style="color: #6666cc; font-weight: bold;">void</span> ReadData<span style="color: #008000;">&#40;</span>IDbConnection con, <span style="color: #6666cc; font-weight: bold;">string</span> sql<span style="color: #008000;">&#41;</span> 
		<span style="color: #008000;">&#123;</span>
			<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>IDbCommand cmd <span style="color: #008000;">=</span> con<span style="color: #008000;">.</span><span style="color: #0000FF;">CreateCommand</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
				cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">Transaction</span> <span style="color: #008000;">=</span> trans<span style="color: #008000;">;</span>
				cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">CommandText</span> <span style="color: #008000;">=</span> sql<span style="color: #008000;">;</span>
				<span style="color: #0600FF; font-weight: bold;">using</span> <span style="color: #008000;">&#40;</span>IDataReader reader <span style="color: #008000;">=</span> cmd<span style="color: #008000;">.</span><span style="color: #0000FF;">ExecuteReader</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
					<span style="color: #6666cc; font-weight: bold;">int</span> rows <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
					<span style="color: #0600FF; font-weight: bold;">while</span><span style="color: #008000;">&#40;</span>reader<span style="color: #008000;">.</span><span style="color: #0000FF;">Read</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
						Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Value 0: {0}&quot;</span>, reader<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
						Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Value 0: {0}&quot;</span>, reader<span style="color: #008000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #008000;">&#93;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
						rows<span style="color: #008000;">++;</span>
					<span style="color: #008000;">&#125;</span>
					Console<span style="color: #008000;">.</span><span style="color: #0000FF;">WriteLine</span><span style="color: #008000;">&#40;</span><span style="color: #666666;">&quot;Rows retrieved: {0}&quot;</span>, rows<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
				<span style="color: #008000;">&#125;</span>
			<span style="color: #008000;">&#125;</span>
		<span style="color: #008000;">&#125;</span>
	<span style="color: #008000;">&#125;</span>
 <span style="color: #008000;">&#125;</span></pre>
<ul><li> Building C# Example: 
</li></ul>
<ul><li> Save the example to a file, such as, TestExample.cs
</li></ul>
<ul><li> Build on Linux:
</li></ul>
<pre>
mcs TestExample.cs -r:System.Data.dll
</pre>
<p><br />
</p>
<ul><li> Running the Example:
</li></ul>
<pre>
 mono TestExample.exe </pre>

