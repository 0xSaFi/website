---
layout: obsolete
title: "Gendarme.Rules.Maintainability"
permalink: /old_site/Gendarme.Rules.Maintainability/
redirect_from:
  - /Gendarme.Rules.Maintainability/
---

<h1>Gendarme.Rules.Maintainability</h1>

<p><a href="{{site.baseurl}}/old_site/Gendarme" title="Gendarme">Gendarme</a>'s maintainability rules are located in the <b>Gendarme.Rules.Maintainability.dll</b> assembly.
Latest sources are available from 
<a href="http://anonsvn.mono-project.com/viewcvs/trunk/mono-tools/gendarme/rules/Gendarme.Rules.Maintainability/" class="external text" rel="nofollow">anonymous SVN</a>.
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Rules"><span class="tocnumber">1</span> <span class="toctext">Rules</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#AvoidAlwaysNullFieldRule"><span class="tocnumber">1.1</span> <span class="toctext">AvoidAlwaysNullFieldRule</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#AvoidComplexMethodsRule"><span class="tocnumber">1.2</span> <span class="toctext">AvoidComplexMethodsRule</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#HighThreshold"><span class="tocnumber">1.2.1</span> <span class="toctext">HighThreshold</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#LowThreshold"><span class="tocnumber">1.2.2</span> <span class="toctext">LowThreshold</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#MediumThreshold"><span class="tocnumber">1.2.3</span> <span class="toctext">MediumThreshold</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#SuccessThreshold"><span class="tocnumber">1.2.4</span> <span class="toctext">SuccessThreshold</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8"><a href="#AvoidDeepInheritanceTreeRule"><span class="tocnumber">1.3</span> <span class="toctext">AvoidDeepInheritanceTreeRule</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#CountExternalDepth"><span class="tocnumber">1.3.1</span> <span class="toctext">CountExternalDepth</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#MaximumDepth"><span class="tocnumber">1.3.2</span> <span class="toctext">MaximumDepth</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11"><a href="#AvoidLackOfCohesionOfMethodsRule"><span class="tocnumber">1.4</span> <span class="toctext">AvoidLackOfCohesionOfMethodsRule</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#LowSeverityLowerLimit"><span class="tocnumber">1.4.1</span> <span class="toctext">LowSeverityLowerLimit</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#MediumSeverityLowerLimit"><span class="tocnumber">1.4.2</span> <span class="toctext">MediumSeverityLowerLimit</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#MinimumFieldCount"><span class="tocnumber">1.4.3</span> <span class="toctext">MinimumFieldCount</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#MinimumMethodCount"><span class="tocnumber">1.4.4</span> <span class="toctext">MinimumMethodCount</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#SuccessLowerLimit"><span class="tocnumber">1.4.5</span> <span class="toctext">SuccessLowerLimit</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#AvoidUnnecessarySpecializationRule"><span class="tocnumber">1.5</span> <span class="toctext">AvoidUnnecessarySpecializationRule</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#ConsiderUsingStopwatchRule"><span class="tocnumber">1.6</span> <span class="toctext">ConsiderUsingStopwatchRule</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#PreferStringIsNullOrEmptyRule"><span class="tocnumber">1.7</span> <span class="toctext">PreferStringIsNullOrEmptyRule</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20"><a href="#Feedback"><span class="tocnumber">2</span> <span class="toctext">Feedback</span></a></li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="Rules"> Rules </span></h1>
<h3> <span class="mw-headline" id="AvoidAlwaysNullFieldRule"> AvoidAlwaysNullFieldRule </span></h3>
<p>A type has a private field whose value is always null. 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">internal</span> <span style="color: #0600FF; font-weight: bold;">sealed</span> <span style="color: #6666cc; font-weight: bold;">class</span> Bad <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">private</span> List<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span> values<span style="color: #008000;">;</span>
&#160;
    <span style="color: #0600FF; font-weight: bold;">public</span> List<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span> Values <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
            <span style="color: #0600FF; font-weight: bold;">return</span> values<span style="color: #008000;">;</span>
        <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">internal</span> <span style="color: #0600FF; font-weight: bold;">sealed</span> <span style="color: #6666cc; font-weight: bold;">class</span> Good <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">private</span> List<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span> values <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> List<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span><span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
&#160;
    <span style="color: #0600FF; font-weight: bold;">public</span> List<span style="color: #008000;">&lt;</span><span style="color: #6666cc; font-weight: bold;">int</span><span style="color: #008000;">&gt;</span> Values <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">get</span> <span style="color: #008000;">&#123;</span>
            <span style="color: #0600FF; font-weight: bold;">return</span> values<span style="color: #008000;">;</span>
        <span style="color: #008000;">&#125;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.4
</li></ul>
<h3> <span class="mw-headline" id="AvoidComplexMethodsRule"> AvoidComplexMethodsRule </span></h3>
<p>This rule computes the cyclomatic complexity (CC) for every method and reports any method with a CC over 25 (this limit is configurable). Large CC value often indicate complex code that is hard to understand and maintain. It's likely that breaking the method into several methods will help readability. This rule won't report any defects on code generated by the compiler or by tools. 
</p><p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<p><b>Configuration</b>
</p><p>Some elements of this rule can be customized to better fit your needs.
</p>
<h4> <span class="mw-headline" id="HighThreshold"> HighThreshold </span></h4>
<p>Methods with cyclomatic complexity less than this (but higher than MediumThreshold) will be reported as high severity.
</p>
<h4> <span class="mw-headline" id="LowThreshold"> LowThreshold </span></h4>
<p>Methods with cyclomatic complexity less than this will be reported as low severity.
</p>
<h4> <span class="mw-headline" id="MediumThreshold"> MediumThreshold </span></h4>
<p>Methods with cyclomatic complexity less than this (but higher than LowThreshold) will be reported as medium severity.
</p>
<h4> <span class="mw-headline" id="SuccessThreshold"> SuccessThreshold </span></h4>
<p>The cyclomatic complexity at which defects begin to be reported.
</p>
<h3> <span class="mw-headline" id="AvoidDeepInheritanceTreeRule"> AvoidDeepInheritanceTreeRule </span></h3>
<p>This rule will fire if a type has (by default) more than four base classes defined within the assembly set being analyzed. Optionally it will also count base classes defined outside the assembly set being analyzed. 
</p><p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<p><b>Configuration</b>
</p><p>Some elements of this rule can be customized to better fit your needs.
</p>
<h4> <span class="mw-headline" id="CountExternalDepth"> CountExternalDepth </span></h4>
<p>If true the rule will count base classes defined outside the assemblies being analyzed.
</p>
<h4> <span class="mw-headline" id="MaximumDepth"> MaximumDepth </span></h4>
<p>Classes with more base classes than this will result in a defect.
</p>
<h3> <span class="mw-headline" id="AvoidLackOfCohesionOfMethodsRule"> AvoidLackOfCohesionOfMethodsRule </span></h3>
<p>This rule checks every type for lack of cohesion between the fields and the methods. Low cohesion is often a sign that a type is doing too many, different and unrelated things. The cohesion score is given for each defect (higher is better). 
</p><p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<p><b>Configuration</b>
</p><p>Some elements of this rule can be customized to better fit your needs.
</p>
<h4> <span class="mw-headline" id="LowSeverityLowerLimit"> LowSeverityLowerLimit </span></h4>
<p>Defects with cohesion values greater than this will be reported at low severity.
</p>
<h4> <span class="mw-headline" id="MediumSeverityLowerLimit"> MediumSeverityLowerLimit </span></h4>
<p>Defects with cohesion values greater than (but less than LowSeverityLowerLimit) this will be reported at medium severity.
</p>
<h4> <span class="mw-headline" id="MinimumFieldCount"> MinimumFieldCount </span></h4>
<p>The minimum number of fields a class must have to be checked.
</p>
<h4> <span class="mw-headline" id="MinimumMethodCount"> MinimumMethodCount </span></h4>
<p>The minimum number of methods a class must have to be checked.
</p>
<h4> <span class="mw-headline" id="SuccessLowerLimit"> SuccessLowerLimit </span></h4>
<p>Cohesion values lower than this will result in a defect.
</p>
<h3> <span class="mw-headline" id="AvoidUnnecessarySpecializationRule"> AvoidUnnecessarySpecializationRule </span></h3>
<p>This rule checks methods for over specialized parameters - i.e. parameter types that are unnecessarily specialized with respect to what the method needs to perform its job. This often impairs the reusability of the method. If a problem is found the rule will suggest the most general type, or interface, required for the method to work. 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> DefaultEqualityComparer <span style="color: #008000;">:</span> IEqualityComparer <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">int</span> GetHashCode <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> obj<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> o<span style="color: #008000;">.</span><span style="color: #0000FF;">GetHashCode</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">int</span> Bad <span style="color: #008000;">&#40;</span>DefaultEqualityComparer ec, <span style="color: #6666cc; font-weight: bold;">object</span> o<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> ec<span style="color: #008000;">.</span><span style="color: #0000FF;">GetHashCode</span> <span style="color: #008000;">&#40;</span>o<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">class</span> DefaultEqualityComparer <span style="color: #008000;">:</span> IEqualityComparer <span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">int</span> GetHashCode <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">object</span> obj<span style="color: #008000;">&#41;</span>
    <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> o<span style="color: #008000;">.</span><span style="color: #0000FF;">GetHashCode</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
<span style="color: #008000;">&#125;</span>
&#160;
<span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">int</span> Good <span style="color: #008000;">&#40;</span>IEqualityComparer ec, <span style="color: #6666cc; font-weight: bold;">object</span> o<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> ec<span style="color: #008000;">.</span><span style="color: #0000FF;">GetHashCode</span> <span style="color: #008000;">&#40;</span>o<span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<h3> <span class="mw-headline" id="ConsiderUsingStopwatchRule"> ConsiderUsingStopwatchRule </span></h3>
<p>This rule checks methods for cases where a <b>System.Diagnostics.Stopwatch</b> could be used instead of using <b>System.DateTime</b> to compute the time required for an action. Stopwatch is preferred because it better expresses the intent of the code and because (on some platforms at least) StopWatch is accurate to roughly the microsecond whereas DateTime.Now is only accurate to 16 milliseconds or so. This rule only applies to assemblies compiled with the .NET framework version 2.0 (or later). 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> TimeSpan DoLongOperation <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    DateTime start <span style="color: #008000;">=</span> DateTime<span style="color: #008000;">.</span><span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
    DownloadNewOpenSuseDvdIso <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> DateTime<span style="color: #008000;">.</span><span style="color: #0000FF;">Now</span> <span style="color: #008000;">-</span> start<span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> TimeSpan DoLongOperation <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    Stopwatch watch <span style="color: #008000;">=</span> Stopwatch<span style="color: #008000;">.</span><span style="color: #0000FF;">StartNew</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    DownloadNewOpenSuseDvdIso <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> watch<span style="color: #008000;">.</span><span style="color: #0000FF;">Elapsed</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<h3> <span class="mw-headline" id="PreferStringIsNullOrEmptyRule"> PreferStringIsNullOrEmptyRule </span></h3>
<p>This rule checks methods for cases where <b>String.IsNullOrEmpty</b> could be used instead of doing separate null and length checks. This does not affect execution nor performance (much) but it does improve source code readability. This rule only applies to assemblies compiled with .NET 2.0 (or later). 
</p><p><b>Bad</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">bool</span> SendMessage <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> message<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #008000;">&#40;</span>message <span style="color: #008000;">==</span> <span style="color: #0600FF; font-weight: bold;">null</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">||</span> <span style="color: #008000;">&#40;</span>message<span style="color: #008000;">.</span><span style="color: #0000FF;">Length</span> <span style="color: #008000;">==</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">false</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> SendMessage <span style="color: #008000;">&#40;</span>Encode <span style="color: #008000;">&#40;</span>message<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Good</b> example:
</p>
<pre class="csharp" style="font-family:monospace;"><span style="color: #0600FF; font-weight: bold;">public</span> <span style="color: #6666cc; font-weight: bold;">bool</span> SendMessage <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">string</span> message<span style="color: #008000;">&#41;</span>
<span style="color: #008000;">&#123;</span>
    <span style="color: #0600FF; font-weight: bold;">if</span> <span style="color: #008000;">&#40;</span><span style="color: #6666cc; font-weight: bold;">String</span><span style="color: #008000;">.</span><span style="color: #0000FF;">IsNullOrEmpty</span> <span style="color: #008000;">&#40;</span>message<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span> <span style="color: #008000;">&#123;</span>
        <span style="color: #0600FF; font-weight: bold;">return</span> <span style="color: #0600FF; font-weight: bold;">false</span><span style="color: #008000;">;</span>
    <span style="color: #008000;">&#125;</span>
    <span style="color: #0600FF; font-weight: bold;">return</span> SendMessage <span style="color: #008000;">&#40;</span>Encode <span style="color: #008000;">&#40;</span>message<span style="color: #008000;">&#41;</span><span style="color: #008000;">&#41;</span><span style="color: #008000;">;</span>
<span style="color: #008000;">&#125;</span></pre>
<p><b>Notes</b>
</p>
<ul><li> This rule is available since Gendarme 2.0
</li></ul>
<h1> <span class="mw-headline" id="Feedback"> Feedback </span></h1>
<p>Please report any documentation errors, typos or suggestions to the 
<a href="http://groups.google.com/group/gendarme" class="external text" rel="nofollow">Gendarme Google Group</a>. Thanks!
</p>
